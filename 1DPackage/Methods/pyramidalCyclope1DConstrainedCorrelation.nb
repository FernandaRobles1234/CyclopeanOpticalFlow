(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    171510,       3604]
NotebookOptionsPosition[    164244,       3486]
NotebookOutlinePosition[    164811,       3506]
CellTagsIndexPosition[    164768,       3503]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Constrained method", "Title",
 CellChangeTimes->{{3.836408933336395*^9, 3.836408939343516*^9}, 
   3.8364092608930736`*^9, {3.839597016893468*^9, 3.839597019185139*^9}, 
   3.8396001415844855`*^9, {3.840547036727909*^9, 3.8405470374003563`*^9}, {
   3.843157046858073*^9, 3.8431570473239956`*^9}, 3.843746389245494*^9, {
   3.843747216246171*^9, 3.8437472272964706`*^9}, {3.8437522034332137`*^9, 
   3.843752204235346*^9}, 
   3.843831097875743*^9},ExpressionUUID->"c74c55b5-a7cc-4ad8-a86e-\
04efcb90444f"],

Cell[CellGroupData[{

Cell["Start", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431530928617816`*^9, 
  3.8431531095074196`*^9}, {3.8431536160653305`*^9, 3.843153621995445*^9}, {
  3.843752212635614*^9, 
  3.8437522150627623`*^9}},ExpressionUUID->"564bd16b-5ad2-477e-879c-\
a49b47193581"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.832189670547576*^9, {3.8372610411417527`*^9, 3.837261053402938*^9}, 
   3.8372611225950527`*^9, {3.8431523924971895`*^9, 3.84315239273125*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"9b185096-2906-4a57-92e9-557dda4598fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<*\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"$Path", ",", 
     RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{3.843747298847076*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"65983b17-d6fd-4754-a477-b5ff2b124938"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramidalCyclope1D`\>\""}]}], "Input",
 CellChangeTimes->{
  3.843747328636345*^9, {3.8437486091702127`*^9, 3.8437486224305134`*^9}, {
   3.8445130212660832`*^9, 3.844513027637513*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"0a0eddb1-b848-4d3c-b05d-36e4f83d5329"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noteBookMode", "=", "\"\<ConstrainedCorrelation\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.8437533462956824`*^9, 3.8437535060531635`*^9, {3.8444602155397797`*^9, 
   3.844460218580969*^9}, {3.857489846465743*^9, 3.8574898489453306`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"e7aa4d9a-36e9-46be-b5c2-ffe503fe6e21"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Points {line1, line2, pyrf12}", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431530928617816`*^9, 
  3.8431531095074196`*^9}, {3.8431536160653305`*^9, 
  3.843153621995445*^9}},ExpressionUUID->"1cd288a4-fb0b-4c1d-b6e6-\
e28adb0822c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dis", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.8527432872559943`*^9, 3.8527432891307516`*^9}, {
  3.852820564514149*^9, 3.852820594366195*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"bcce114e-be95-4be9-af3b-e98691bcc37f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "We", " ", "create", " ", "test", " ", "points", " ", "for", " ", 
    "compilation", " ", "test"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"line1", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"11", "<=", " ", "p", "<=", "18"}], ",", "1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", "30"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line2", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"11", "<=", " ", "p", "<=", "18"}], ",", "1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"1", "-", "dis"}], ",", 
           RowBox[{"30", "-", "dis"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"line1", ",", " ", "line2"}], "}"}], ",", 
      RowBox[{"Joined", "->", "True"}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "->", "All"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", "\"\<Test Points\>\""}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ia\>\"", ",", "\"\<ib\>\""}], "}"}]}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.832269136912603*^9, 3.8322691462380075`*^9}, {
   3.8324089382989807`*^9, 3.832408951506154*^9}, {3.8324104077397842`*^9, 
   3.832410511519393*^9}, 3.832410602016293*^9, {3.832410661166127*^9, 
   3.832410748366403*^9}, {3.832411297859131*^9, 3.832411301951344*^9}, {
   3.836395098441699*^9, 3.836395118010255*^9}, {3.836396148580798*^9, 
   3.836396159588914*^9}, {3.836396194334372*^9, 3.8363962079578047`*^9}, {
   3.836398891705703*^9, 3.836398893325742*^9}, {3.8365003825221486`*^9, 
   3.83650041642003*^9}, {3.8402800509000998`*^9, 3.840280051642571*^9}, {
   3.8430474630811205`*^9, 3.843047543816728*^9}, 3.843747388415428*^9, {
   3.8445119817060966`*^9, 3.844511983305078*^9}, {3.8522966047840776`*^9, 
   3.852296606303194*^9}, {3.85274328091955*^9, 3.852743295758687*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"056c4721-21ce-4de5-84cd-f8c73485e8a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "functions", " ", "of", " ", "pyramid", " ", "with", " ", 
    "pyrFuncGen"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"original", " ", "points"}], ",", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "functions", " ", "f", " ", "and", " ", "df", " ", "for", " ", "n"}], 
      "+", 
      RowBox[{"1", " ", "levels"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pyrf1", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line1", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf2", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line2", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf12", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pyrf1", ",", " ", "pyrf2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"pyrf12", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], 
       ",", 
       RowBox[{
        RowBox[{"pyrf12", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], "[", "x", "]"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "30"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.8431536109231205`*^9, 3.84367550184682*^9, {3.8437473622190533`*^9, 
   3.8437473924405236`*^9}, {3.8445127985159717`*^9, 
   3.8445128295209723`*^9}, {3.852820576515012*^9, 3.8528205805400867`*^9}, {
   3.855166295150268*^9, 3.855166302058202*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"2f2f9eee-c8fe-403e-8715-13978274b59c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pset", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "-", "1"}], ",", "p", ",", 
     RowBox[{"p", "+", "1"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.857489528964238*^9, 3.8574895467400494`*^9}, {
  3.8574895833407345`*^9, 3.857489583514036*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"b73f0fa0-cf65-4cac-ad5b-471a5bb72b3a"],

Cell[BoxData[
 RowBox[{"Correlation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrf1", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], "&"}], "/@", 
    "pset"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrf2", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"pset", "-", "3"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857489326777008*^9, 3.8574894505684123`*^9}, {
  3.8574895506409454`*^9, 3.8574895594233446`*^9}, {3.8574895914106064`*^9, 
  3.8574896245317783`*^9}, {3.857490139676312*^9, 3.857490165604356*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"6f030a6b-aac9-4974-9d6c-6abf205c4b09"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pyramidal Flow 1D (PyrFlow1D)", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.843153511988031*^9, 
  3.843153515512398*^9}},ExpressionUUID->"eef04f0f-ca13-46b7-9ae5-\
301a424457b1"],

Cell[CellGroupData[{

Cell["PyrUpgrade1D", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 
  3.8363959796401834`*^9}},ExpressionUUID->"86d2106e-d02d-4249-a85a-\
97f3df8af812"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "to", " ", "update", " ", "values", " ", "of", " ", "v1", 
    " ", "and", " ", "v2", " ", "with", " ", "Over", " ", "Constrained", " ", 
    "standards"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Any", " ", "value", " ", "that", " ", "does", " ", "not", " ", "meets", 
    " ", "the", " ", "constraints", " ", "becomes", " ", "0"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"initial", " ", "values", " ", "for", " ", "v1"}], ",", " ", 
        RowBox[{"v2", " ", "and", " ", "status"}], ",", " ", 
        RowBox[{"and", " ", "counter", " ", "e"}]}], "}"}], ",", " ", 
      RowBox[{"pixel", " ", "of", " ", "interest"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"functions", " ", "f1"}], ",", " ", "df1", ",", " ", "f2", 
        ",", " ", "df2"}], "}"}], ",", " ", 
      RowBox[{"threshold", " ", "for", " ", "magnitude", " ", "error"}]}], 
     "}"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"new", " ", "values", " ", "for", " ", "v1"}], ",", " ", 
      RowBox[{"v2", " ", "and", " ", "status", " ", "and", " ", "e"}]}], 
     "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "status_", ",", "e_"}], "}"}], ",", 
       "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "n_", ",", "\"\<ConstrainedCorrelation\>\""}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fric1", ",", "fric2", ",", "p1", ",", " ", "p2", ",", " ", "c", ",", 
         "d1", ",", "d2", ",", "dv1", ",", "dv2", ",", "p1set", ",", "p2set", 
         ",", "cCriteria"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"p0", "-", "v1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{"p0", "+", "v2"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fline1", "[", "p0", "]"}], "+", 
             RowBox[{"fline2", "[", "p0", "]"}]}], ")"}], "/", "2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d1", "=", 
          RowBox[{"dfline1", "[", "p1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d2", "=", 
          RowBox[{"dfline2", "[", "p2", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"fric1", "=", 
          RowBox[{"1", "*", 
           RowBox[{
            RowBox[{"dfline1", "'"}], "[", "p1", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fric2", "=", 
          RowBox[{"1", "*", 
           RowBox[{
            RowBox[{"dfline2", "'"}], "[", "p2", "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "d1", " ", "and", " ", "d2", " ", "have", " ", "to", " ", "be", " ",
            "the", " ", "same", " ", "sign", " ", "in", " ", "every", " ", 
           "iteration"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"d1", "*", "d2"}], " ", "<", "0"}], ",", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "n"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<oksign\>\"", ",", 
                RowBox[{"e", "+", "1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", "\"\<sign\>\"", ",", "e"}], 
               "}"}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "magnitud", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "d1", "]"}], "<", "threshold"}], "||", 
             RowBox[{
              RowBox[{"Abs", "[", "d2", "]"}], "<", "threshold"}]}], " ", 
            ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "n"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<okmag\>\"", ",", 
                RowBox[{"e", "+", "1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", "\"\<mag\>\"", ",", "e"}], "}"}],
               "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "We", " ", "can", " ", "compare", " ", "multiple", " ", "values"}],
            ",", " ", 
           RowBox[{"by", " ", "steps", " ", "or", " ", "anything"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Range", " ", "is", " ", "related", " ", "to", " ", "scale", " ", 
           "of", " ", "the", " ", "image"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"It", "'"}], "s", " ", "not", " ", "related", " ", "to", 
           " ", "movement"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "Note", " ", "that", " ", "this", " ", "is", " ", "just", " ", 
            "an", " ", "acceptance", " ", "criteria", " ", "that", " ", 
            "will", " ", "decide", " ", "if", " ", "a", " ", "computed", " ", 
            "motion", " ", "is", " ", "coeherent", " ", "to", " ", 
            RowBox[{"it", "'"}], "s", " ", 
            RowBox[{"neighbors", ".", " ", 
             RowBox[{"It", "'"}]}], "s", " ", "not", " ", "enforcing", " ", 
            "a", " ", "common", " ", "motion", " ", "to", " ", "multiple", 
            " ", "neighbor", " ", "pixels"}], ",", " ", "so", ",", " ", 
           RowBox[{
            RowBox[{
            "depth", " ", "discontinuities", " ", "will", " ", "be", " ", 
             RowBox[{"preserved", ".", " ", "Pas"}], " ", "comme", " ", 
             "Lukas"}], "-", "Kanade"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"rangeVector", "=", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "4"}], ",", "4", ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"p1set", "=", 
          RowBox[{"p1", "+", "rangeVector"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p2set", "=", 
          RowBox[{"p2", "+", "rangeVector"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cCriteria", "=", "0.9"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Correlation", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Correlation", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"fline1", "[", "#", "]"}], "&"}], "/@", "p1set"}], 
              ",", 
              RowBox[{
               RowBox[{
                RowBox[{"fline2", "[", "#", "]"}], "&"}], "/@", "p2set"}]}], 
             "]"}], "<", "cCriteria"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "n"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<okcorr\>\"", ",", 
                RowBox[{"e", "+", "1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", "\"\<corr\>\"", ",", "e"}], 
               "}"}], "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Change", " ", "of", " ", "sign", " ", "during", " ", "iteration"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"dfline1", "[", "p0", "]"}], "*", "d1"}], "<", "0"}],
                "||", 
               RowBox[{
                RowBox[{
                 RowBox[{"dfline2", "[", "p0", "]"}], "*", "d2"}], "<", 
                "0"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"e", "<", "2"}], ",", 
               RowBox[{"Return", "[", 
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v2", ",", "\"\<flip\>\"", ",", 
                  RowBox[{"e", "+", "1"}]}], "}"}], "]"}], ",", 
               RowBox[{"Return", "[", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "0.", ",", "\"\<flip\>\"", ",", "e"}], 
                 "}"}], "]"}]}], "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"dv1", ",", 
           RowBox[{"dv2", " ", ":", " ", 
            RowBox[{"step", " ", "from", " ", "last", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}], " ", "to", " ", "new", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dv1", ",", "dv2"}], "}"}], "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fline1", "[", "p1", "]"}], "-", "c"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"d1", "+", 
               RowBox[{
                RowBox[{"Sign", "[", "d1", "]"}], "*", 
                RowBox[{"Abs", "[", "fric1", "]"}]}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "-", 
               RowBox[{"fline2", "[", "p2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"d2", "+", 
               RowBox[{
                RowBox[{"Sign", "[", "d2", "]"}], "*", 
                RowBox[{"Abs", "[", "fric2", "]"}]}]}], ")"}]}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"e", "<=", "n"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v1", "+", "dv1"}], ",", 
             RowBox[{"v2", "+", "dv2"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Norm", "[", 
                 RowBox[{"{", 
                  RowBox[{"dv1", ",", "dv2"}], "}"}], "]"}], "<", "0.01"}], 
               ",", "\"\<converged\>\"", ",", "\"\<ok\>\""}], "]"}], ",", 
             "e"}], "}"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "0.", ",", "status", ",", "e"}], "}"}], 
            "]"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "No", " ", "other", " ", "solution", " ", "will", " ", "be", " ", 
     "calculated", " ", "when", " ", "status", " ", "records", " ", "an", " ",
      "error", " ", "message", " ", "in", " ", "this", " ", "pyramidal", " ", 
     "level"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"status", ":", " ", "\"\<OK\>\""}], " ", "->", " ", 
      RowBox[{"solution", " ", "respects", " ", "constraints"}]}], ",", "  ", 
     RowBox[{"errors", ":", " ", "\"\<sign\>\""}], ",", " ", "\"\<mag\>\"", 
     ",", " ", "\"\<flip\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"status", ":", " ", "\"\<converged\>\""}], " ", "->", " ", 
     RowBox[{"we", " ", 
      RowBox[{"converged", "!!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "\"\<sign\>\"", ",", "e_"}], "}"}], 
       ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "n_", ",", "\"\<ConstrainedCorrelation\>\""}], 
      "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2", ",", "\"\<sign\>\"", ",", "e"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "\"\<mag\>\"", ",", "e_"}], "}"}], 
       ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "n_", ",", "\"\<ConstrainedCorrelation\>\""}], 
      "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2", ",", "\"\<mag\>\"", ",", "e"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "\"\<corr\>\"", ",", "e_"}], "}"}], 
       ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "n_", ",", "\"\<ConstrainedCorrelation\>\""}], 
      "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2", ",", "\"\<corr\>\"", ",", "e"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "\"\<flip\>\"", ",", "e_"}], "}"}], 
       ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "n_", ",", "\"\<ConstrainedCorrelation\>\""}], 
      "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2", ",", "\"\<flip\>\"", ",", "e"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8363952713646383`*^9, 3.836395285622998*^9}, {
   3.836395339420894*^9, 3.836395340499365*^9}, {3.8363960314026394`*^9, 
   3.83639606263406*^9}, {3.836488222237672*^9, 3.8364882261367626`*^9}, 
   3.836488794120328*^9, 3.8366473739266353`*^9, {3.8370817604645205`*^9, 
   3.837081837795313*^9}, {3.8370818949284244`*^9, 3.83708194197997*^9}, {
   3.8370842312798247`*^9, 3.8370843044170694`*^9}, 3.837084651677993*^9, {
   3.8370847210046616`*^9, 3.837084725007778*^9}, {3.8377956666920443`*^9, 
   3.8377956995724106`*^9}, {3.8377957498926754`*^9, 3.83779581642708*^9}, {
   3.8378749336691175`*^9, 3.837874935107934*^9}, {3.837875154862604*^9, 
   3.8378751613696737`*^9}, {3.838079285613141*^9, 3.8380792941631727`*^9}, {
   3.8380795418031816`*^9, 3.838079563444045*^9}, {3.8380797346993732`*^9, 
   3.8380797393432436`*^9}, {3.83807982197386*^9, 3.8380798582862535`*^9}, {
   3.8380805890530586`*^9, 3.838080591503376*^9}, {3.8380809576132145`*^9, 
   3.8380809678530693`*^9}, {3.838740908992169*^9, 3.838740950609075*^9}, {
   3.838832496708708*^9, 3.838832519171462*^9}, {3.8400446630563745`*^9, 
   3.840044714150585*^9}, 3.8400449264576254`*^9, {3.8400453571541862`*^9, 
   3.8400453654985714`*^9}, {3.8400456962038565`*^9, 3.840045715342576*^9}, {
   3.8400459309942083`*^9, 3.8400459656201653`*^9}, {3.8400668389960976`*^9, 
   3.840066846494582*^9}, {3.8401886870003967`*^9, 3.840188820046699*^9}, {
   3.840188896296138*^9, 3.840188925231366*^9}, {3.840188999652712*^9, 
   3.840189013444944*^9}, {3.840189096038698*^9, 3.8401891974523277`*^9}, {
   3.840189624170314*^9, 3.840189800290779*^9}, {3.840189958389654*^9, 
   3.8401900137831907`*^9}, 3.8402120639745617`*^9, {3.8402121216067257`*^9, 
   3.84021212708329*^9}, {3.8402122805477524`*^9, 3.840212286917535*^9}, 
   3.8402132864409337`*^9, {3.840213485572333*^9, 3.840213490367629*^9}, {
   3.840214015425631*^9, 3.8402140182491136`*^9}, 3.8402801476209807`*^9, 
   3.84028020940808*^9, {3.840281347776226*^9, 3.8402813646606426`*^9}, 
   3.8402849362643695`*^9, {3.840285277474245*^9, 3.8402852834041367`*^9}, {
   3.8402881918413506`*^9, 3.8402881935364695`*^9}, {3.8402918630085573`*^9, 
   3.8402918666426845`*^9}, {3.840535302919426*^9, 3.8405353122265525`*^9}, {
   3.840535355695983*^9, 3.8405353675596466`*^9}, {3.8405478262244816`*^9, 
   3.8405478282532935`*^9}, {3.84054786170028*^9, 3.8405479597319727`*^9}, {
   3.8405487500943556`*^9, 3.8405487530817695`*^9}, {3.840549828869686*^9, 
   3.840549841777425*^9}, {3.8405509817557898`*^9, 3.840550982064629*^9}, {
   3.8405510933457384`*^9, 3.8405510984627314`*^9}, {3.8405511395527105`*^9, 
   3.840551141478009*^9}, {3.841319162361234*^9, 3.841319168699852*^9}, {
   3.842638275839821*^9, 3.842638283825076*^9}, 3.843047150844548*^9, {
   3.843047683246418*^9, 3.8430478826039906`*^9}, {3.8430662477842984`*^9, 
   3.84306626706721*^9}, {3.843066357433008*^9, 3.84306638005869*^9}, {
   3.843066471098827*^9, 3.843066471456827*^9}, {3.8430665682341595`*^9, 
   3.8430665823535037`*^9}, {3.843066614023039*^9, 3.8430666158403826`*^9}, {
   3.8430666478257236`*^9, 3.8430666560026145`*^9}, {3.843066691062875*^9, 
   3.843066695028036*^9}, {3.8430670820101533`*^9, 3.8430670822719493`*^9}, {
   3.8431531584724064`*^9, 3.8431532415742707`*^9}, {3.8431541924011116`*^9, 
   3.8431542010920024`*^9}, {3.8431543579685593`*^9, 3.84315458831942*^9}, {
   3.8436736200598516`*^9, 3.843673659839816*^9}, {3.843675802266506*^9, 
   3.84367580324864*^9}, {3.843676094738164*^9, 3.843676095993743*^9}, {
   3.843676148112191*^9, 3.843676217593154*^9}, {3.843747759180975*^9, 
   3.8437478035510416`*^9}, {3.843747837199093*^9, 3.843747911811542*^9}, 
   3.8437479433562737`*^9, {3.843748377618887*^9, 3.843748418267103*^9}, 
   3.8437487463423266`*^9, {3.8437522385411882`*^9, 3.8437522397665625`*^9}, {
   3.843752288076639*^9, 3.843752310561741*^9}, {3.843752372567502*^9, 
   3.8437523938328533`*^9}, {3.8437532528926954`*^9, 3.843753253873748*^9}, {
   3.8437532996776743`*^9, 3.8437533168563538`*^9}, {3.8437535125676455`*^9, 
   3.843753519661378*^9}, 3.8437535832591257`*^9, {3.8437536229410996`*^9, 
   3.8437536714702573`*^9}, {3.843753713138695*^9, 3.843753713497829*^9}, {
   3.8437538032027535`*^9, 3.8437538110533333`*^9}, {3.8437541111506634`*^9, 
   3.843754123500203*^9}, {3.843756514694689*^9, 3.8437565228370256`*^9}, {
   3.844259791226394*^9, 3.844259814136951*^9}, {3.8443564826670113`*^9, 
   3.8443564849271317`*^9}, {3.8443619303990293`*^9, 3.844361934480361*^9}, {
   3.844368304375413*^9, 3.8443683086155677`*^9}, {3.8444602254264507`*^9, 
   3.8444602371283655`*^9}, {3.84451200345923*^9, 3.844512005814104*^9}, {
   3.8445156047558804`*^9, 3.844515606918198*^9}, {3.8445158304009256`*^9, 
   3.8445158324047036`*^9}, {3.84451649753236*^9, 3.8445165016123977`*^9}, {
   3.8447823272091274`*^9, 3.844782349008145*^9}, {3.844782526684991*^9, 
   3.844782536256265*^9}, {3.8447826509613276`*^9, 3.8447826523153005`*^9}, {
   3.8447826850334997`*^9, 3.844782691498364*^9}, {3.845918060041156*^9, 
   3.8459181031181545`*^9}, 3.8459184702466784`*^9, {3.845999275777835*^9, 
   3.845999282502781*^9}, {3.8459997280634265`*^9, 3.84599975722418*^9}, {
   3.8459997899691124`*^9, 3.845999798075818*^9}, {3.8460001536819735`*^9, 
   3.8460001549021235`*^9}, 3.8460207290920916`*^9, {3.846086347396666*^9, 
   3.8460863496307783`*^9}, {3.8460864047584777`*^9, 
   3.8460864419004726`*^9}, {3.846086481744698*^9, 3.8460864838225775`*^9}, {
   3.8460865281713114`*^9, 3.8460865302178683`*^9}, 3.8460880621541615`*^9, 
   3.846088327560858*^9, {3.8460946963941307`*^9, 3.8460946974679675`*^9}, {
   3.8460947275175343`*^9, 3.8460947691694527`*^9}, {3.8460950090659475`*^9, 
   3.846095010209775*^9}, {3.846095545515373*^9, 3.8460955733652983`*^9}, {
   3.8460956070630035`*^9, 3.846095607370658*^9}, {3.8485005221415615`*^9, 
   3.8485005351640396`*^9}, 3.848500596684627*^9, 3.849033011396132*^9, {
   3.8490330991837425`*^9, 3.8490331139771614`*^9}, {3.849034018861663*^9, 
   3.849034024719659*^9}, 3.849034099764724*^9, 3.852306597585452*^9, {
   3.852383682075785*^9, 3.852383685820044*^9}, {3.852744070632491*^9, 
   3.8527440730820713`*^9}, {3.8527441202585278`*^9, 3.85274413073687*^9}, {
   3.852744165658305*^9, 3.852744167923217*^9}, {3.8551468207372737`*^9, 
   3.8551468407398677`*^9}, {3.856447044743679*^9, 3.856447047334985*^9}, {
   3.8564474774709873`*^9, 3.8564475090004773`*^9}, {3.8564478698418055`*^9, 
   3.8564478741110983`*^9}, {3.8564479270674095`*^9, 3.856447930316223*^9}, {
   3.8564479920635257`*^9, 3.856447993764702*^9}, {3.856448114413094*^9, 
   3.8564481155571074`*^9}, {3.8564481647094936`*^9, 3.856448167734836*^9}, {
   3.856448213271289*^9, 3.856448216576043*^9}, {3.8564483621388483`*^9, 
   3.85644839952388*^9}, 3.856448635564467*^9, {3.8564486687468185`*^9, 
   3.856448709681238*^9}, {3.8564497990169992`*^9, 3.8564498138303833`*^9}, {
   3.856452250271264*^9, 3.856452251864053*^9}, {3.856452299137845*^9, 
   3.8564523003864746`*^9}, {3.8564528520798693`*^9, 3.856452853398001*^9}, {
   3.856454183119191*^9, 3.856454205213834*^9}, {3.8564544301844893`*^9, 
   3.856454431451421*^9}, {3.8565205940683627`*^9, 3.856520595331495*^9}, {
   3.8565214317194443`*^9, 3.8565214326624546`*^9}, {3.8565215887906594`*^9, 
   3.8565215897779665`*^9}, {3.856523479068771*^9, 3.85652348049973*^9}, {
   3.856525454259033*^9, 3.8565254554092693`*^9}, {3.85653765065016*^9, 
   3.8565376518842487`*^9}, {3.8574892656055937`*^9, 3.857489311654109*^9}, {
   3.857489643646579*^9, 3.8574898939915075`*^9}, {3.8574903069537573`*^9, 
   3.857490337625303*^9}, 3.8574907829087*^9, {3.857490818504494*^9, 
   3.857490822270526*^9}, {3.857491198547326*^9, 3.8574912000722013`*^9}, {
   3.8574936757942505`*^9, 3.8574937199829893`*^9}, 3.857549633442726*^9, 
   3.8575500804043016`*^9, {3.8575503717350764`*^9, 3.8575504007566833`*^9}, {
   3.857552282131502*^9, 3.8575523016085773`*^9}, {3.857552634174591*^9, 
   3.857552648449004*^9}, {3.8575534459255466`*^9, 3.857553468698416*^9}, {
   3.8575553696791677`*^9, 3.8575553750475025`*^9}, {3.8575561844440303`*^9, 
   3.8575562359392166`*^9}, {3.8575565724556894`*^9, 3.857556602707012*^9}, 
   3.8575566537730618`*^9, 3.8575636063425813`*^9, {3.8575636721763544`*^9, 
   3.85756367894689*^9}, {3.8576384681157856`*^9, 3.857638472115906*^9}, {
   3.8577264425501595`*^9, 3.857726473404889*^9}, {3.8577265298515463`*^9, 
   3.8577265703975406`*^9}, {3.8577266592030334`*^9, 
   3.8577267518834243`*^9}, {3.857726816268937*^9, 3.857726831132719*^9}, {
   3.8581818307602506`*^9, 3.858181841268523*^9}, {3.8582427829101677`*^9, 
   3.858242786294116*^9}, {3.8582436135317545`*^9, 3.8582436269128914`*^9}, {
   3.858244725297767*^9, 3.8582447364296207`*^9}, {3.8582450703460703`*^9, 
   3.858245071415468*^9}, {3.8582455792761345`*^9, 3.858245580667602*^9}, {
   3.858245705721406*^9, 3.85824570680221*^9}, 3.8582491933978386`*^9, {
   3.8582497995283227`*^9, 3.8582498137110453`*^9}, {3.8582501422411137`*^9, 
   3.8582501434485283`*^9}, 3.858250726876048*^9, {3.8582510366717453`*^9, 
   3.8582510370364046`*^9}, {3.858251627320104*^9, 3.858251628392376*^9}, 
   3.8582520850046425`*^9},ExpressionUUID->"5e20ee3c-ab1e-4b5f-88fe-\
05549f24bf19"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Test", "Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"09c54b45-a793-4cfd-ad20-\
2e7a5f10a972"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"initial", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "v2", ",", "status", ",", "e"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0.5", ",", "\"\<ok\>\"", ",", "0."}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", "12"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8363961378588843`*^9, {3.8363967443857393`*^9, 3.8363967528759184`*^9}, {
   3.8363968389271307`*^9, 3.8363968394458265`*^9}, 3.8363986080928793`*^9, {
   3.8363995877529974`*^9, 3.8363995880494523`*^9}, {3.8401892506832857`*^9, 
   3.840189256145101*^9}, {3.84141418354974*^9, 3.841414205257785*^9}, {
   3.8430483435931425`*^9, 3.843048352325457*^9}, {3.8435736817894325`*^9, 
   3.8435736942554803`*^9}, {3.8437537396040974`*^9, 
   3.8437537554626484`*^9}, {3.8437538585293627`*^9, 
   3.8437538590227833`*^9}, {3.844782546275529*^9, 3.8447825467162204`*^9}, 
   3.844782672224075*^9, {3.846084808331871*^9, 3.846084901361394*^9}, {
   3.84632906290853*^9, 3.8463290682357426`*^9}, {3.846329127978734*^9, 
   3.8463291611583424`*^9}, {3.84632922227293*^9, 3.846329239028186*^9}, {
   3.8564533123361864`*^9, 3.8564533125451326`*^9}, {3.857490252750723*^9, 
   3.8574902532878556`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"0d67409b-4d6a-48b8-b944-4bb568d4db3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"status", "=", "\"\<ok\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.8437542033517194`*^9, 3.8437542128398094`*^9}, {
   3.844515659297496*^9, 3.844515674142517*^9}, {3.852820617799965*^9, 
   3.852820640371076*^9}, 3.8528207094904556`*^9, 3.856453277015154*^9, 
   3.857490234013149*^9, 3.8574902799617167`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"0a9858d9-ce69-4f7c-8261-cdfdd07ddfde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Test", " ", "for", " ", "PyrUpgrade1D"}], ",", " ", 
    RowBox[{
    "manual", " ", "test", " ", "to", " ", "iterate", " ", "multiple", " ", 
     "times"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "n", " ", "is", " ", "the", " ", "level", " ", "of", " ", "pyramid"}], " ",
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], "=", 
   RowBox[{"PyrUpgrade1D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], ",", "p", 
     ",", " ", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", "n", "]"}], "]"}], ",", "0.01", ",", "1", ",", 
     "noteBookMode"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8363967651550703`*^9, 3.8363968130279603`*^9}, {
   3.836396853335551*^9, 3.8363968558471217`*^9}, {3.836398527992988*^9, 
   3.836398541330168*^9}, {3.836399044228342*^9, 3.8363990495392766`*^9}, {
   3.836399208159257*^9, 3.8363992132916665`*^9}, {3.8400458463150663`*^9, 
   3.8400458889085207`*^9}, 3.8400459372136974`*^9, {3.8400459743200526`*^9, 
   3.840045979480372*^9}, {3.840189232799335*^9, 3.840189243506825*^9}, 
   3.8402145895445347`*^9, 3.8402800323364515`*^9, 3.840280121570874*^9, 
   3.840280181640683*^9, {3.840280221138157*^9, 3.8402802307424874`*^9}, {
   3.840280262614027*^9, 3.840280329574231*^9}, 3.840548072388741*^9, {
   3.841319243228366*^9, 3.8413192702952523`*^9}, {3.8413206397350407`*^9, 
   3.8413206517595778`*^9}, 3.8414141937325172`*^9, {3.843153289728837*^9, 
   3.8431533303648815`*^9}, 3.8435737335282726`*^9, {3.843673768874278*^9, 
   3.8436737693178988`*^9}, {3.843675813944577*^9, 3.843675814060481*^9}, {
   3.843676226210335*^9, 3.843676250671171*^9}, {3.8437479795353403`*^9, 
   3.8437479971997814`*^9}, {3.843748584473981*^9, 3.8437485968546877`*^9}, {
   3.8437524135173283`*^9, 3.8437524152382493`*^9}, {3.843753838280105*^9, 
   3.8437538424018755`*^9}, {3.8437540451602316`*^9, 3.8437540745383673`*^9}, 
   3.8437542020459256`*^9, {3.849033302647654*^9, 3.849033303632023*^9}, {
   3.855146848885496*^9, 3.855146849296422*^9}, {3.856453286120305*^9, 
   3.8564532873551855`*^9}, {3.856453387563385*^9, 3.8564534193133397`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"138e0c10-83f8-4277-9a6d-83aa60ccbc11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "see", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"seePlot", "[", 
   RowBox[{"p", ",", "5", ",", 
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2"}], "}"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8363983430106754`*^9, 3.8363983604496603`*^9}, {
   3.8363989657393045`*^9, 3.8363989940990686`*^9}, {3.836399252495593*^9, 
   3.836399458153307*^9}, 3.840214598251926*^9, 3.8402801272137938`*^9, {
   3.8402801885832624`*^9, 3.840280253201376*^9}, {3.840280283420054*^9, 
   3.8402803342978687`*^9}, 3.84054808258837*^9, 3.841319285628847*^9, {
   3.84315333406427*^9, 3.8431533569493647`*^9}, {3.8435736708990726`*^9, 
   3.843573675032316*^9}, 3.843748176006432*^9, {3.8437524294863195`*^9, 
   3.843752440945123*^9}, 3.8437538508453565`*^9, 3.8445156454523244`*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"a4eb40f2-6bad-494d-9176-eee04ab055d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PyrFlow1D", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9},ExpressionUUID->"a4c25ec2-f772-4494-87f0-\
6c86ae6eb27a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "will", " ", "only", " ", "give", " ", "values", " ", 
      "that", " ", "sum", " ", "up", " ", "to", " ", "the", " ", "magnitude", 
      " ", "of", " ", "v", " ", "\[IndentingNewLine]", "Or", " ", "if", " ", 
      "v0"}], " ", "=", " ", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"random", " ", "values", " ", "between", " ", "10", " ", "and"}],
      " ", "-", "10"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"allowed", " ", "failed", " ", "levels"}]}], ",", " ", 
    RowBox[{"u", "=", " ", 
     RowBox[{
     "shift", " ", "on", " ", "v", " ", "solution", " ", "through", " ", 
      "levels"}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"newValues", "[", 
    RowBox[{"i_", ",", "n_", ",", "u_", ",", 
     RowBox[{"{", 
      RowBox[{"v1_", ",", "v2_", ",", "status_", ",", "e_"}], "}"}], ",", 
     "newv0_", ",", "\"\<ConstrainedCorrelation\>\""}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "r", ",", "rs", ",", "newVals"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"v1", "+", "v2"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"e", ">", "n"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "0."}], "}"}], "}"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "\[NotEqual]", "0."}], " ", "&&", " ", 
          RowBox[{"status", "\[Equal]", "\"\<ok\>\""}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newVals", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "=", 
               RowBox[{"RandomReal", "[", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r", ",", 
                 RowBox[{"1", "-", "r"}]}], "}"}], "*", "v"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"u", "\[NotEqual]", "0."}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"newVals", ",", 
              RowBox[{"newVals", "-", "u"}], ",", " ", 
              RowBox[{"newVals", "+", "u"}]}], "]"}], ",", "newVals"}], 
           "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "newv0"}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8444612782790546`*^9, 3.844461325604576*^9}, {
   3.8444614444947405`*^9, 3.844461444680009*^9}, {3.8444616627212477`*^9, 
   3.8444617077996845`*^9}, {3.844461750131506*^9, 3.844461922366767*^9}, 
   3.844461992692705*^9, {3.844512017440218*^9, 3.8445120256983542`*^9}, {
   3.8445122065868797`*^9, 3.8445122095714564`*^9}, {3.844513491064845*^9, 
   3.844513494072491*^9}, {3.8445142258228316`*^9, 3.844514312429041*^9}, {
   3.844514415782257*^9, 3.844514441020333*^9}, 3.8445145878545675`*^9, {
   3.844516209750566*^9, 3.8445162128424377`*^9}, {3.844516353977727*^9, 
   3.8445164220099287`*^9}, {3.8445200934575386`*^9, 
   3.8445200959212675`*^9}, {3.844955341554967*^9, 3.8449553524295*^9}, {
   3.8450304282022247`*^9, 3.8450304305575495`*^9}, 3.845037288844064*^9, {
   3.845037352023071*^9, 3.8450373985419507`*^9}, {3.8450374655873547`*^9, 
   3.8450374689407897`*^9}, {3.845037715084822*^9, 3.845037758048954*^9}, {
   3.8450448673646674`*^9, 3.845044868815566*^9}, {3.845046972287678*^9, 
   3.845046973292132*^9}, {3.8459181523994007`*^9, 3.845918212292648*^9}, {
   3.8459184851144123`*^9, 3.845918488148816*^9}, {3.845918637593907*^9, 
   3.845918651943948*^9}, 3.8459188651809173`*^9, {3.8460197890200834`*^9, 
   3.8460198128202815`*^9}, {3.8460198949855614`*^9, 3.8460199127711*^9}, {
   3.846020910983465*^9, 3.846020914248888*^9}, {3.846020948908036*^9, 
   3.8460209591148877`*^9}, {3.846021089282728*^9, 3.846021127719087*^9}, {
   3.8460851128439245`*^9, 3.8460851170900936`*^9}, {3.8460856051591797`*^9, 
   3.846085605331028*^9}, {3.846095612450843*^9, 3.8460956798514886`*^9}, 
   3.8460957584121923`*^9, 3.846095806312417*^9, {3.8460959465482035`*^9, 
   3.84609598682932*^9}, {3.848500539732272*^9, 3.8485005439937525`*^9}, 
   3.848500601273676*^9, 3.8490333981906986`*^9, {3.8490338103468447`*^9, 
   3.8490338106280293`*^9}, 3.85230660551797*^9, {3.8551434446329966`*^9, 
   3.855143505442374*^9}, {3.855143600689752*^9, 3.8551436090310946`*^9}, {
   3.85514364962446*^9, 3.8551437522459106`*^9}, {3.8551437833140087`*^9, 
   3.8551438273049507`*^9}, {3.855143865001834*^9, 3.8551438665448036`*^9}, {
   3.855146203414523*^9, 3.855146261354411*^9}, {3.8551665354856873`*^9, 
   3.8551665500895023`*^9}, {3.855236633498632*^9, 3.855236695755658*^9}, 
   3.856454649790596*^9, {3.8565136059768715`*^9, 3.8565136289339166`*^9}, 
   3.857489899747528*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"d2398203-6386-43c0-9979-4c3a161cff6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "create", " ", "the", " ", "list", " ", "of", " ", "values", 
     " ", "in", " ", "case", " ", "v"}], "=", "0"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "=", 
     RowBox[{"RandomReal", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rangev0", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "1", ",", "0.2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"newv0", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"1", "-", "r"}]}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "r"}], ",", "r"}], "}"}], "*", "#"}], "&"}], "/@",
        "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8450447961470428`*^9, 3.84504486192747*^9}, {
   3.8450477213099747`*^9, 3.845047735608878*^9}, {3.845998533077533*^9, 
   3.845998537668522*^9}, 3.846021855425663*^9, 3.8460219091850967`*^9, 
   3.852308794093945*^9, 3.857491305265151*^9, 3.857491344917156*^9, 
   3.8574914546575747`*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"2bd77349-c9bc-44ac-a63c-3ac4e9680b0d"],

Cell[BoxData[{
 RowBox[{"nV", "=", 
  RowBox[{"newValues", "[", 
   RowBox[{"10", ",", "1", ",", "0.25", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1."}], ",", "\"\<ok\>\"", ",", "1."}], "}"}], ",", 
    "newv0", ",", "noteBookMode"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "/@", "nV"}]}], "Input",
 CellChangeTimes->{{3.8444617140346737`*^9, 3.8444617347846212`*^9}, {
   3.844461808872343*^9, 3.8444618170070076`*^9}, {3.8444619033008537`*^9, 
   3.8444619337709484`*^9}, {3.8445122194771366`*^9, 
   3.8445122413158827`*^9}, {3.844512362020856*^9, 3.844512362180772*^9}, {
   3.8445143201938887`*^9, 3.8445143394214225`*^9}, {3.844514444454789*^9, 
   3.844514453803335*^9}, 3.844516223273226*^9, {3.8450374078987455`*^9, 
   3.845037428030212*^9}, {3.84504487350133*^9, 3.8450448751270533`*^9}, {
   3.845047741752062*^9, 3.8450477436917725`*^9}, {3.8459182397694316`*^9, 
   3.8459182457373877`*^9}, {3.845998523959859*^9, 3.845998524451099*^9}, {
   3.846021755261832*^9, 3.8460217586190915`*^9}, {3.846085848611929*^9, 
   3.8460858946636086`*^9}, {3.8460860381303816`*^9, 
   3.8460860426293545`*^9}, {3.8460865712288933`*^9, 
   3.8460865730409603`*^9}, {3.846095815516721*^9, 3.846095829278038*^9}, {
   3.8460958773960066`*^9, 3.846095881233713*^9}, {3.8460959604244823`*^9, 
   3.8460959614994926`*^9}, {3.852308827707631*^9, 3.85230883938664*^9}, {
   3.8528214016878104`*^9, 3.8528214163500533`*^9}, {3.855146269297724*^9, 
   3.855146286718229*^9}, {3.8552367150751543`*^9, 3.8552367686268826`*^9}, {
   3.857552682831026*^9, 3.857552684886938*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"a2d66308-b602-429c-a4cb-375b3cdee7c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "will", " ", "give", " ", "back", " ", "a", " ", "value", 
     " ", "that", " ", "converged", " ", "or", " ", "is", " ", "on", " ", 
     "\"\<ok\>\"", " ", 
     RowBox[{"status", ".", " ", "If"}], " ", "not"}], ",", " ", 
    RowBox[{"error", " ", "is", " ", "returned", " ", "and", " ", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2"}], "}"}], " ", "goes", " ", "back", " ", "to", 
     " ", "0."}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pickNewValue", "[", 
    RowBox[{
    "tableNewVals_", ",", "condition_", ",", 
     "\"\<ConstrainedCorrelation\>\""}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newValOk", ",", "newValCon", ",", "newValAny", ",", "noFakeConverge"}],
       "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Criterias", " ", "to", " ", "select", " ", "a", " ", "solution"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newValCon", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"tableNewVals", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
              "\"\<converged\>\""}], ")"}], "&&", 
            RowBox[{"condition", "[", "#", "]"}]}], "&"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newValAny", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"tableNewVals", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<ok\>\""}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<okcorr\>\""}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<oksign\>\""}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<okmag\>\""}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<converged\>\""}]}], ")"}], "&&", 
            RowBox[{"condition", "[", "#", "]"}]}], "&"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newValOk", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"tableNewVals", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "\"\<ok\>\""}], "||", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
               "\"\<oksign\>\""}], "||", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "\"\<okmag\>\""}],
               "||", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
               "\"\<okcorr\>\""}]}], ")"}], "&&", " ", 
            RowBox[{"condition", "[", "#", "]"}]}], "&"}], ",", "1"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"noFakeConverge", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"tableNewVals", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
              "\"\<ok\>\""}], "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
              "\"\<oksign\>\""}], "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
              "\"\<okmag\>\""}], "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
              "\"\<okcorr\>\""}], "&&", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
              "\"\<converged\>\""}]}], ")"}], "&"}], ",", "1"}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"No", " ", "solution", " ", "meets", " ", "criteria"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"newValCon", "\[Equal]", 
           RowBox[{"{", "}"}]}], "&&", 
          RowBox[{"newValAny", "\[Equal]", 
           RowBox[{"{", "}"}]}], "&&", 
          RowBox[{"newValOk", "\[Equal]", 
           RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"noFakeConverge", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "0.", ",", "\"\<fakeconverged\>\"", ",", 
              RowBox[{
               RowBox[{"tableNewVals", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "4"}], "]"}], "]"}], "+", "1"}]}], "}"}], 
            "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "0.", ",", 
              RowBox[{"noFakeConverge", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
              RowBox[{"noFakeConverge", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "solution", " ", "meets", " ", "criteria", " ", "but", " ", "it", 
           " ", "did", " ", "not", " ", "converge"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"newValCon", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "solution", " ", "meets", " ", "criteria", " ", "but", " ", 
             RowBox[{"isn", "'"}], "t", " ", "ok", " ", "or", " ", 
             "converged"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"newValOk", "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"newValAny", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"newValOk", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", 
                   RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
                "\"\<ok\>\"", ",", 
                RowBox[{"newValOk", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "4"}], "]"}], "]"}]}], "}"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"newValCon", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", ")"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.844462754631737*^9, 3.8444628201358075`*^9}, {
   3.8444628882695293`*^9, 3.8444629100440626`*^9}, 3.844463007546508*^9, {
   3.8444630757865353`*^9, 3.8444631139402637`*^9}, {3.844463401643854*^9, 
   3.8444634786750946`*^9}, {3.844463586249464*^9, 3.8444636494751883`*^9}, {
   3.844463682583321*^9, 3.8444637031772294`*^9}, {3.844463924790797*^9, 
   3.8444639289631586`*^9}, {3.8444639810663843`*^9, 3.8444641244819984`*^9}, 
   3.8444687035611553`*^9, {3.844512874276967*^9, 3.8445129886481595`*^9}, {
   3.8445141007182693`*^9, 3.844514126835699*^9}, {3.844514163494574*^9, 
   3.8445141666815147`*^9}, {3.844514595376998*^9, 3.8445146477215595`*^9}, {
   3.8449553556067853`*^9, 3.8449553559599857`*^9}, 3.8450378756013985`*^9, {
   3.845037940092245*^9, 3.845037999784536*^9}, {3.8450384331500416`*^9, 
   3.845038435309373*^9}, {3.845038775409644*^9, 3.8450388297344503`*^9}, {
   3.8450389859878855`*^9, 3.8450390344000597`*^9}, {3.8456575620143347`*^9, 
   3.8456575685119963`*^9}, {3.845998611362694*^9, 3.845998617607574*^9}, 
   3.8460020989436474`*^9, {3.846018677328916*^9, 3.846018677775216*^9}, 
   3.846018880796386*^9, {3.846019116136244*^9, 3.846019173366503*^9}, {
   3.8460192515065284`*^9, 3.8460192528890114`*^9}, {3.846019610710576*^9, 
   3.846019619271961*^9}, 3.846020801971831*^9, {3.846021529128915*^9, 
   3.846021536340768*^9}, {3.8460852132039795`*^9, 3.8460852169216146`*^9}, {
   3.846085530410911*^9, 3.8460855309110503`*^9}, {3.8460869673692822`*^9, 
   3.846087000251961*^9}, {3.8460871143659906`*^9, 3.8460871172715235`*^9}, {
   3.8460877961782217`*^9, 3.846087844208644*^9}, 3.850837236413035*^9, 
   3.8508372722343097`*^9, {3.852296462099272*^9, 3.852296464911374*^9}, {
   3.8523854352975464`*^9, 3.8523854547360992`*^9}, {3.852385496361577*^9, 
   3.85238562039371*^9}, {3.8527432088486824`*^9, 3.8527432218235254`*^9}, {
   3.8527435019009695`*^9, 3.8527435541477547`*^9}, {3.8527437064598026`*^9, 
   3.8527437211275034`*^9}, {3.8527441958724775`*^9, 
   3.8527442339899826`*^9}, {3.852744271335647*^9, 3.8527442887340937`*^9}, {
   3.8527443426410046`*^9, 3.8527443753010826`*^9}, {3.8527444786250196`*^9, 
   3.8527445026695147`*^9}, {3.852744559128996*^9, 3.852744561137597*^9}, {
   3.852744721260515*^9, 3.852744731960111*^9}, {3.8527449994285345`*^9, 
   3.8527450516374097`*^9}, {3.852749940217804*^9, 3.85274995512965*^9}, {
   3.852750067314996*^9, 3.8527500688591976`*^9}, {3.8527502641293297`*^9, 
   3.852750370426917*^9}, {3.852750421148426*^9, 3.852750595515209*^9}, {
   3.8527515442537084`*^9, 3.8527515928277674`*^9}, {3.85297081698942*^9, 
   3.852970860546382*^9}, {3.8529709291186075`*^9, 3.8529709649686575`*^9}, {
   3.8529711236231775`*^9, 3.8529711263697677`*^9}, {3.8551521455991807`*^9, 
   3.8551521623206778`*^9}, {3.8551522617913895`*^9, 3.855152429126685*^9}, {
   3.8551528484009542`*^9, 3.8551528559939003`*^9}, {3.8551529070755835`*^9, 
   3.8551529134625826`*^9}, {3.8551530963727336`*^9, 3.855153120830872*^9}, {
   3.8551532812074757`*^9, 3.8551532861816883`*^9}, {3.855153387492076*^9, 
   3.85515338809706*^9}, {3.8551534416957507`*^9, 3.8551535203025956`*^9}, {
   3.855153610884737*^9, 3.855153611229391*^9}, 3.8551536487098727`*^9, {
   3.8556559910564337`*^9, 3.8556560093210025`*^9}, {3.855656394588664*^9, 
   3.855656401750655*^9}, {3.8556590431601486`*^9, 3.855659048136428*^9}, {
   3.855660475487583*^9, 3.8556604817032766`*^9}, {3.8557606677063026`*^9, 
   3.8557607197596273`*^9}, {3.8557607945493555`*^9, 
   3.8557608409524345`*^9}, {3.8557630289229317`*^9, 3.855763030902635*^9}, {
   3.855763185096842*^9, 3.8557631950930204`*^9}, {3.8557632889367094`*^9, 
   3.855763294949029*^9}, {3.8557633544692287`*^9, 3.8557633668868732`*^9}, {
   3.855764099897932*^9, 3.855764152546324*^9}, {3.8557642308248053`*^9, 
   3.8557642558182864`*^9}, {3.855764331814102*^9, 3.855764339373496*^9}, {
   3.8557643754814777`*^9, 3.855764380517579*^9}, {3.8557647663608*^9, 
   3.855764767997353*^9}, {3.855764930992894*^9, 3.8557649337759805`*^9}, {
   3.855765228993084*^9, 3.8557652408744197`*^9}, {3.855765275229665*^9, 
   3.8557652886897087`*^9}, {3.8558429360649214`*^9, 3.855842963751007*^9}, {
   3.8558430017861567`*^9, 3.8558430187176776`*^9}, {3.8558430906754856`*^9, 
   3.855843097706618*^9}, {3.8558431318403845`*^9, 3.8558431619377146`*^9}, {
   3.85645037671861*^9, 3.856450391760558*^9}, {3.856452157845505*^9, 
   3.8564521699662495`*^9}, 3.8574899120405345`*^9, {3.8574900176246505`*^9, 
   3.8574900373033648`*^9}, {3.857490070508364*^9, 3.8574900754142733`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"3b77723e-5b7c-4b87-a566-76e628ef95bf"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "condition", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"condition", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], " ", "&&", " ", 
      RowBox[{"0", "<", 
       RowBox[{"(*", 
        RowBox[{"Abs", "["}], "*)"}], 
       RowBox[{"Total", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], 
       RowBox[{"(*", "]", "*)"}], "<", 
       RowBox[{"dis", "+", "1"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8557652938245554`*^9, {3.8574912476864347`*^9, 3.857491249735211*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"08e05903-787d-43a8-99d8-db087c7053c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"threshold", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"i", "=", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"updateValues", "=", 
    RowBox[{"{", 
     RowBox[{"0.", ",", "0.", ",", "\"\<ok\>\"", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "will", " ", "only", " ", "give", " ", "values", " ", 
      "that", " ", "sum", " ", "up", " ", "to", " ", "the", " ", "magnitude", 
      " ", "of", " ", "v", " ", "\[IndentingNewLine]", "Or", " ", "if", " ", 
      "v0"}], " ", "=", " ", "0"}], ",", " ", 
    RowBox[{
    "list", " ", "newv0", " ", "is", " ", "created", " ", "and", " ", "fed", 
     " ", "to", " ", "the", " ", "function", " ", "to", " ", "try", " ", 
     "all", " ", 
     RowBox[{"it", "'"}], "s", " ", "contained", " ", "values"}]}], " ", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nV", "=", 
    RowBox[{"newValues", "[", 
     RowBox[{"10", ",", "0", ",", "0", ",", 
      RowBox[{"updateValues", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "newv0", ",", 
      "noteBookMode"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tableNV", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tValues", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"v", ",", 
           RowBox[{"updateValues", "[", 
            RowBox[{"[", 
             RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tValues", "=", 
          RowBox[{"PyrUpgrade1D", "[", 
           RowBox[{"tValues", ",", "p0", ",", "  ", 
            RowBox[{"pyrf12", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", 
            RowBox[{"threshold", "*", 
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "n"}], "+", "1"}], ")"}]}]}], ",", "0", ",", 
            "noteBookMode"}], "]"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "tValues"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"v", ",", "nV"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "tableNV", "\
\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"pickNewValue", "[", 
   RowBox[{"tableNV", ",", "condition", ",", "noteBookMode"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.844512465652463*^9, 3.8445126589651527`*^9}, 
   3.844512696700407*^9, {3.8445127397523556`*^9, 3.8445127770015326`*^9}, 
   3.844512836960084*^9, {3.844514523287268*^9, 3.844514592311226*^9}, 
   3.8445146572758875`*^9, {3.8445157328956614`*^9, 3.8445157967537203`*^9}, {
   3.844515854741083*^9, 3.8445158692234373`*^9}, {3.844515900171852*^9, 
   3.8445159113818007`*^9}, {3.844960825416167*^9, 3.8449608326621675`*^9}, 
   3.8450378099077854`*^9, 3.845038006025897*^9, {3.845039038790265*^9, 
   3.8450390397869205`*^9}, {3.845044890366269*^9, 3.8450448920499763`*^9}, {
   3.845047769282398*^9, 3.845047795159435*^9}, {3.84591828507213*^9, 
   3.8459182912915144`*^9}, 3.846019257618719*^9, {3.8460208160192947`*^9, 
   3.8460208645720215`*^9}, {3.8460209788702793`*^9, 3.8460209926060295`*^9}, 
   3.846021742436345*^9, {3.8460218159794292`*^9, 3.8460218163150682`*^9}, {
   3.8460219593228226`*^9, 3.846022029946898*^9}, {3.8460220758808374`*^9, 
   3.8460220762055054`*^9}, {3.8460230529286184`*^9, 3.8460231106115284`*^9}, 
   3.8460960212472897`*^9, {3.8490342669233866`*^9, 3.8490342670952153`*^9}, {
   3.849034307882209*^9, 3.8490343280495815`*^9}, {3.8523088791885805`*^9, 
   3.852308897030178*^9}, {3.852744926915022*^9, 3.8527449271632814`*^9}, {
   3.855150297949961*^9, 3.8551503005235343`*^9}, {3.85515037942356*^9, 
   3.8551503956349363`*^9}, {3.855765301593768*^9, 3.8557653039136367`*^9}, {
   3.8564535889420166`*^9, 3.856453643785864*^9}, {3.856453695291876*^9, 
   3.8564537117696733`*^9}, {3.856453743276025*^9, 3.8564537449932175`*^9}, {
   3.856453840879693*^9, 3.8564538948953533`*^9}, {3.857490365404431*^9, 
   3.8574903781464367`*^9}, {3.8574904777556744`*^9, 
   3.8574905211131134`*^9}, {3.857491376532021*^9, 3.8574914235615215`*^9}, {
   3.8574914690124965`*^9, 3.8574914844710073`*^9}, 3.8574915601880665`*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"210d9792-72c0-46f2-9ed0-2441a1782fd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "see", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"seePlot", "[", 
   RowBox[{"p0", ",", "5", ",", 
    RowBox[{"sol", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.8460218930933437`*^9, {3.846023115078058*^9, 3.8460231176116033`*^9}, {
   3.8523089129205112`*^9, 3.8523089196145062`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"cc9b0cb0-f357-44ab-8811-9a55a4754405"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "to", " ", "find", " ", "solutions", " ", "for", " ", 
    "all", " ", "levels", " ", "of", " ", "pyramid", " ", 
    RowBox[{"{", 
     RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", "..."}], "}"}], " ", 
    "or", " ", 
    RowBox[{"{", "l1", "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"number", " ", "of", " ", "iterations"}], ",", " ", 
      RowBox[{"allowed", " ", "failed", " ", "levels"}], ",", " ", 
      RowBox[{
      "shift", " ", "on", " ", "v", " ", "solution", " ", "through", " ", 
       "levels"}], ",", " ", 
      RowBox[{"pixel", " ", "of", " ", "interests"}], ",", " ", 
      "pyrfunctions", ",", "threshold"}], " "}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"v1", ",", " ", "v2", ",", "status"}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PyrFlow1D", "[", 
     RowBox[{
     "i_", ",", "n_", ",", "u_", ",", " ", "p0_", ",", "listv0_", ",", 
      "condition_", ",", " ", "pyrfunctions_", ",", "threshold_", ",", 
      "\"\<ConstrainedCorrelation\>\""}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c", ",", " ", "updateValues", ",", "nV", ",", "tableNewValues", ",", 
        "tValues"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"Length", "[", "pyrfunctions", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"{", 
          RowBox[{"v1", ",", " ", "v2", ",", " ", "status", ",", " ", "e"}], 
          "}"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"updateValues", "=", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0.", ",", "\"\<ok\>\"", ",", "0."}], "}"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Flag", " ", "to", " ", "stop", " ", "when", " ", "e"}], 
           "\[GreaterEqual]", "n"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "<=", "n"}], ",", 
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", "\"\<ok\>\""}], ",", " ", 
             RowBox[{"updateValues", "=", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", 
                RowBox[{"updateValues", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"updateValues", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "This", " ", "will", " ", "only", " ", "give", " ", "values", 
               " ", "that", " ", "sum", " ", "up", " ", "to", " ", "the", " ",
                "magnitude", " ", "of", " ", "v", " ", "\[IndentingNewLine]", 
               "Or", " ", "if", " ", "v0"}], " ", "=", " ", "0"}], ",", " ", 
             RowBox[{
             "list", " ", "newv0", " ", "is", " ", "created", " ", "and", " ",
               "fed", " ", "to", " ", "the", " ", "function", " ", "to", " ", 
              "try", " ", "all", " ", 
              RowBox[{"it", "'"}], "s", " ", "contained", " ", "values"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"nV", "=", 
            RowBox[{"newValues", "[", 
             RowBox[{"10", ",", "n", ",", "u", ",", 
              RowBox[{"updateValues", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "listv0", ",", 
              "\"\<ConstrainedCorrelation\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"compute", " ", "at", " ", "this", " ", "scale"}], ",", 
             " ", 
             RowBox[{
             "using", " ", "current", " ", "motion", " ", "estimate"}]}], " ",
             "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"tableNewValues", "=", 
            RowBox[{
            "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "We", " ", "initialize", " ", "whith", " ", "values", " ", 
               "calculated", " ", "at", " ", "nV", " ", "and", " ", "last", 
               " ", "calculated", " ", 
               RowBox[{"updateValues", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tValues", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"v", ",", 
                   RowBox[{"updateValues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "}"}], "]"}]}], 
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"Do", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"tValues", "=", 
                   RowBox[{"PyrUpgrade1D", "[", 
                    RowBox[{"tValues", ",", "p0", ",", " ", 
                    RowBox[{"pyrfunctions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "f"}], "]"}], "]"}], ",", 
                    RowBox[{"threshold", "*", 
                    RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "c"}], "+", "1"}], ")"}]}]}], ",", "n", ",", 
                    "\"\<ConstrainedCorrelation\>\""}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"tValues", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "!=", "\"\<ok\>\""}], ",", 
                    RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "tValues"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"v", ",", "nV"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "We", " ", "only", " ", "update", " ", "updateValues", " ", 
             "with", " ", "the", " ", "tValue", " ", "that", " ", 
             "converged"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"updateValues", "=", 
            RowBox[{"pickNewValue", "[", 
             RowBox[{
             "tableNewValues", ",", "condition", ",", 
              "\"\<ConstrainedCorrelation\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"c", "-", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "1", ",", 
            RowBox[{"Length", "[", "pyrfunctions", "]"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"updateValues", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.836395257636574*^9, 3.836395272859167*^9}, {
   3.83708196322594*^9, 3.8370820062598658`*^9}, {3.837083182655498*^9, 
   3.8370832734823055`*^9}, {3.8370843532979484`*^9, 
   3.8370843675088606`*^9}, {3.838080701244558*^9, 3.8380807259152684`*^9}, {
   3.838080793823208*^9, 3.8380808755938196`*^9}, {3.8380809401222954`*^9, 
   3.838080942274747*^9}, 3.8380810086446276`*^9, {3.8380816063631763`*^9, 
   3.8380816393331475`*^9}, {3.8380820470151634`*^9, 
   3.8380820558435106`*^9}, {3.8380823886542034`*^9, 
   3.8380824062240515`*^9}, {3.8380824773647776`*^9, 
   3.8380825736331425`*^9}, {3.8380826279050765`*^9, 3.838082713503049*^9}, {
   3.8380828471635237`*^9, 3.8380828901935434`*^9}, {3.83848262336782*^9, 
   3.8384826483396864`*^9}, {3.838483209637656*^9, 3.838483252891429*^9}, {
   3.83848337672888*^9, 3.838483389713195*^9}, 3.8384834622891912`*^9, {
   3.838483925470047*^9, 3.838483959825934*^9}, 3.8384839932092*^9, {
   3.8384840245223246`*^9, 3.83848406745443*^9}, {3.8384841090878415`*^9, 
   3.838484119135103*^9}, {3.8384842940787163`*^9, 3.8384842965189843`*^9}, {
   3.838484331536871*^9, 3.838484376855281*^9}, {3.8384844316993575`*^9, 
   3.8384844364710684`*^9}, {3.838484472533862*^9, 3.838484496768239*^9}, {
   3.838484653516262*^9, 3.8384846980991325`*^9}, 3.8384847407136316`*^9, {
   3.838484789836351*^9, 3.838484836358838*^9}, {3.838485707284088*^9, 
   3.838485708317006*^9}, {3.838745304433283*^9, 3.838745304748513*^9}, 
   3.8387454287233124`*^9, {3.838745566958905*^9, 3.838745572968202*^9}, {
   3.838832480835082*^9, 3.8388324858883576`*^9}, 3.838832662601839*^9, 
   3.8400444674100447`*^9, {3.840044657898258*^9, 3.840044675080756*^9}, {
   3.840044792234081*^9, 3.8400448028818226`*^9}, {3.840045382891678*^9, 
   3.8400454107116804`*^9}, {3.8400457742282677`*^9, 3.840045782682536*^9}, {
   3.840046004923623*^9, 3.840046009099416*^9}, 3.8400460619888587`*^9, {
   3.8400460949919004`*^9, 3.84004610011978*^9}, {3.8400461438186865`*^9, 
   3.8400461690448275`*^9}, {3.8400536215227985`*^9, 
   3.8400536593035183`*^9}, {3.840053705946847*^9, 3.840053723757249*^9}, {
   3.8400537835503826`*^9, 3.8400538050647817`*^9}, {3.8400538490526533`*^9, 
   3.840053877267029*^9}, {3.840054015361252*^9, 3.840054050881156*^9}, 
   3.8400541211876483`*^9, {3.840054841363824*^9, 3.840054842590229*^9}, {
   3.8400548774584274`*^9, 3.8400548954699373`*^9}, 3.840062489108899*^9, {
   3.8400625230755796`*^9, 3.8400625357077594`*^9}, {3.840062608567613*^9, 
   3.840062609225909*^9}, 3.840064282796586*^9, {3.840064347610565*^9, 
   3.8400643514241934`*^9}, {3.840064435863537*^9, 3.840064436038506*^9}, {
   3.840066248372734*^9, 3.8400662514900155`*^9}, {3.8400664641163483`*^9, 
   3.8400664688160753`*^9}, 3.8400666848661065`*^9, {3.8400668057053223`*^9, 
   3.8400668205868874`*^9}, {3.8400669375243015`*^9, 3.840067029056565*^9}, {
   3.8400670665699735`*^9, 3.8400670668913956`*^9}, {3.8400673521968985`*^9, 
   3.840067373037039*^9}, {3.8400674925370984`*^9, 3.840067499815276*^9}, {
   3.8400676885764246`*^9, 3.8400676914667573`*^9}, {3.840067767866358*^9, 
   3.840067799215399*^9}, {3.8400678334141483`*^9, 3.840067834605913*^9}, {
   3.8400678737948313`*^9, 3.840067881587015*^9}, {3.840067987954644*^9, 
   3.840067988566532*^9}, {3.8400687429367623`*^9, 3.8400688146563964`*^9}, 
   3.8400688885471363`*^9, {3.8400690624252715`*^9, 3.8400690763966675`*^9}, {
   3.840069180186268*^9, 3.84006918878432*^9}, {3.8400699684665527`*^9, 
   3.840070030673232*^9}, {3.840070069194943*^9, 3.840070130021838*^9}, {
   3.8400702050033846`*^9, 3.840070295059636*^9}, {3.8400703424521255`*^9, 
   3.8400703701890373`*^9}, {3.840070536126915*^9, 3.840070543162916*^9}, {
   3.8400707194066267`*^9, 3.840070723381528*^9}, {3.840071016027475*^9, 
   3.840071035148421*^9}, 3.840071082957506*^9, {3.8400711294374886`*^9, 
   3.8400712078568583`*^9}, {3.8400720622403393`*^9, 3.840072062449636*^9}, {
   3.8400725161957693`*^9, 3.8400725194734535`*^9}, {3.840190301254188*^9, 
   3.840190369112875*^9}, {3.840190421163118*^9, 3.840190483558923*^9}, {
   3.8401905169341288`*^9, 3.8401905686044073`*^9}, {3.840190665069972*^9, 
   3.840190691093354*^9}, {3.840190764716844*^9, 3.840190909552351*^9}, {
   3.840190952571726*^9, 3.840190994597392*^9}, 3.840191052489993*^9, {
   3.84019109858766*^9, 3.840191106858177*^9}, {3.840212643647187*^9, 
   3.8402126587042575`*^9}, {3.840212948316355*^9, 3.840213092874155*^9}, {
   3.8402131666079383`*^9, 3.8402131696129346`*^9}, {3.8402143027437525`*^9, 
   3.8402143267459517`*^9}, {3.8402804561573114`*^9, 3.840280523225045*^9}, {
   3.8402809376168385`*^9, 3.840280971021533*^9}, {3.8402849953143473`*^9, 
   3.840284995539066*^9}, {3.840285203246116*^9, 3.8402852211954503`*^9}, {
   3.8405484745807753`*^9, 3.840548502614027*^9}, {3.840548682116254*^9, 
   3.8405486958534555`*^9}, {3.8405779593968954`*^9, 
   3.8405779632643437`*^9}, {3.841320470752817*^9, 3.8413204988403115`*^9}, 
   3.843047234386615*^9, 3.8430472681286163`*^9, {3.84304837339767*^9, 
   3.8430484122480726`*^9}, {3.8430489408235273`*^9, 
   3.8430489753452682`*^9}, {3.8431533802072535`*^9, 3.843153400508676*^9}, {
   3.843154934308928*^9, 3.8431552055729947`*^9}, {3.843673779979858*^9, 
   3.843673789025011*^9}, 3.843673852135035*^9, {3.843674526555189*^9, 
   3.843674537257772*^9}, {3.843674794777981*^9, 3.8436747954682493`*^9}, {
   3.843675843849382*^9, 3.843675846572392*^9}, {3.843676285948403*^9, 
   3.843676311895507*^9}, {3.8437483660430927`*^9, 3.843748369909861*^9}, {
   3.843748466865801*^9, 3.843748496811301*^9}, {3.8437485324572587`*^9, 
   3.843748532728025*^9}, {3.8437524869653664`*^9, 3.8437524904354153`*^9}, {
   3.843752560973708*^9, 3.8437525791150923`*^9}, 3.843752658661976*^9, {
   3.8437532609577184`*^9, 3.8437532630116253`*^9}, {3.843753321731477*^9, 
   3.8437533404766655`*^9}, 3.8437535235027065`*^9, {3.8437542615756073`*^9, 
   3.8437545058254924`*^9}, {3.843754584362295*^9, 3.843754613448418*^9}, {
   3.843754788152096*^9, 3.8437547901701674`*^9}, {3.84446023967266*^9, 
   3.844460243138896*^9}, {3.8444607278874874`*^9, 3.8444607297363987`*^9}, {
   3.844460774388563*^9, 3.844460843946801*^9}, {3.844462037391844*^9, 
   3.844462105400992*^9}, {3.844462169596165*^9, 3.84446222491173*^9}, {
   3.8444623679769106`*^9, 3.844462391371277*^9}, {3.844462439619422*^9, 
   3.844462440758129*^9}, {3.8444624986906347`*^9, 3.8444625790197444`*^9}, {
   3.844462952206507*^9, 3.8444629975774703`*^9}, {3.8444630353273516`*^9, 
   3.8444630422572412`*^9}, {3.8444630963197064`*^9, 3.844463097574968*^9}, {
   3.8444631367198167`*^9, 3.8444631620261145`*^9}, {3.8444631957424603`*^9, 
   3.844463217092122*^9}, {3.844463279949193*^9, 3.844463282173604*^9}, {
   3.8444635938104506`*^9, 3.844463601998819*^9}, {3.8444638964881496`*^9, 
   3.844463899627947*^9}, 3.844464021984146*^9, {3.844464194811337*^9, 
   3.844464197865275*^9}, {3.8444642413958893`*^9, 3.844464282685113*^9}, {
   3.844464603077302*^9, 3.8444646428051577`*^9}, {3.8444647003023415`*^9, 
   3.8444647101585493`*^9}, {3.8444650402932653`*^9, 3.844465047181552*^9}, 
   3.8444687193751507`*^9, {3.844469164171029*^9, 3.84446916505202*^9}, {
   3.844469262191881*^9, 3.844469273354315*^9}, {3.8445147154312534`*^9, 
   3.844514920195876*^9}, {3.8445150225856075`*^9, 3.8445150482989445`*^9}, {
   3.844515133898366*^9, 3.8445151681683445`*^9}, {3.8445152348500757`*^9, 
   3.844515453692839*^9}, {3.8445154857004576`*^9, 3.8445154866340466`*^9}, {
   3.8445159926576605`*^9, 3.844515993121111*^9}, {3.844516074572565*^9, 
   3.8445160903677597`*^9}, {3.8445161517680817`*^9, 
   3.8445161878225985`*^9}, {3.844516251196046*^9, 3.844516273742357*^9}, {
   3.84451646477081*^9, 3.8445164780299234`*^9}, 3.8445165295396204`*^9, {
   3.8445165629572544`*^9, 3.844516592682452*^9}, {3.8445169157063313`*^9, 
   3.8445169192029696`*^9}, 3.844516963591753*^9, {3.8448672233060846`*^9, 
   3.844867245115175*^9}, {3.844867353997981*^9, 3.844867357674706*^9}, {
   3.8448674432605042`*^9, 3.8448674485507154`*^9}, {3.844869076768549*^9, 
   3.844869085865178*^9}, {3.8448731333838654`*^9, 3.8448731338260813`*^9}, 
   3.8448737701146564`*^9, {3.844955365518254*^9, 3.8449553724457283`*^9}, 
   3.845030439682123*^9, {3.8450375386523123`*^9, 3.845037545723833*^9}, 
   3.8450382282659655`*^9, {3.845038281748803*^9, 3.8450383149303274`*^9}, {
   3.8450384076219177`*^9, 3.8450384106480255`*^9}, {3.8450384691870403`*^9, 
   3.8450384694118032`*^9}, {3.845038525051551*^9, 3.8450385294382544`*^9}, {
   3.8450390760778513`*^9, 3.8450390898653*^9}, {3.8450391231991873`*^9, 
   3.845039124190837*^9}, {3.845044900308997*^9, 3.8450449085151877`*^9}, {
   3.8450478878754888`*^9, 3.8450478911507916`*^9}, {3.845918130250128*^9, 
   3.845918143807156*^9}, {3.8459988288087425`*^9, 3.8459988385172453`*^9}, {
   3.8459988752133303`*^9, 3.8459988833283424`*^9}, {3.84599903561343*^9, 
   3.8459990448355284`*^9}, {3.8459990809048405`*^9, 3.845999094061246*^9}, {
   3.845999185714033*^9, 3.84599920077864*^9}, 3.845999453539628*^9, {
   3.845999812775424*^9, 3.8459998209297647`*^9}, {3.846000004463835*^9, 
   3.846000008580392*^9}, {3.8460009720676517`*^9, 3.8460009811076927`*^9}, {
   3.8460197840505905`*^9, 3.8460197844570885`*^9}, {3.846019863658993*^9, 
   3.846019868489476*^9}, 3.846019942481623*^9, {3.8460210288916287`*^9, 
   3.8460210293879004`*^9}, 3.846085913627901*^9, 3.846085981096647*^9, 
   3.8460880792910357`*^9, 3.8460883386833396`*^9, {3.846092834426603*^9, 
   3.8460928488245487`*^9}, {3.846094490813854*^9, 3.846094491057413*^9}, {
   3.846094812361848*^9, 3.8460948175266514`*^9}, 3.846094876780088*^9, {
   3.846094965181115*^9, 3.8460949743163085`*^9}, {3.846095037921819*^9, 
   3.8460950403162622`*^9}, {3.846095070558279*^9, 3.8460950769618917`*^9}, {
   3.8460951140344286`*^9, 3.8460951234958487`*^9}, {3.8460952865340257`*^9, 
   3.8460952952741537`*^9}, 3.8460954210148797`*^9, {3.8460955191167483`*^9, 
   3.8460955195314646`*^9}, {3.846095621104643*^9, 3.846095627437854*^9}, 
   3.8460957744472537`*^9, 3.8463283255360327`*^9, {3.8463283779065075`*^9, 
   3.84632843784424*^9}, {3.8463284954456854`*^9, 3.8463284974766197`*^9}, {
   3.846328747191173*^9, 3.8463287484723854`*^9}, {3.8463288529685507`*^9, 
   3.8463288665369644`*^9}, {3.846328962699226*^9, 3.846328975097176*^9}, {
   3.846329196527423*^9, 3.846329203266567*^9}, {3.8463292857804523`*^9, 
   3.8463292869853487`*^9}, {3.846329559633199*^9, 3.846329596163855*^9}, {
   3.8463296327608476`*^9, 3.846329639537835*^9}, {3.8463297026085835`*^9, 
   3.8463297028175774`*^9}, {3.8463299835875034`*^9, 3.846329985632037*^9}, {
   3.846330040372553*^9, 3.846330041582344*^9}, {3.848498810425356*^9, 
   3.8484988107865243`*^9}, {3.8485005525416346`*^9, 3.848500552982191*^9}, 
   3.848500606539936*^9, {3.8490331293172626`*^9, 3.8490331374091053`*^9}, {
   3.8490335009474487`*^9, 3.8490335110198793`*^9}, {3.849033862943802*^9, 
   3.8490338691610503`*^9}, {3.84903415954405*^9, 3.849034159824979*^9}, 
   3.85230351622507*^9, 3.8523066366174097`*^9, 3.855146154973547*^9, {
   3.855146302143237*^9, 3.855146318472378*^9}, {3.855146348989067*^9, 
   3.855146356044076*^9}, {3.8551464034754276`*^9, 3.8551464208663516`*^9}, {
   3.8551468742536554`*^9, 3.855146874542386*^9}, {3.855164498762229*^9, 
   3.8551645013324347`*^9}, {3.8551665801616864`*^9, 
   3.8551665830343313`*^9}, {3.8557653330357637`*^9, 3.855765348171381*^9}, {
   3.856028993246252*^9, 3.85602900255161*^9}, {3.8564503567521996`*^9, 
   3.856450358706246*^9}, {3.8564540472172804`*^9, 3.8564540716419888`*^9}, {
   3.8564542430834246`*^9, 3.8564542434382925`*^9}, 3.856513551299432*^9, {
   3.8565136756593227`*^9, 3.8565136828902445`*^9}, 3.8565234709525375`*^9, {
   3.8565242165473156`*^9, 3.8565242206795516`*^9}, {3.857489929387499*^9, 
   3.8574899446504917`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"d9b9e833-8770-43d6-9196-3f072660ee39"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"1677df7d-d338-4ae0-86ef-\
227ba8502fad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "condition", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"condition", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], " ", "&&", " ", 
    RowBox[{"0", "<", 
     RowBox[{"(*", 
      RowBox[{"Abs", "["}], "*)"}], 
     RowBox[{"Total", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], 
     RowBox[{"(*", "]", "*)"}], "<", 
     RowBox[{"dis", "+", "2"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8557653726933913`*^9, 3.8557653749240737`*^9}, {
  3.857491581224055*^9, 3.857491584115293*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"b3e9302c-f436-4a5a-8d84-0d7bab68e55c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", "14"}], ";"}]], "Input",
 CellChangeTimes->{{3.846328896022578*^9, 3.8463289074786158`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"b14c0653-3e9f-41bc-ad3b-fb428643f9e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"RandomReal", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rangev0", "=", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "5"}], ",", "5", ",", "0.5"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newv0", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"1", "-", "r"}]}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "r"}], ",", "r"}], "}"}], "*", "#"}], "&"}], "/@",
        "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tes1", "=", 
   RowBox[{"lineTest", "[", 
    RowBox[{"0", ",", "0", ",", "newv0", ",", "condition", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "30"}], "]"}], ",", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "0.001", ",", 
     "noteBookMode"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "function", " ", "is", " ", "called", " ", "from", " ", 
    "pyramidalCyclope1D"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "newv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "30"}], "]"}], ",", 
   RowBox[{"pyrf12", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "0.001", ",", 
   "noteBookMode"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8430541726603727`*^9, 3.8430542426021805`*^9}, {
   3.8430542768852186`*^9, 3.843054302157134*^9}, {3.843054883911598*^9, 
   3.843054892362711*^9}, {3.843675061980145*^9, 3.843675066076097*^9}, 
   3.843675916016576*^9, {3.8437488485031247`*^9, 3.843748850201047*^9}, 
   3.843749691364495*^9, {3.8437501069007096`*^9, 3.8437501071598454`*^9}, {
   3.8437524967568636`*^9, 3.843752505823826*^9}, {3.8437527308973703`*^9, 
   3.843752736972122*^9}, 3.8437533329129972`*^9, {3.844464480693434*^9, 
   3.844464504604334*^9}, {3.84486825964192*^9, 3.844868272187944*^9}, {
   3.8448683520091214`*^9, 3.844868356341675*^9}, {3.844868427697589*^9, 
   3.8448684476274395`*^9}, {3.8448685418473353`*^9, 3.844868563237012*^9}, {
   3.8448691126289816`*^9, 3.844869155906944*^9}, {3.8450361773449993`*^9, 
   3.84503617876492*^9}, {3.8450376268553333`*^9, 3.845037637354021*^9}, {
   3.845037672100178*^9, 3.8450376743438373`*^9}, {3.8450449336238585`*^9, 
   3.8450449411574297`*^9}, {3.845047809720543*^9, 3.845047835488903*^9}, 
   3.8459188305217996`*^9, {3.845998657736218*^9, 3.845998673314041*^9}, {
   3.846000313466345*^9, 3.846000314942738*^9}, 3.846021239109475*^9, {
   3.8460212767184973`*^9, 3.846021316800701*^9}, {3.846021392877076*^9, 
   3.8460213943050365`*^9}, {3.846021479068741*^9, 3.8460214897007265`*^9}, {
   3.846088175327531*^9, 3.8460881759055147`*^9}, {3.8460882689329014`*^9, 
   3.846088273291252*^9}, 3.846092139476152*^9, 3.8460927783810167`*^9, {
   3.8460944463150587`*^9, 3.846094446828704*^9}, 3.846094521910573*^9, 
   3.846094557562827*^9, {3.8460946063029823`*^9, 3.846094607469708*^9}, 
   3.846094716725874*^9, 3.846094791662265*^9, {3.8463289105203114`*^9, 
   3.846328933151903*^9}, {3.846328999885933*^9, 3.8463290037897797`*^9}, {
   3.849033430776492*^9, 3.8490334403055115`*^9}, {3.849034375957921*^9, 
   3.8490343857681007`*^9}, {3.8551467760707083`*^9, 3.855146780342425*^9}, {
   3.855147874949031*^9, 3.855147884864988*^9}, {3.8551479152537065`*^9, 
   3.8551479280205803`*^9}, 3.8551480181420155`*^9, {3.855148168929095*^9, 
   3.8551482071331615`*^9}, {3.8551482494181504`*^9, 3.8551482583580112`*^9}, 
   3.8557649591724815`*^9, {3.8557658707823973`*^9, 3.8557658807619715`*^9}, {
   3.8564539525745745`*^9, 3.856453991322014*^9}, 3.856454136478945*^9, {
   3.856454256164117*^9, 3.856454267088217*^9}, {3.857491602827239*^9, 
   3.8574916049729156`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"a2f96ad6-157a-40a4-b5dc-b0107b8c5ea4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"4d225df1-a7b8-4e3e-b420-\
6ff5f34abf9d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"RandomReal", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rangev0", "=", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "5"}], ",", "5", ",", "0.5"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newv0", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"1", "-", "r"}]}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "r"}], ",", "r"}], "}"}], "*", "#"}], "&"}], "/@",
        "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tes1", "=", 
   RowBox[{"lineTest", "[", 
    RowBox[{"0", ",", "0.1", ",", "newv0", ",", "condition", ",", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"p", "-", "5"}], ",", 
       RowBox[{"p", "+", "5"}]}], "]"}], ",", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "0.001", ",", 
     "noteBookMode"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "function", " ", "is", " ", "called", " ", "from", " ", 
    "pyramidalCyclope1D"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "newv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"p", "-", "6"}], ",", 
     RowBox[{"p", "+", "6"}]}], "]"}], ",", 
   RowBox[{"pyrf12", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "0.001", ",", 
   "noteBookMode"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8430541726603727`*^9, 3.8430542426021805`*^9}, {
   3.8430542768852186`*^9, 3.843054302157134*^9}, {3.843054883911598*^9, 
   3.843054892362711*^9}, {3.843675061980145*^9, 3.843675066076097*^9}, 
   3.843675916016576*^9, {3.8437488485031247`*^9, 3.843748850201047*^9}, 
   3.843749691364495*^9, {3.8437501069007096`*^9, 3.8437501071598454`*^9}, {
   3.8437524967568636`*^9, 3.843752505823826*^9}, {3.8437527308973703`*^9, 
   3.843752736972122*^9}, 3.8437533329129972`*^9, {3.844464480693434*^9, 
   3.844464504604334*^9}, {3.84486825964192*^9, 3.844868272187944*^9}, {
   3.8448683520091214`*^9, 3.844868356341675*^9}, {3.844868427697589*^9, 
   3.8448684476274395`*^9}, {3.8448685418473353`*^9, 3.844868563237012*^9}, {
   3.8448691126289816`*^9, 3.844869155906944*^9}, {3.8450361773449993`*^9, 
   3.84503617876492*^9}, {3.8450376268553333`*^9, 3.845037637354021*^9}, {
   3.845037672100178*^9, 3.8450376743438373`*^9}, {3.8450449336238585`*^9, 
   3.8450449411574297`*^9}, {3.845047809720543*^9, 3.845047835488903*^9}, 
   3.8459188305217996`*^9, {3.845998657736218*^9, 3.845998673314041*^9}, {
   3.846000313466345*^9, 3.846000314942738*^9}, 3.846021239109475*^9, {
   3.8460212767184973`*^9, 3.846021316800701*^9}, {3.846021392877076*^9, 
   3.8460213943050365`*^9}, {3.846021479068741*^9, 3.8460214897007265`*^9}, {
   3.846088175327531*^9, 3.8460881759055147`*^9}, {3.8460882689329014`*^9, 
   3.846088273291252*^9}, 3.846092139476152*^9, 3.8460927783810167`*^9, {
   3.8460944463150587`*^9, 3.846094446828704*^9}, 3.846094521910573*^9, 
   3.846094557562827*^9, {3.8460946063029823`*^9, 3.846094607469708*^9}, 
   3.846094716725874*^9, 3.846094791662265*^9, {3.846328944814293*^9, 
   3.8463289588384256`*^9}, {3.8527448744504375`*^9, 3.852744875646369*^9}, {
   3.8551468977516117`*^9, 3.8551469117386503`*^9}, {3.855765896768709*^9, 
   3.855765947888356*^9}, 3.857491668558053*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"9fd57488-dee4-4f36-8bcc-ab84a909ef9e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"1addfeb2-5c39-4529-bb6d-\
d0c229ca6ab7"],

Cell["\<\
0.01*2^(-m) depends on m to update the error depending on the highest \
resolution scale\
\>", "Text",
 CellChangeTimes->{{3.840548374592219*^9, 
  3.8405484003331394`*^9}},ExpressionUUID->"880a687b-6dd2-4828-9358-\
0c01b407a3f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v1", ",", " ", "v2", ",", "status", ",", "e"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "3", ",", "\"\<ok\>\"", ",", "0."}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", "=", "40"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "=", "13"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"m", "\[Rule]", " ", 
     RowBox[{"max", " ", "lvl"}]}], ",", " ", 
    RowBox[{"n", "\[Rule]", " ", 
     RowBox[{"min", " ", "lvl"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"PyrFlow1D", " ", "solution"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"v1", ",", "v2", ",", "status"}], "}"}], "=", 
  RowBox[{"PyrFlow1D", "[", 
   RowBox[{"i", ",", "0", ",", "0", ",", "p", ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1.2"}], "}"}], "}"}], ",", "condition", ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", 
      RowBox[{"m", ";;", "n"}], "]"}], "]"}], ",", 
    RowBox[{"0.0001", "*", 
     RowBox[{"2", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "m"}], "+", "1"}], ")"}]}]}], ",", "noteBookMode"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2"}], "}"}], "]"}], ",", "status"}], 
  "}"}]}], "Input",
 CellChangeTimes->{{3.83639948364995*^9, 3.836399519806125*^9}, {
   3.8363995590245132`*^9, 3.83639960757861*^9}, {3.838080084756638*^9, 
   3.8380800851141353`*^9}, {3.8380804424545712`*^9, 
   3.8380804457646008`*^9}, {3.8380805343644238`*^9, 
   3.8380805622628913`*^9}, {3.8380806157132387`*^9, 3.8380806315133705`*^9}, 
   3.838080662503994*^9, {3.838080878494111*^9, 3.838080920662928*^9}, 
   3.838082457493312*^9, {3.840045753265614*^9, 3.8400457539577885`*^9}, 
   3.84004579390691*^9, {3.840046163537953*^9, 3.840046164081414*^9}, {
   3.840064234698558*^9, 3.8400642457064667`*^9}, 3.8400643170265927`*^9, {
   3.8400670995057793`*^9, 3.8400671416366897`*^9}, {3.840067276996817*^9, 
   3.840067280625373*^9}, 3.8400676368053093`*^9, 3.8400679985153937`*^9, {
   3.840191148333891*^9, 3.840191262607202*^9}, {3.8402805474678636`*^9, 
   3.8402805841324234`*^9}, 3.8402806423025513`*^9, {3.8402806786126747`*^9, 
   3.840280914219866*^9}, 3.8402810301816626`*^9, 3.840281335289158*^9, 
   3.8402847673221245`*^9, {3.8402849473165145`*^9, 3.840284950986496*^9}, 
   3.8402850025598235`*^9, {3.8405484097849054`*^9, 3.8405484111283555`*^9}, {
   3.8405485354254704`*^9, 3.8405485555772915`*^9}, {3.8405486541284895`*^9, 
   3.8405486554873114`*^9}, {3.840548721600456*^9, 3.840548733226588*^9}, {
   3.8405488364992127`*^9, 3.840548857907818*^9}, {3.8413207426066556`*^9, 
   3.8413207925909653`*^9}, {3.8413209376882544`*^9, 3.8413210241504335`*^9}, 
   3.8413222332344046`*^9, {3.8414140432904825`*^9, 3.8414140724559326`*^9}, {
   3.84141413690991*^9, 3.84141413740768*^9}, {3.8414142297267976`*^9, 
   3.841414240079482*^9}, {3.841414549010152*^9, 3.8414145504451213`*^9}, {
   3.8414146901179533`*^9, 3.8414146986307*^9}, {3.841415020445265*^9, 
   3.841415021414605*^9}, {3.8430474058140574`*^9, 3.843047448725752*^9}, {
   3.84367389883642*^9, 3.843673905167404*^9}, {3.843675682137754*^9, 
   3.843675684292006*^9}, 3.8437485674067793`*^9, {3.8437487258149405`*^9, 
   3.843748726711255*^9}, {3.8437526740847363`*^9, 3.843752682484831*^9}, {
   3.8437546371842413`*^9, 3.8437546374028807`*^9}, {3.843754674012761*^9, 
   3.843754739857795*^9}, 3.8437553466508884`*^9, 3.8444611315278234`*^9, {
   3.8444611768614936`*^9, 3.8444611887169385`*^9}, 3.844462125512904*^9, 
   3.844462356446972*^9, {3.8444633170999546`*^9, 3.844463321081232*^9}, 
   3.844463957058437*^9, 3.8444640642630997`*^9, {3.844464176408199*^9, 
   3.8444642066331835`*^9}, {3.844464361712132*^9, 3.8444644432157106`*^9}, {
   3.8445155082491083`*^9, 3.8445155337439795`*^9}, {3.84451594973834*^9, 
   3.8445159707794123`*^9}, {3.8445160028143573`*^9, 3.844516016773574*^9}, {
   3.844867278823122*^9, 3.8448672867837*^9}, {3.8448674780006113`*^9, 
   3.844867482844355*^9}, {3.8448675512620215`*^9, 3.844867552535472*^9}, 
   3.8448690922499695`*^9, {3.8450375572578297`*^9, 3.8450375788333464`*^9}, {
   3.845038492456919*^9, 3.845038495570486*^9}, {3.8450391079598455`*^9, 
   3.845039108408127*^9}, {3.8450401552418346`*^9, 3.845040155409791*^9}, {
   3.8450449183244*^9, 3.8450449251510773`*^9}, {3.845998917876772*^9, 
   3.8459989184715147`*^9}, 3.8459989522552752`*^9, {3.8460211607198453`*^9, 
   3.8460212127086706`*^9}, 3.8460927662680087`*^9, {3.8463293246755347`*^9, 
   3.8463293261140614`*^9}, {3.8463293581547394`*^9, 
   3.8463293659078813`*^9}, {3.8463293973199778`*^9, 
   3.8463293984381676`*^9}, {3.8463294366454444`*^9, 3.846329444948153*^9}, {
   3.846329501624301*^9, 3.8463295154348464`*^9}, {3.846329660714734*^9, 
   3.846329681480458*^9}, {3.8551469174833937`*^9, 3.855146919967126*^9}, {
   3.8551504468889384`*^9, 3.855150494510594*^9}, {3.855765997912092*^9, 
   3.855765999229164*^9}, {3.857491733472609*^9, 3.857491735734412*^9}, {
   3.857491808271325*^9, 3.857491915288178*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"afc14aa7-2bb9-4d9b-b7f5-afd1fea2872d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "see", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"seePlot", "[", 
   RowBox[{"p", ",", "5", ",", 
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2"}], "}"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", "m", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8363995323142886`*^9, 3.8363995497959876`*^9}, {
   3.836399619173401*^9, 3.836399627315104*^9}, {3.8384848657173834`*^9, 
   3.8384848695138836`*^9}, {3.8400640901794996`*^9, 3.840064096563566*^9}, 
   3.8400642190695267`*^9, 3.840064254160406*^9, 3.8400643231875253`*^9, 
   3.8400671534853387`*^9, 3.840067289625275*^9, 3.840067719035468*^9, 
   3.8400678437352333`*^9, 3.840067979214921*^9, 3.840068024446211*^9, 
   3.8400681171252265`*^9, {3.8400681524745507`*^9, 3.840068183426964*^9}, {
   3.8400682390152364`*^9, 3.8400682603653374`*^9}, 3.8400703249464455`*^9, {
   3.840070381556637*^9, 3.8400703854466133`*^9}, 3.8400705520194263`*^9, {
   3.84019115414285*^9, 3.840191221424403*^9}, 3.840280708155969*^9, 
   3.8402807658886623`*^9, {3.840280821326911*^9, 3.8402808379807625`*^9}, 
   3.8402809199145455`*^9, {3.8405485709314113`*^9, 3.8405485739471397`*^9}, 
   3.8413207591374435`*^9, {3.8413208116846724`*^9, 3.8413208985881786`*^9}, {
   3.843153463279521*^9, 3.843153469118759*^9}, {3.8436756974695063`*^9, 
   3.8436757009951077`*^9}, {3.843748733032687*^9, 3.8437487368004684`*^9}, 
   3.843752705032522*^9, 3.8445155022047677`*^9, {3.84451610892062*^9, 
   3.84451616442041*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"53f7faf6-a305-4fa8-ae79-0e1ed081f6fc"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8574918487421365`*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"15f26ce9-df36-4e91-aa9d-b1be1886509a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics for All pixels", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431519453413677`*^9, 
  3.8431519506391954`*^9}},ExpressionUUID->"d69ea01b-c1ef-4113-8cab-\
b11ccf013757"],

Cell[CellGroupData[{

Cell["All Pixel Graphics", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9, {3.842703573534071*^9, 3.8427035807603846`*^9}, {
   3.843053597749626*^9, 
   3.84305360317021*^9}},ExpressionUUID->"c8124fb5-6975-4957-950c-\
1a0ca8f99e5a"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"8aa49981-e1b7-40e4-b201-\
cbbe28e3204e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"RandomReal", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rangev0", "=", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{"-", "5"}], ",", "5", ",", "0.2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newv0", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{"1", "-", "r"}]}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "r"}], ",", "r"}], "}"}], "*", "#"}], "&"}], "/@",
        "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "*", "#"}], "&"}], "/@", 
       "rangev0"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tes1", "=", 
   RowBox[{"lineTest", "[", 
    RowBox[{"0", ",", "0", ",", "newv0", ",", "condition", ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "line1", "]"}]}], "]"}], ",", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "0.001", ",", 
     "noteBookMode"}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "function", " ", "is", " ", "called", " ", "from", " ", 
    "pyramidalCyclope1D"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "newv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "30"}], "]"}], ",", 
   RowBox[{"pyrf12", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "0.001", ",", 
   "noteBookMode"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8430541726603727`*^9, 3.8430542426021805`*^9}, {
   3.8430542768852186`*^9, 3.843054302157134*^9}, {3.843054883911598*^9, 
   3.843054892362711*^9}, {3.843675061980145*^9, 3.843675066076097*^9}, 
   3.843675916016576*^9, {3.8437488485031247`*^9, 3.843748850201047*^9}, 
   3.843749691364495*^9, {3.8437501069007096`*^9, 3.8437501071598454`*^9}, {
   3.8437524967568636`*^9, 3.843752505823826*^9}, {3.8437527308973703`*^9, 
   3.843752736972122*^9}, 3.8437533329129972`*^9, {3.844464480693434*^9, 
   3.844464504604334*^9}, {3.84486825964192*^9, 3.844868272187944*^9}, {
   3.8448683520091214`*^9, 3.844868356341675*^9}, {3.844868427697589*^9, 
   3.8448684476274395`*^9}, {3.8448685418473353`*^9, 3.844868563237012*^9}, {
   3.8448691126289816`*^9, 3.844869155906944*^9}, {3.8450361773449993`*^9, 
   3.84503617876492*^9}, {3.8450376268553333`*^9, 3.845037637354021*^9}, {
   3.845037672100178*^9, 3.8450376743438373`*^9}, {3.8450449336238585`*^9, 
   3.8450449411574297`*^9}, {3.845047809720543*^9, 3.845047835488903*^9}, 
   3.8459188305217996`*^9, {3.845998657736218*^9, 3.845998673314041*^9}, {
   3.846000313466345*^9, 3.846000314942738*^9}, 3.846021239109475*^9, {
   3.8460212767184973`*^9, 3.846021316800701*^9}, {3.846021392877076*^9, 
   3.8460213943050365`*^9}, {3.846021479068741*^9, 3.8460214897007265`*^9}, {
   3.846088175327531*^9, 3.8460881759055147`*^9}, {3.8460882689329014`*^9, 
   3.846088273291252*^9}, 3.846092139476152*^9, 3.8460927783810167`*^9, {
   3.8460944463150587`*^9, 3.846094446828704*^9}, 3.846094521910573*^9, 
   3.846094557562827*^9, {3.8460946063029823`*^9, 3.846094607469708*^9}, 
   3.846094716725874*^9, 3.846094791662265*^9, {3.8551469467352247`*^9, 
   3.855146956689831*^9}, {3.8557662129647484`*^9, 3.8557662327008734`*^9}, {
   3.8574919729053545`*^9, 3.857491979914592*^9}, 3.8574920127491627`*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"a088f1dc-28e3-40d6-a93b-5301bc0a6bd5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics for One pixel", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431519453413677`*^9, 
  3.8431519506391954`*^9}, {3.843758114814825*^9, 
  3.8437581174592934`*^9}},ExpressionUUID->"b94d5e78-6273-405e-baaa-\
6e385d5d2376"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pickNewValueIter", "[", 
   RowBox[{
   "tableIterNewVals_", ",", "condition_", ",", 
    "\"\<ConstrainedCorrelation\>\""}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newIterValCon", ",", "newIterValAny", ",", "newIterValOk", ",", 
      "noIterFakeConverge"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newIterValCon", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"tableIterNewVals", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
             "\"\<converged\>\""}], "&&", 
            RowBox[{"condition", "[", 
             RowBox[{"Last", "[", "#", "]"}], "]"}]}], ")"}], "&"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newIterValAny", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"tableIterNewVals", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<ok\>\""}], " ", "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<okcorr\>\""}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<oksign\>\""}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<okmag\>\""}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<converged\>\""}]}], ")"}], "&&", 
            RowBox[{"condition", "[", 
             RowBox[{"Last", "[", "#", "]"}], "]"}]}], ")"}], "&"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newIterValOk", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"tableIterNewVals", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "\"\<ok\>\""}], 
              " ", "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
               "\"\<okcorr\>\""}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
               "\"\<oksign\>\""}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
               "\"\<okmag\>\""}]}], ")"}], "&&", 
            RowBox[{"condition", "[", 
             RowBox[{"Last", "[", "#", "]"}], "]"}]}], ")"}], "&"}], ",", 
         "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"noIterFakeConverge", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"tableIterNewVals", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
             "\"\<ok\>\""}], " ", "||", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
             "\"\<okcorr\>\""}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
             "\"\<oksign\>\""}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
             "\"\<okmag\>\""}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
             "\"\<converged\>\""}]}], ")"}], "&"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"No", " ", "solution", " ", "meets", " ", "criteria"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"newIterValCon", "\[Equal]", 
          RowBox[{"{", "}"}]}], "&&", 
         RowBox[{"newIterValAny", "\[Equal]", 
          RowBox[{"{", "}"}]}], "&&", 
         RowBox[{"newIterValOk", "\[Equal]", 
          RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"noIterFakeConverge", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "If", " ", "any", " ", "kind", " ", "of", " ", "ok", " ", "does", 
             " ", "not", " ", "meet", " ", "the", " ", "criteria"}], ",", " ", 
            RowBox[{
            "there", " ", "is", " ", "no", " ", "solution", " ", "in", " ", 
             "this", " ", "lvl"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"tableIterNewVals", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", "\"\<fakeconverge\>\"", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Last", "[", 
                   RowBox[{"tableIterNewVals", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], "}"}], "]"}], 
             "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"noIterFakeConverge", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", 
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"noIterFakeConverge", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Last", "[", 
                  RowBox[{"noIterFakeConverge", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], "}"}]}], 
           "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "solution", " ", "meets", " ", "criteria", " ", "but", " ", "it", 
          " ", "did", " ", "not", " ", "converge"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newIterValCon", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"solution", " ", "meets", " ", "criteria", " ", "but", " ", 
            RowBox[{"isn", "'"}], "t", " ", "ok", " ", "or", " ", 
            "converged"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newIterValOk", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"newIterValAny", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"newIterValOk", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Last", "[", 
                    RowBox[{"newIterValOk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "\"\<ok\>\"",
                   ",", 
                  RowBox[{
                   RowBox[{"Last", "[", 
                    RowBox[{"newIterValOk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], "}"}]}], 
             "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"newIterValCon", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.844466207590722*^9, 3.8444663304974847`*^9}, {
   3.844466467059284*^9, 3.844466482937065*^9}, {3.8444669028168545`*^9, 
   3.8444669220431056`*^9}, {3.8444670322139096`*^9, 
   3.8444670870482016`*^9}, {3.8444671566049376`*^9, 3.844467158920144*^9}, {
   3.844467196948223*^9, 3.8444672718024893`*^9}, {3.844467321158042*^9, 
   3.8444673278403487`*^9}, 3.844468299730402*^9, {3.844468502462919*^9, 
   3.8444685083530297`*^9}, {3.844520161191785*^9, 3.8445202245778556`*^9}, {
   3.844520332705359*^9, 3.844520377455515*^9}, 3.84452048068826*^9, {
   3.8445205845433617`*^9, 3.84452068650521*^9}, {3.8445209863115625`*^9, 
   3.8445209977867584`*^9}, {3.844955378499539*^9, 3.844955378702995*^9}, {
   3.8450399851794863`*^9, 3.8450399905968895`*^9}, {3.8450402066544905`*^9, 
   3.845040239394699*^9}, {3.8450434161210747`*^9, 3.8450434242961826`*^9}, {
   3.845043604555329*^9, 3.8450436349903736`*^9}, {3.8450478558828373`*^9, 
   3.845047867869722*^9}, {3.8456575526918926`*^9, 3.8456575749662375`*^9}, {
   3.846000761958229*^9, 3.84600076666483*^9}, 3.8460020837549314`*^9, {
   3.8460186851196623`*^9, 3.8460186856315947`*^9}, 3.846018886808941*^9, {
   3.8460189616153903`*^9, 3.846019059973849*^9}, {3.846019103568391*^9, 
   3.8460191037534432`*^9}, {3.846019638725012*^9, 3.846019644968521*^9}, {
   3.846086647334755*^9, 3.846086666377084*^9}, {3.846086708054812*^9, 
   3.8460867093045206`*^9}, {3.8460870240121717`*^9, 
   3.8460870976665087`*^9}, {3.8460873018211837`*^9, 
   3.8460873044143124`*^9}, {3.846087339218552*^9, 3.846087399411335*^9}, {
   3.8460874432447863`*^9, 3.846087446900208*^9}, {3.8460876173270864`*^9, 
   3.8460876318802443`*^9}, {3.8460876965682096`*^9, 
   3.8460877516886625`*^9}, {3.8508372581114907`*^9, 3.850837263091693*^9}, {
   3.8522965309940023`*^9, 3.8522965322534323`*^9}, {3.852968052962956*^9, 
   3.852968185273698*^9}, {3.8529682158799944`*^9, 3.85296822633492*^9}, {
   3.85296991268752*^9, 3.852969940706086*^9}, {3.852969995282267*^9, 
   3.8529700071252728`*^9}, {3.852970650559586*^9, 3.8529706778025503`*^9}, {
   3.852971101081891*^9, 3.852971103299384*^9}, {3.8551639164802256`*^9, 
   3.8551639166976075`*^9}, {3.8551641531771183`*^9, 3.855164324709685*^9}, {
   3.855164357277613*^9, 3.8551643695269933`*^9}, {3.855164714969814*^9, 
   3.8551647396075153`*^9}, 3.8551650214032183`*^9, {3.8551650784914217`*^9, 
   3.8551650793452015`*^9}, 3.857489955113948*^9, {3.857490099255333*^9, 
   3.8574901156880403`*^9}, {3.857833816121024*^9, 3.8578338231864743`*^9}, {
   3.8578338739398146`*^9, 3.857833880786955*^9}, {3.8578339723844585`*^9, 
   3.857833977609408*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"4d6e6574-d124-419c-b1db-b73c29cb5d6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PyrFlow1DIter", "[", 
   RowBox[{
   "10", ",", "1", ",", "0.02", ",", "p", ",", "newv0", ",", "condition", ",",
     " ", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "0.001", ",", 
    "noteBookMode"}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    RowBox[{"-", "1"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.8551652279135513`*^9, {3.8578354619988656`*^9, 3.8578354634306192`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"6afb2ab1-6406-455a-ab94-2769a5499948"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"threshold", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"updateValues", "=", 
   RowBox[{"{", 
    RowBox[{"0.", ",", "0.", ",", "\"\<ok\>\"", ",", "0."}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.844519953596135*^9, 3.8445199606029215`*^9}, {
   3.8445200284976707`*^9, 3.844520080540944*^9}, {3.8445201144548054`*^9, 
   3.84452013632008*^9}, {3.8445204044409313`*^9, 3.8445204048126707`*^9}, {
   3.844521111054682*^9, 3.844521111228567*^9}, {3.845038037655663*^9, 
   3.8450380378721824`*^9}, {3.845038171548463*^9, 3.8450381719784317`*^9}, 
   3.8450400525206423`*^9, 3.845040270633919*^9, {3.8450435281953635`*^9, 
   3.8450435292420616`*^9}, {3.8450449581286364`*^9, 
   3.8450449584168606`*^9}, {3.8460012756798897`*^9, 3.846001276159388*^9}, {
   3.846001463969864*^9, 3.8460014671759553`*^9}, 3.8551651986511493`*^9, 
   3.855165296083802*^9},
 CellLabel->
  "In[124]:=",ExpressionUUID->"e1e7e8f0-feeb-4e92-97b4-04a336e56dd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Flag", " ", "to", " ", "stop", " ", "when", " ", "e"}], 
    "\[GreaterEqual]", "2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"updateValues", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "<", "2"}], ",", 
      RowBox[{
       RowBox[{"updateValues", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", "\"\<ok\>\""}], ",", " ", 
      RowBox[{"updateValues", "=", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", 
         RowBox[{"updateValues", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "2"}], "}"}]}]}], "]"}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "This", " ", "will", " ", "only", " ", "give", " ", "values", " ", 
       "that", " ", "sum", " ", "up", " ", "to", " ", "the", " ", "magnitude",
        " ", "of", " ", "v", " ", "\[IndentingNewLine]", "Or", " ", "if", " ",
        "v0"}], " ", "=", " ", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"random", " ", "values", " ", "between", " ", "5", " ", "and"}],
       " ", "-", "5"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nV", "=", 
     RowBox[{"newValues", "[", 
      RowBox[{"10", ",", "1", ",", "0.02", ",", 
       RowBox[{"updateValues", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "newv0", ",", 
       "\"\<ConstrainedCorrelation\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tableNewValues", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "initialize", " ", "whith", " ", "values", " ", 
        "calculated", " ", "at", " ", "nV", " ", "and", " ", "last", " ", 
        "calculated", " ", 
        RowBox[{"updateValues", "[", 
         RowBox[{"[", 
          RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tValues", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"v", ",", 
            RowBox[{"updateValues", "[", 
             RowBox[{"[", 
              RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"iterTable", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tValues", "=", 
            RowBox[{"PyrUpgrade1D", "[", 
             RowBox[{"tValues", ",", "p0", ",", "  ", 
              RowBox[{"pyrf12", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"threshold", "*", 
               RowBox[{"2", "^", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "n"}], "+", "1"}], ")"}]}]}], ",", "1", ",", 
              "\"\<ConstrainedCorrelation\>\""}], "]"}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"v", ",", "nV"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"goodValIter", "=", 
    RowBox[{
     RowBox[{"pickNewValueIter", "[", 
      RowBox[{
      "tableNewValues", ",", "condition", ",", 
       "\"\<ConstrainedCorrelation\>\""}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", 
       RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Last", "[", "goodValIter", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8445199189976206`*^9, 3.8445199365460973`*^9}, {
   3.844519973444282*^9, 3.8445200208896346`*^9}, {3.8445201321606035`*^9, 
   3.8445201335175266`*^9}, 3.8445204255897226`*^9, {3.8445207635164404`*^9, 
   3.844520772183606*^9}, {3.844521615845844*^9, 3.8445216204018307`*^9}, {
   3.8449608965047283`*^9, 3.8449609389132614`*^9}, {3.845038043311702*^9, 
   3.845038045807271*^9}, {3.845043232309779*^9, 3.8450432374252357`*^9}, {
   3.845043271633041*^9, 3.845043280468442*^9}, {3.845043388631222*^9, 
   3.8450433948913903`*^9}, {3.845043436701793*^9, 3.845043458830859*^9}, {
   3.8450434913708134`*^9, 3.8450435144542074`*^9}, 3.8450435634013424`*^9, {
   3.845043652260578*^9, 3.845043652741896*^9}, 3.845044961232326*^9, 
   3.8450478485078444`*^9, {3.845918357722026*^9, 3.8459183622702703`*^9}, {
   3.8460012212613683`*^9, 3.8460012264810104`*^9}, 3.8460217144186335`*^9, {
   3.8460231595946617`*^9, 3.846023165534622*^9}, {3.846023197994383*^9, 
   3.8460231990390916`*^9}, 3.8460961034288235`*^9, {3.8551505369518566`*^9, 
   3.8551505522269382`*^9}, {3.857489962381426*^9, 3.857489972899237*^9}, {
   3.857833998197098*^9, 3.8578340013027477`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"a7b9aafc-000b-4097-b9b2-23d1538a9e04"],

Cell[BoxData["goodValIter"], "Input",
 CellChangeTimes->{3.85297061961178*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"b5aab08a-f9a0-4958-8e09-335872c0ec55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "see", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"seePlot", "[", 
   RowBox[{"p0", ",", "5", ",", 
    RowBox[{
     RowBox[{"Last", "[", "goodValIter", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.845040090183707*^9, 3.845040128420087*^9}, {
  3.8460007875636425`*^9, 3.846000801253723*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"4b0a6ba8-61f6-4078-8e53-0b4d90119711"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "to", " ", "find", " ", "solutions", " ", "for", " ", 
    "all", " ", "levels", " ", "of", " ", "pyramid", " ", 
    RowBox[{"{", 
     RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", "..."}], "}"}], " ", 
    "or", " ", 
    RowBox[{"{", "l1", "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"number", " ", "of", " ", "iterations"}], ",", " ", 
      RowBox[{"allowed", " ", "failed", " ", "levels"}], ",", " ", 
      RowBox[{
      "shift", " ", "on", " ", "v", " ", "solution", " ", "through", " ", 
       "levels"}], ",", " ", 
      RowBox[{"pixel", " ", "of", " ", "interests"}], ",", " ", 
      "pyrfunctions", ",", "threshold"}], " "}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"v1", ",", " ", "v2", ",", "status"}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PyrFlow1DIter", "[", 
     RowBox[{
     "i_", ",", "n_", ",", "u_", ",", " ", "p0_", ",", "newv0_", ",", " ", 
      "condition_", ",", "pyrfunctions_", ",", "threshold_", ",", 
      "\"\<ConstrainedCorrelation\>\""}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c", ",", "updateValues", ",", "newVals", ",", "tableNewValues", ",", 
        "tValues", ",", "iterTable", ",", "goodValIter", ",", "nV"}], "}"}], 
      ",", 
      RowBox[{
      "(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"Length", "[", "pyrfunctions", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"{", 
          RowBox[{"v1", ",", " ", "v2", ",", " ", "status", ",", " ", "e"}], 
          "}"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"updateValues", "=", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0.", ",", "\"\<ok\>\"", ",", "0."}], "}"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Flag", " ", "to", " ", "stop", " ", "when", " ", "e"}], 
           "\[GreaterEqual]", "n"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "<=", "n"}], ",", 
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", "\"\<ok\>\""}], ",", " ", 
             RowBox[{"updateValues", "=", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", 
                RowBox[{"updateValues", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"updateValues", "[", 
                 RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "This", " ", "will", " ", "only", " ", "give", " ", "values", 
               " ", "that", " ", "sum", " ", "up", " ", "to", " ", "the", " ",
                "magnitude", " ", "of", " ", "v", " ", "\[IndentingNewLine]", 
               "Or", " ", "if", " ", "v0"}], " ", "=", " ", "0"}], ",", " ", 
             RowBox[{
             "list", " ", "newv0", " ", "is", " ", "created", " ", "and", " ",
               "fed", " ", "to", " ", "the", " ", "function", " ", "to", " ", 
              "try", " ", "all", " ", 
              RowBox[{"it", "'"}], "s", " ", "contained", " ", "values"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"nV", "=", 
            RowBox[{"newValues", "[", 
             RowBox[{"10", ",", "n", ",", "u", ",", 
              RowBox[{"updateValues", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", "newv0", ",", 
              "\"\<ConstrainedCorrelation\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"tableNewValues", "=", 
            RowBox[{
            "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "We", " ", "initialize", " ", "whith", " ", "values", " ", 
               "calculated", " ", "at", " ", "nV", " ", "and", " ", "last", 
               " ", "calculated", " ", 
               RowBox[{"updateValues", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tValues", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"v", ",", 
                   RowBox[{"updateValues", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "}"}], "]"}]}], 
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"iterTable", "=", 
                RowBox[{
                "Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"tValues", "=", 
                   RowBox[{"PyrUpgrade1D", "[", 
                    RowBox[{"tValues", ",", "p0", ",", " ", 
                    RowBox[{"pyrfunctions", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "f"}], "]"}], "]"}], ",", 
                    RowBox[{"threshold", "*", 
                    RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "c"}], "+", "1"}], ")"}]}]}], ",", "n", ",", 
                    "\"\<ConstrainedCorrelation\>\""}], "]"}]}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"v", ",", "nV"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"c", "-", "1"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"goodValIter", "=", 
            RowBox[{"pickNewValueIter", "[", 
             RowBox[{
             "tableNewValues", ",", "condition", ",", 
              "\"\<ConstrainedCorrelation\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"updateValues", "=", 
            RowBox[{"Last", "[", "goodValIter", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"goodValIter", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "1", ",", 
            RowBox[{"Length", "[", "pyrfunctions", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.836395257636574*^9, 3.836395272859167*^9}, {
   3.83708196322594*^9, 3.8370820062598658`*^9}, {3.837083182655498*^9, 
   3.8370832734823055`*^9}, {3.8370843532979484`*^9, 
   3.8370843675088606`*^9}, {3.838080701244558*^9, 3.8380807259152684`*^9}, {
   3.838080793823208*^9, 3.8380808755938196`*^9}, {3.8380809401222954`*^9, 
   3.838080942274747*^9}, 3.8380810086446276`*^9, {3.8380816063631763`*^9, 
   3.8380816393331475`*^9}, {3.8380820470151634`*^9, 
   3.8380820558435106`*^9}, {3.8380823886542034`*^9, 
   3.8380824062240515`*^9}, {3.8380824773647776`*^9, 
   3.8380825736331425`*^9}, {3.8380826279050765`*^9, 3.838082713503049*^9}, {
   3.8380828471635237`*^9, 3.8380828901935434`*^9}, {3.83848262336782*^9, 
   3.8384826483396864`*^9}, {3.838483209637656*^9, 3.838483252891429*^9}, {
   3.83848337672888*^9, 3.838483389713195*^9}, 3.8384834622891912`*^9, {
   3.838483925470047*^9, 3.838483959825934*^9}, 3.8384839932092*^9, {
   3.8384840245223246`*^9, 3.83848406745443*^9}, {3.8384841090878415`*^9, 
   3.838484119135103*^9}, {3.8384842940787163`*^9, 3.8384842965189843`*^9}, {
   3.838484331536871*^9, 3.838484376855281*^9}, {3.8384844316993575`*^9, 
   3.8384844364710684`*^9}, {3.838484472533862*^9, 3.838484496768239*^9}, {
   3.838484653516262*^9, 3.8384846980991325`*^9}, 3.8384847407136316`*^9, {
   3.838484789836351*^9, 3.838484836358838*^9}, {3.838485707284088*^9, 
   3.838485708317006*^9}, {3.838745304433283*^9, 3.838745304748513*^9}, 
   3.8387454287233124`*^9, {3.838745566958905*^9, 3.838745572968202*^9}, {
   3.838832480835082*^9, 3.8388324858883576`*^9}, 3.838832662601839*^9, 
   3.8400444674100447`*^9, {3.840044657898258*^9, 3.840044675080756*^9}, {
   3.840044792234081*^9, 3.8400448028818226`*^9}, {3.840045382891678*^9, 
   3.8400454107116804`*^9}, {3.8400457742282677`*^9, 3.840045782682536*^9}, {
   3.840046004923623*^9, 3.840046009099416*^9}, 3.8400460619888587`*^9, {
   3.8400460949919004`*^9, 3.84004610011978*^9}, {3.8400461438186865`*^9, 
   3.8400461690448275`*^9}, {3.8400536215227985`*^9, 
   3.8400536593035183`*^9}, {3.840053705946847*^9, 3.840053723757249*^9}, {
   3.8400537835503826`*^9, 3.8400538050647817`*^9}, {3.8400538490526533`*^9, 
   3.840053877267029*^9}, {3.840054015361252*^9, 3.840054050881156*^9}, 
   3.8400541211876483`*^9, {3.840054841363824*^9, 3.840054842590229*^9}, {
   3.8400548774584274`*^9, 3.8400548954699373`*^9}, 3.840062489108899*^9, {
   3.8400625230755796`*^9, 3.8400625357077594`*^9}, {3.840062608567613*^9, 
   3.840062609225909*^9}, 3.840064282796586*^9, {3.840064347610565*^9, 
   3.8400643514241934`*^9}, {3.840064435863537*^9, 3.840064436038506*^9}, {
   3.840066248372734*^9, 3.8400662514900155`*^9}, {3.8400664641163483`*^9, 
   3.8400664688160753`*^9}, 3.8400666848661065`*^9, {3.8400668057053223`*^9, 
   3.8400668205868874`*^9}, {3.8400669375243015`*^9, 3.840067029056565*^9}, {
   3.8400670665699735`*^9, 3.8400670668913956`*^9}, {3.8400673521968985`*^9, 
   3.840067373037039*^9}, {3.8400674925370984`*^9, 3.840067499815276*^9}, {
   3.8400676885764246`*^9, 3.8400676914667573`*^9}, {3.840067767866358*^9, 
   3.840067799215399*^9}, {3.8400678334141483`*^9, 3.840067834605913*^9}, {
   3.8400678737948313`*^9, 3.840067881587015*^9}, {3.840067987954644*^9, 
   3.840067988566532*^9}, {3.8400687429367623`*^9, 3.8400688146563964`*^9}, 
   3.8400688885471363`*^9, {3.8400690624252715`*^9, 3.8400690763966675`*^9}, {
   3.840069180186268*^9, 3.84006918878432*^9}, {3.8400699684665527`*^9, 
   3.840070030673232*^9}, {3.840070069194943*^9, 3.840070130021838*^9}, {
   3.8400702050033846`*^9, 3.840070295059636*^9}, {3.8400703424521255`*^9, 
   3.8400703701890373`*^9}, {3.840070536126915*^9, 3.840070543162916*^9}, {
   3.8400707194066267`*^9, 3.840070723381528*^9}, {3.840071016027475*^9, 
   3.840071035148421*^9}, 3.840071082957506*^9, {3.8400711294374886`*^9, 
   3.8400712078568583`*^9}, {3.8400720622403393`*^9, 3.840072062449636*^9}, {
   3.8400725161957693`*^9, 3.8400725194734535`*^9}, {3.840190301254188*^9, 
   3.840190369112875*^9}, {3.840190421163118*^9, 3.840190483558923*^9}, {
   3.8401905169341288`*^9, 3.8401905686044073`*^9}, {3.840190665069972*^9, 
   3.840190691093354*^9}, {3.840190764716844*^9, 3.840190909552351*^9}, {
   3.840190952571726*^9, 3.840190994597392*^9}, 3.840191052489993*^9, {
   3.84019109858766*^9, 3.840191106858177*^9}, {3.840212643647187*^9, 
   3.8402126587042575`*^9}, {3.840212948316355*^9, 3.840213092874155*^9}, {
   3.8402131666079383`*^9, 3.8402131696129346`*^9}, {3.8402143027437525`*^9, 
   3.8402143267459517`*^9}, {3.8402804561573114`*^9, 3.840280523225045*^9}, {
   3.8402809376168385`*^9, 3.840280971021533*^9}, {3.8402849953143473`*^9, 
   3.840284995539066*^9}, {3.840285203246116*^9, 3.8402852211954503`*^9}, {
   3.8405484745807753`*^9, 3.840548502614027*^9}, {3.840548682116254*^9, 
   3.8405486958534555`*^9}, {3.8405779593968954`*^9, 
   3.8405779632643437`*^9}, {3.841320470752817*^9, 3.8413204988403115`*^9}, 
   3.843047234386615*^9, 3.8430472681286163`*^9, {3.84304837339767*^9, 
   3.8430484122480726`*^9}, {3.8430489408235273`*^9, 
   3.8430489753452682`*^9}, {3.8431533802072535`*^9, 3.843153400508676*^9}, {
   3.843154934308928*^9, 3.8431552055729947`*^9}, {3.843673779979858*^9, 
   3.843673789025011*^9}, 3.843673852135035*^9, {3.843674526555189*^9, 
   3.843674537257772*^9}, {3.843674794777981*^9, 3.8436747954682493`*^9}, {
   3.843675843849382*^9, 3.843675846572392*^9}, {3.843676285948403*^9, 
   3.843676311895507*^9}, {3.8437483660430927`*^9, 3.843748369909861*^9}, {
   3.843748466865801*^9, 3.843748496811301*^9}, {3.8437485324572587`*^9, 
   3.843748532728025*^9}, {3.8437524869653664`*^9, 3.8437524904354153`*^9}, {
   3.84375262295919*^9, 3.8437526282741756`*^9}, {3.8437534026858854`*^9, 
   3.8437534055344925`*^9}, {3.8437581420635324`*^9, 3.843758143053544*^9}, {
   3.843758386780986*^9, 3.8437584076658106`*^9}, {3.843758459073492*^9, 
   3.8437585931004405`*^9}, {3.84375993122773*^9, 3.843759941699638*^9}, {
   3.8437617332613707`*^9, 3.8437617485600877`*^9}, {3.8437617824128203`*^9, 
   3.843761891345723*^9}, {3.844362111190406*^9, 3.844362121675807*^9}, {
   3.844460247556864*^9, 3.8444602629714775`*^9}, 3.844465539884472*^9, {
   3.844465612855119*^9, 3.844465633559856*^9}, {3.8444656735616617`*^9, 
   3.8444657778591137`*^9}, {3.8444658333678555`*^9, 
   3.8444658639118805`*^9}, {3.8444659988895426`*^9, 3.8444660455485296`*^9}, 
   3.844466163146289*^9, {3.8444667480392838`*^9, 3.8444667624380555`*^9}, {
   3.844466856125552*^9, 3.8444668566340017`*^9}, {3.8444673031048746`*^9, 
   3.844467313894212*^9}, {3.8444673578772583`*^9, 3.844467358944499*^9}, {
   3.8444679481500235`*^9, 3.8444679562208757`*^9}, {3.8444680363683558`*^9, 
   3.844468068400166*^9}, {3.84446843803209*^9, 3.844468495636952*^9}, 
   3.844468729720846*^9, {3.8444692499050045`*^9, 3.844469250302681*^9}, {
   3.8445194746865516`*^9, 3.8445194778982077`*^9}, {3.8445196492146997`*^9, 
   3.844519681203652*^9}, {3.844519712403158*^9, 3.8445197430357046`*^9}, 
   3.844519790054809*^9, {3.844520712407405*^9, 3.84452075661621*^9}, {
   3.84452089517029*^9, 3.8445208997409673`*^9}, {3.844521591603115*^9, 
   3.8445215932704096`*^9}, 3.8445216953082337`*^9, 3.844521792030468*^9, {
   3.844523094337858*^9, 3.8445230949554443`*^9}, {3.844524092322474*^9, 
   3.844524096286628*^9}, {3.844528920321431*^9, 3.844528951245701*^9}, {
   3.8448659934702606`*^9, 3.8448659940698223`*^9}, 3.844868957719557*^9, {
   3.844869197092396*^9, 3.8448692031366224`*^9}, {3.8449553839120035`*^9, 
   3.8449553896059885`*^9}, {3.8450381992746*^9, 3.8450382174107485`*^9}, 
   3.8450438414452667`*^9, {3.8450439365198903`*^9, 3.845043941073431*^9}, {
   3.845044970362219*^9, 3.8450449749652495`*^9}, 3.84504790511629*^9, {
   3.845918420937899*^9, 3.845918426274135*^9}, {3.8460015072013903`*^9, 
   3.84600154481453*^9}, {3.8460015963097467`*^9, 3.8460015965694647`*^9}, {
   3.846023301078119*^9, 3.8460233050893593`*^9}, {3.846086750529233*^9, 
   3.846086761370406*^9}, 3.8460880921680574`*^9, 3.8460883495558047`*^9, 
   3.84609607933205*^9, {3.8551469962763605`*^9, 3.855147055060351*^9}, {
   3.855147178347909*^9, 3.8551471825240517`*^9}, {3.855164575841445*^9, 
   3.8551645787363553`*^9}, {3.8551653492241726`*^9, 3.855165368583276*^9}, 
   3.855165933372058*^9, {3.8551664788846865`*^9, 3.855166509561144*^9}, {
   3.8574899786699405`*^9, 3.8574899886363344`*^9}, {3.8578338027750006`*^9, 
   3.8578338105057807`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"8385c2d2-a002-4ef8-98d2-e49b64703626"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.8529680163947754`*^9},
 CellLabel->
  "In[102]:=",ExpressionUUID->"5fe77e72-3787-42b0-922b-c84a01b1a3a6"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"6b4bc2b5-e68e-44bb-810a-\
481b488627c2"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PyrFlow1D", "[", 
    RowBox[{
    "10", ",", "0", ",", "0", ",", "p", ",", "newv0", ",", "condition", ",", 
     " ", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "0.001", ",", 
     "noteBookMode"}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "1", ",", "30"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8427011171311693`*^9, {3.8427011579256897`*^9, 3.8427011722779355`*^9}, {
   3.842701297457902*^9, 3.8427012976177683`*^9}, 3.842702107395807*^9, {
   3.842702956024593*^9, 3.8427029573174276`*^9}, {3.843674018607419*^9, 
   3.843674022402357*^9}, {3.843678971174404*^9, 3.8436790129068117`*^9}, 
   3.8437586436966314`*^9, {3.8437586845840893`*^9, 3.8437586855190554`*^9}, 
   3.8437618402596893`*^9, 3.8437618985421076`*^9, 3.8444602703342605`*^9, 
   3.8444657790598745`*^9, 3.8444658517453156`*^9, 3.844467337496135*^9, {
   3.84446810899422*^9, 3.8444681207636952`*^9}, {3.8444690196543484`*^9, 
   3.8444690537755437`*^9}, {3.8444692346263294`*^9, 
   3.8444692429257164`*^9}, {3.8444693087297163`*^9, 
   3.8444693418978047`*^9}, {3.844521729294717*^9, 3.8445217319462013`*^9}, {
   3.8445219790342903`*^9, 3.8445219906796007`*^9}, {3.844869018428*^9, 
   3.844869027052926*^9}, {3.844869216681383*^9, 3.8448692177693863`*^9}, {
   3.8450380595407257`*^9, 3.845038066363885*^9}, 3.8450449792125807`*^9, {
   3.845045066071169*^9, 3.845045066668535*^9}, {3.8450470968326883`*^9, 
   3.8450470996875415`*^9}, {3.845047134527914*^9, 3.8450471376710906`*^9}, {
   3.84504718148096*^9, 3.845047182877651*^9}, {3.845657156700632*^9, 
   3.845657158718465*^9}, {3.846001168170922*^9, 3.8460011691828656`*^9}, 
   3.8460233467870703`*^9, 3.84608841182693*^9, {3.855147076691366*^9, 
   3.855147115404775*^9}, {3.8551657085131006`*^9, 3.855165724973741*^9}, {
   3.857492665400389*^9, 3.857492666812664*^9}, {3.8578335904180336`*^9, 
   3.857833593601804*^9}, 3.8578342167715898`*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"8f29aaff-4057-427e-b12a-e251f29196c1"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PyrFlow1DIter", "[", 
     RowBox[{
     "10", ",", "0", ",", "0", ",", "p", ",", "newv0", ",", "condition", ",", 
      " ", 
      RowBox[{"pyrf12", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "0.001", ",", 
      "noteBookMode"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "1", ",", "30"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8445219867175174`*^9, 3.8445219991011286`*^9}, {
   3.8448692242987785`*^9, 3.844869225296276*^9}, {3.845038072374775*^9, 
   3.845038075093134*^9}, 3.845044985460975*^9, 3.8450471983336673`*^9, 
   3.8456571610417123`*^9, 3.845657206167536*^9, {3.8460007155152283`*^9, 
   3.8460007186018267`*^9}, 3.846001175303458*^9, {3.8460016281623354`*^9, 
   3.846001630633064*^9}, {3.846001678204561*^9, 3.8460017159634113`*^9}, 
   3.8460233480474925`*^9, 3.846088415138697*^9, {3.8551471267241583`*^9, 
   3.8551471294209414`*^9}, 3.85516573919258*^9, {3.857492674932601*^9, 
   3.8574926931395173`*^9}, {3.8578336035242186`*^9, 3.857833605843754*^9}, {
   3.857834021592144*^9, 3.857834023071378*^9}, 3.8578342199419565`*^9},
 CellLabel->
  "In[137]:=",ExpressionUUID->"9ad54e40-504a-4c1a-b978-a6521a5b7d82"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PyrFlow1D", "[", 
     RowBox[{
     "10", ",", "0", ",", "0", ",", " ", "p", ",", "newv0", ",", "condition", 
      ",", " ", 
      RowBox[{"pyrf12", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "0.001", ",", 
      "noteBookMode"}], "]"}], "==", 
    RowBox[{
     RowBox[{"PyrFlow1DIter", "[", 
      RowBox[{
      "10", ",", "0", ",", "0", ",", "p", ",", "newv0", ",", "condition", ",",
        " ", 
       RowBox[{"pyrf12", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "0.001", ",", 
       "noteBookMode"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"p", ",", "1", ",", "30"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8445221438362274`*^9, 3.844522149421374*^9}, {
  3.844869258717738*^9, 3.8448692675606394`*^9}, {3.845038079850918*^9, 
  3.8450380918328047`*^9}, {3.845044990996796*^9, 3.845044992268646*^9}, {
  3.845657164114723*^9, 3.845657166006479*^9}, {3.8551506255590167`*^9, 
  3.8551506328501463`*^9}, {3.8578336421412563`*^9, 3.8578336600924172`*^9}, {
  3.8578337381383767`*^9, 3.85783375578266*^9}, {3.8578342555439825`*^9, 
  3.85783426185963*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"2b2e38a0-bfe5-4cd3-9e4c-8a2caf5aacc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"27418d46-f597-4820-9d54-\
72d01137cc93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"removeClosest", "[", "s_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "c"}], "}"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Nearest", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"n", "[", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ")"}], "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Delete", "[", 
        RowBox[{"s", ",", "c"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeClosest", "[", "s_", "]"}], ":=", 
   RowBox[{"s", "/;", 
    RowBox[{
     RowBox[{"Length", "[", "s", "]"}], "<", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.846331098507648*^9, 3.8463311412069798`*^9}, {
   3.8463313097288356`*^9, 3.8463313440080214`*^9}, 3.846336737969517*^9, {
   3.855166708079237*^9, 3.8551667090315046`*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"c46061d6-ee4a-4f4e-8075-48ee98de68fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Creating", " ", "list", " ", "of", " ", "initial", " ", "Values"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"range", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listv0", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"range", ",", 
         RowBox[{"{", 
          RowBox[{"1000", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
           "0"}], " ", "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[LessEqual]", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"Abs", "[", "range", "]"}], "]"}]}]}], ")"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listv0", "=", 
     RowBox[{"Nest", "[", 
      RowBox[{"removeClosest", ",", "listv0", ",", 
       RowBox[{
        RowBox[{"Length", "[", "listv0", "]"}], "-", "80"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", "listv0", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.856025555353176*^9, 3.856025581242181*^9}, {
   3.856026254947156*^9, 3.8560262676953154`*^9}, {3.8560269000214405`*^9, 
   3.8560269057433596`*^9}, {3.856028287134*^9, 3.8560282875081854`*^9}, {
   3.8560291133650265`*^9, 3.856029113895653*^9}, {3.856264813907603*^9, 
   3.8562648415890727`*^9}, {3.856264872266114*^9, 3.856264899310997*^9}, {
   3.856266050181141*^9, 3.8562660689465632`*^9}, {3.856267126278367*^9, 
   3.856267126709761*^9}, 3.8562678696086025`*^9, 3.8562681090174656`*^9, {
   3.85763918164597*^9, 3.8576391817878866`*^9}, {3.857834361655814*^9, 
   3.8578343780284786`*^9}, {3.8578346169640903`*^9, 3.8578346183075852`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"cb3f79c5-7ee0-4720-8277-77f813979ac1"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "listv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "30"}], "]"}], ",", 
   RowBox[{"pyrf12", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "0.001", ",", 
   "noteBookMode"}], "]"}]], "Input",
 CellChangeTimes->{{3.844460992649581*^9, 3.84446100281861*^9}, {
   3.8444650287524195`*^9, 3.8444650299651155`*^9}, {3.844465076147544*^9, 
   3.84446508980591*^9}, {3.8444651218401146`*^9, 3.844465122987401*^9}, 
   3.8445228563042336`*^9, 3.8448659693383055`*^9, {3.8448692845010266`*^9, 
   3.844869286212863*^9}, 3.8450380999025164`*^9, 3.8450450085264883`*^9, {
   3.8450450881570735`*^9, 3.845045099085638*^9}, 3.8460880491262136`*^9, 
   3.846088254265647*^9, 3.846092237210523*^9, {3.8551660290499353`*^9, 
   3.855166031756174*^9}, {3.8578342780387897`*^9, 3.857834290103602*^9}, 
   3.8578344331703444`*^9, {3.857834494743637*^9, 3.8578344975530634`*^9}, {
   3.8578345483509254`*^9, 3.857834570956936*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"e367219d-7852-4603-8fb6-fba98b6361fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lvlmin", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lvlmax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dis", "=", "1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mode", "=", "\"\<ConstrainedCorrelation\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"pixelInitialValueGraphics", "[", 
  RowBox[{
  "10", ",", "0", ",", "0", ",", "p", ",", "listv0", ",", "condition", ",", 
   "dis", ",", " ", 
   RowBox[{"pyrf12", "[", 
    RowBox[{"[", 
     RowBox[{"lvlmin", ";;", "lvlmax"}], "]"}], "]"}], ",", 
   RowBox[{"0.001", "*", 
    RowBox[{"2", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "lvlmin"}], "+", "1"}], ")"}]}]}], ",", "mode"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8444609276853704`*^9, 3.8444609607139034`*^9}, {
   3.8444610149123635`*^9, 3.8444610720575733`*^9}, 3.844465103128627*^9, {
   3.844468954478764*^9, 3.844468955836996*^9}, {3.8445223288621674`*^9, 
   3.844522331588422*^9}, {3.8445224254548025`*^9, 3.844522442397056*^9}, {
   3.844523120633779*^9, 3.8445231264669933`*^9}, {3.844865883020569*^9, 
   3.8448658976377945`*^9}, 3.844865928166531*^9, 3.8448688843438253`*^9, {
   3.845045172614132*^9, 3.8450451828856764`*^9}, 3.8450452794504633`*^9, 
   3.8450455327267056`*^9, {3.845047989488798*^9, 3.8450480081172156`*^9}, 
   3.8460874847973375`*^9, {3.846088028094764*^9, 3.8460880409247837`*^9}, {
   3.8460881130570087`*^9, 3.846088139269883*^9}, 3.8460882479390144`*^9, {
   3.846092261895195*^9, 3.846092278344483*^9}, 3.8460961301642113`*^9, {
   3.8551661464711957`*^9, 3.8551661508206663`*^9}, {3.8551662323122654`*^9, 
   3.85516623279241*^9}, 3.855166423799381*^9, 3.855166459895472*^9, {
   3.8578345898288975`*^9, 3.857834606482896*^9}, {3.857834672095656*^9, 
   3.857834673640044*^9}, {3.8578355223980856`*^9, 3.8578355240133567`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"23e13519-5896-4236-b559-8301feacc5ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lvlmin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lvlmax", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "14"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mode", "=", "\"\<ConstrainedNewMethod\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"pixelInitialValueGraphics", "[", 
    RowBox[{"10", ",", "1000", ",", "p", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", "dis", ",", " ", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", 
       RowBox[{"lvlmin", ";;", "lvlmax"}], "]"}], "]"}], ",", 
     RowBox[{"0.001", "*", 
      RowBox[{"2", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "lvlmin"}], "+", "1"}], ")"}]}]}], ",", "mode"}], "]"}],
    "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8444609276853704`*^9, 3.8444609607139034`*^9}, {
   3.8444610149123635`*^9, 3.84446109126562*^9}, 3.844465109413933*^9, 
   3.844522645686282*^9, {3.844523132263279*^9, 3.8445231640872555`*^9}, {
   3.8450306042313957`*^9, 3.8450306073687077`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"4f59b7b5-9a67-4041-af81-7f5ca165cbaf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1141.2, 610.1999999999999},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CellContext->Notebook,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5cf98d41-5d10-4eb5-92f0-45d3400e49e5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 512, 8, 97, "Title",ExpressionUUID->"c74c55b5-a7cc-4ad8-a86e-04efcb90444f"],
Cell[CellGroupData[{
Cell[1117, 34, 359, 6, 67, "Section",ExpressionUUID->"564bd16b-5ad2-477e-879c-a49b47193581"],
Cell[1479, 42, 426, 8, 28, "Input",ExpressionUUID->"9b185096-2906-4a57-92e9-557dda4598fe"],
Cell[1908, 52, 590, 16, 49, "Input",ExpressionUUID->"65983b17-d6fd-4754-a477-b5ff2b124938"],
Cell[2501, 70, 362, 6, 49, "Input",ExpressionUUID->"0a0eddb1-b848-4d3c-b05d-36e4f83d5329"],
Cell[2866, 78, 360, 7, 28, "Input",ExpressionUUID->"e7aa4d9a-36e9-46be-b5c2-ffe503fe6e21"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3263, 90, 337, 5, 67, "Section",ExpressionUUID->"1cd288a4-fb0b-4c1d-b6e6-e28adb0822c9"],
Cell[3603, 97, 267, 5, 28, "Input",ExpressionUUID->"bcce114e-be95-4be9-af3b-e98691bcc37f"],
Cell[3873, 104, 2541, 59, 88, "Input",ExpressionUUID->"056c4721-21ce-4de5-84cd-f8c73485e8a4"],
Cell[6417, 165, 2260, 64, 166, "Input",ExpressionUUID->"2f2f9eee-c8fe-403e-8715-13978274b59c"],
Cell[8680, 231, 450, 11, 49, "Input",ExpressionUUID->"b73f0fa0-cf65-4cac-ad5b-471a5bb72b3a"],
Cell[9133, 244, 786, 21, 28, "Input",ExpressionUUID->"6f030a6b-aac9-4974-9d6c-6abf205c4b09"]
}, Closed]],
Cell[CellGroupData[{
Cell[9956, 270, 277, 4, 53, "Section",ExpressionUUID->"eef04f0f-ca13-46b7-9ae5-301a424457b1"],
Cell[CellGroupData[{
Cell[10258, 278, 162, 3, 54, "Subsection",ExpressionUUID->"86d2106e-d02d-4249-a85a-97f3df8af812"],
Cell[10423, 283, 25004, 501, 1313, "Input",ExpressionUUID->"5e20ee3c-ab1e-4b5f-88fe-05549f24bf19",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[35464, 789, 191, 3, 53, "Subsection",ExpressionUUID->"09c54b45-a793-4cfd-ad20-2e7a5f10a972"],
Cell[35658, 794, 1509, 30, 88, "Input",ExpressionUUID->"0d67409b-4d6a-48b8-b944-4bb568d4db3e"],
Cell[37170, 826, 496, 9, 49, "Input",ExpressionUUID->"0a9858d9-ce69-4f7c-8261-cdfdd07ddfde"],
Cell[37669, 837, 2407, 43, 88, "Input",ExpressionUUID->"138e0c10-83f8-4277-9a6d-83aa60ccbc11"],
Cell[40079, 882, 967, 17, 49, "Input",ExpressionUUID->"a4eb40f2-6bad-494d-9176-eee04ab055d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41083, 904, 182, 3, 54, "Subsection",ExpressionUUID->"a4c25ec2-f772-4494-87f0-6c86ae6eb27a"],
Cell[41268, 909, 5629, 112, 474, "Input",ExpressionUUID->"d2398203-6386-43c0-9979-4c3a161cff6f",
 InitializationCell->True],
Cell[46900, 1023, 1738, 51, 127, "Input",ExpressionUUID->"2bd77349-c9bc-44ac-a63c-3ac4e9680b0d"],
Cell[48641, 1076, 1703, 28, 68, "Input",ExpressionUUID->"a2d66308-b602-429c-a4cb-375b3cdee7c5"],
Cell[50347, 1106, 12837, 258, 1079, "Input",ExpressionUUID->"3b77723e-5b7c-4b87-a566-76e628ef95bf",
 InitializationCell->True],
Cell[63187, 1366, 939, 26, 88, "Input",ExpressionUUID->"08e05903-787d-43a8-99d8-db087c7053c6"],
Cell[64129, 1394, 5005, 106, 575, "Input",ExpressionUUID->"210d9792-72c0-46f2-9ed0-2441a1782fd9"],
Cell[69137, 1502, 558, 13, 49, "Input",ExpressionUUID->"cc9b0cb0-f357-44ab-8811-9a55a4754405"],
Cell[69698, 1517, 20197, 343, 1157, "Input",ExpressionUUID->"d9b9e833-8770-43d6-9196-3f072660ee39",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[89920, 1864, 182, 3, 45, "Subsubsection",ExpressionUUID->"1677df7d-d338-4ae0-86ef-227ba8502fad"],
Cell[90105, 1869, 875, 24, 88, "Input",ExpressionUUID->"b3e9302c-f436-4a5a-8d84-0d7bab68e55c"],
Cell[90983, 1895, 215, 4, 28, "Input",ExpressionUUID->"b14c0653-3e9f-41bc-ad3b-fb428643f9e5"],
Cell[91201, 1901, 4583, 98, 263, "Input",ExpressionUUID->"a2f96ad6-157a-40a4-b5dc-b0107b8c5ea4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95821, 2004, 182, 3, 45, "Subsubsection",ExpressionUUID->"4d225df1-a7b8-4e3e-b420-6ff5f34abf9d"],
Cell[96006, 2009, 4181, 95, 263, "Input",ExpressionUUID->"9fd57488-dee4-4f36-8bcc-ab84a909ef9e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100224, 2109, 182, 3, 45, "Subsubsection",ExpressionUUID->"1addfeb2-5c39-4529-bb6d-d0c229ca6ab7"],
Cell[100409, 2114, 240, 6, 58, "Text",ExpressionUUID->"880a687b-6dd2-4828-9358-0c01b407a3f7"],
Cell[100652, 2122, 5563, 104, 283, "Input",ExpressionUUID->"afc14aa7-2bb9-4d9b-b7f5-afd1fea2872d"],
Cell[106218, 2228, 1598, 26, 49, "Input",ExpressionUUID->"53f7faf6-a305-4fa8-ae79-0e1ed081f6fc"],
Cell[107819, 2256, 168, 2, 49, "Input",ExpressionUUID->"15f26ce9-df36-4e91-aa9d-b1be1886509a"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108048, 2265, 275, 4, 67, "Section",ExpressionUUID->"d69ea01b-c1ef-4113-8cab-b11ccf013757"],
Cell[CellGroupData[{
Cell[108348, 2273, 292, 5, 54, "Subsection",ExpressionUUID->"c8124fb5-6975-4957-950c-1a0ca8f99e5a"],
Cell[CellGroupData[{
Cell[108665, 2282, 182, 3, 45, "Subsubsection",ExpressionUUID->"8aa49981-e1b7-40e4-b201-cbbe28e3204e"],
Cell[108850, 2287, 4066, 91, 283, "Input",ExpressionUUID->"a088f1dc-28e3-40d6-a93b-5301bc0a6bd5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112977, 2385, 325, 5, 67, "Section",ExpressionUUID->"b94d5e78-6273-405e-baaa-6e385d5d2376"],
Cell[113305, 2392, 12489, 272, 1137, "Input",ExpressionUUID->"4d6e6574-d124-419c-b1db-b73c29cb5d6d",
 InitializationCell->True],
Cell[125797, 2666, 594, 17, 49, "Input",ExpressionUUID->"6afb2ab1-6406-455a-ab94-2769a5499948"],
Cell[126394, 2685, 1212, 25, 107, "Input",ExpressionUUID->"e1e7e8f0-feeb-4e92-97b4-04a336e56dd8"],
Cell[127609, 2712, 5099, 113, 595, "Input",ExpressionUUID->"a7b9aafc-000b-4097-b9b2-23d1538a9e04"],
Cell[132711, 2827, 161, 3, 28, "Input",ExpressionUUID->"b5aab08a-f9a0-4958-8e09-335872c0ec55"],
Cell[132875, 2832, 572, 14, 49, "Input",ExpressionUUID->"4b0a6ba8-61f6-4078-8e53-0b4d90119711"],
Cell[133450, 2848, 16292, 290, 1157, "Input",ExpressionUUID->"8385c2d2-a002-4ef8-98d2-e49b64703626",
 InitializationCell->True],
Cell[149745, 3140, 153, 3, 28, "Input",ExpressionUUID->"5fe77e72-3787-42b0-922b-c84a01b1a3a6"],
Cell[CellGroupData[{
Cell[149923, 3147, 182, 3, 45, "Subsubsection",ExpressionUUID->"6b4bc2b5-e68e-44bb-810a-481b488627c2"],
Cell[150108, 3152, 2151, 37, 88, "Input",ExpressionUUID->"8f29aaff-4057-427e-b12a-e251f29196c1"],
Cell[152262, 3191, 1423, 29, 88, "Input",ExpressionUUID->"9ad54e40-504a-4c1a-b978-a6521a5b7d82"],
Cell[153688, 3222, 1473, 35, 127, "Input",ExpressionUUID->"2b2e38a0-bfe5-4cd3-9e4c-8a2caf5aacc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155198, 3262, 182, 3, 45, "Subsubsection",ExpressionUUID->"27418d46-f597-4820-9d54-72d01137cc93"],
Cell[155383, 3267, 1958, 52, 127, "Input",ExpressionUUID->"c46061d6-ee4a-4f4e-8075-48ee98de68fc"],
Cell[157344, 3321, 2389, 59, 146, "Input",ExpressionUUID->"cb3f79c5-7ee0-4720-8277-77f813979ac1"],
Cell[159736, 3382, 1126, 20, 49, "Input",ExpressionUUID->"e367219d-7852-4603-8fb6-fba98b6361fb"],
Cell[160865, 3404, 2083, 43, 185, "Input",ExpressionUUID->"23e13519-5896-4236-b559-8301feacc5ad"],
Cell[162951, 3449, 1253, 32, 146, "Input",ExpressionUUID->"4f59b7b5-9a67-4041-af81-7f5ca165cbaf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

