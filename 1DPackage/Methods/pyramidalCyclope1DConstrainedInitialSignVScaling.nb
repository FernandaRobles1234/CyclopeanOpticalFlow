(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     88647,       1874]
NotebookOptionsPosition[     84723,       1798]
NotebookOutlinePosition[     85311,       1819]
CellTagsIndexPosition[     85268,       1816]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Sign method", "Title",
 CellChangeTimes->{{3.836408933336395*^9, 3.836408939343516*^9}, 
   3.8364092608930736`*^9, {3.839597016893468*^9, 3.839597019185139*^9}, 
   3.8396001415844855`*^9, {3.840547036727909*^9, 3.8405470374003563`*^9}, {
   3.843157046858073*^9, 3.8431570473239956`*^9}, 3.843746389245494*^9, {
   3.843747216246171*^9, 3.8437472272964706`*^9}, {3.8437522034332137`*^9, 
   3.843752204235346*^9}, {3.8438311022867823`*^9, 
   3.8438311031615887`*^9}},ExpressionUUID->"7afc5b65-0b5e-4320-8af8-\
efa1ad27aa25"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.832189670547576*^9, {3.8372610411417527`*^9, 3.837261053402938*^9}, 
   3.8372611225950527`*^9, {3.8431434791889243`*^9, 3.843143480644304*^9}, {
   3.843151614814394*^9, 3.8431516186171865`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"d6613b5f-169d-4924-a7bf-e1328c874886"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<*\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"$Path", ",", 
     RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{3.843747298847076*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"41e1c256-78cb-4820-90cf-01209722e819"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramidalCyclope1D`\>\""}]}], "Input",
 CellChangeTimes->{{3.836396430700433*^9, 3.836396440553816*^9}, {
   3.836396483243249*^9, 3.836396483782277*^9}, {3.8363965197501154`*^9, 
   3.8363965208316736`*^9}, 3.8363965992226734`*^9, {3.843049966234662*^9, 
   3.8430499668751907`*^9}, {3.8431516435129576`*^9, 3.843151644468534*^9}, 
   3.843831128636213*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"8671407a-4f01-418c-b8d5-eb14191aec4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noteBookMode", "=", "\"\<ConstrainedInitialSign\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.8437533462956824`*^9, 3.8437535060531635`*^9, {3.8438311391343627`*^9, 
   3.8438311426299357`*^9}, {3.8438492182877655`*^9, 
   3.8438492191012626`*^9}, {3.84385067814329*^9, 3.843850678687092*^9}, {
   3.8438529548083315`*^9, 3.8438529553772707`*^9}, 3.8442599122624464`*^9, 
   3.8442599523722973`*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"d1bc8fcf-74b6-4b1d-a5a8-1732c355759d"],

Cell[CellGroupData[{

Cell["Test Points {line1, line2, pyrf12}", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431530928617816`*^9, 
  3.8431531095074196`*^9}, {3.8431536160653305`*^9, 
  3.843153621995445*^9}},ExpressionUUID->"49cdbca1-85b1-42e3-a9fb-\
95cdbab14151"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "We", " ", "create", " ", "test", " ", "points", " ", "for", " ", 
    "compilation", " ", "test"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"line1", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"11", "<=", " ", "p", "<=", "18"}], ",", "1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", "30"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line2", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"11", "<=", " ", "p", "<=", "18"}], ",", "1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"1", "-", "4"}], ",", 
           RowBox[{"30", "-", "4"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"line1", ",", " ", "line2"}], "}"}], ",", 
      RowBox[{"Joined", "->", "True"}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotRange", "->", "All"}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", "\"\<Test Points\>\""}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<ia\>\"", ",", "\"\<ib\>\""}], "}"}]}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.832269136912603*^9, 3.8322691462380075`*^9}, {
   3.8324089382989807`*^9, 3.832408951506154*^9}, {3.8324104077397842`*^9, 
   3.832410511519393*^9}, 3.832410602016293*^9, {3.832410661166127*^9, 
   3.832410748366403*^9}, {3.832411297859131*^9, 3.832411301951344*^9}, {
   3.836395098441699*^9, 3.836395118010255*^9}, {3.836396148580798*^9, 
   3.836396159588914*^9}, {3.836396194334372*^9, 3.8363962079578047`*^9}, {
   3.836398891705703*^9, 3.836398893325742*^9}, {3.8365003825221486`*^9, 
   3.83650041642003*^9}, {3.8402800509000998`*^9, 3.840280051642571*^9}, {
   3.8430474630811205`*^9, 3.843047543816728*^9}, 3.843747388415428*^9, {
   3.8438334199494677`*^9, 3.843833421550555*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"63e606eb-af9d-4b38-8042-9c69524c2133"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "functions", " ", "of", " ", "pyramid", " ", "with", " ", 
    "pyrFuncGen"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"original", " ", "points"}], ",", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "functions", " ", "f", " ", "and", " ", "df", " ", "for", " ", "n"}], 
      "+", 
      RowBox[{"1", " ", "levels"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pyrf1", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line1", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf2", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line2", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf12", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pyrf1", ",", " ", "pyrf2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], 
        ",", 
        RowBox[{
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "2", ",", "1"}], "]"}], "]"}], "[", "x", "]"}]}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", "30"}], "}"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8431536109231205`*^9, 3.84367550184682*^9, {3.8437473622190533`*^9, 
   3.8437473924405236`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"26805c80-4731-40a2-851e-420a0b82d2d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pyramidal Flow 1D", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 
  3.8363952460112877`*^9}},ExpressionUUID->"18e1ac0b-2e67-4ae4-85a8-\
851f071e6799"],

Cell[CellGroupData[{

Cell["PyrUpgrade1D", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 
  3.8363959796401834`*^9}},ExpressionUUID->"4d85132e-f9aa-4886-993d-\
13ba7706c410"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"initial", " ", "values", " ", "for", " ", "v1"}], ",", " ", 
        RowBox[{"v2", " ", "and", " ", "status"}]}], "}"}], ",", " ", 
      RowBox[{"pixel", " ", "of", " ", "interest"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"functions", " ", "f1"}], ",", " ", "df1", ",", " ", "f2", 
        ",", " ", "df2"}], "}"}], ",", " ", 
      RowBox[{"threshold", " ", "for", " ", "magnitude", " ", "error"}]}], 
     "}"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"new", " ", "values", " ", "for", " ", "v1"}], ",", " ", 
      RowBox[{"v2", " ", "and", " ", "status"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1_", ",", "v2_", ",", "status_", ",", "e_", ",", "dv1sign_", ",", 
         "dv2sign_"}], "}"}], ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fric1", ",", "fric2", ",", "p1", ",", " ", "p2", ",", " ", "c", ",", 
         "d1", ",", "d2", ",", "dv1", ",", "dv2", ",", "newdv1sign", ",", " ",
          "newdv2sign"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p0", "-", "dv1sign"}], ")"}], "-", "v1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p0", "+", "dv2sign"}], ")"}], "+", "v2"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fline1", "[", "p0", "]"}], "+", 
             RowBox[{"fline2", "[", "p0", "]"}]}], ")"}], "/", "2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d1", "=", 
          RowBox[{"dfline1", "[", "p1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d2", "=", 
          RowBox[{"dfline2", "[", "p2", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"fric1", "=", 
          RowBox[{"0.5", "*", 
           RowBox[{
            RowBox[{"dfline1", "'"}], "[", "p1", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fric2", "=", 
          RowBox[{"0.5", "*", 
           RowBox[{
            RowBox[{"dfline2", "'"}], "[", "p2", "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Change", " ", "of", " ", "sign", " ", "during", " ", "iteration"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "d1", "]"}], "<", "threshold"}], "||", 
             RowBox[{
              RowBox[{"Abs", "[", "d2", "]"}], "<", "threshold"}]}], " ", 
            ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "2"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<mag\>\"", ",", 
                RowBox[{"e", "+", "1"}], ",", "dv1sign", ",", "dv2sign"}], 
               "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
               "0.", ",", "0.", ",", "\"\<mag\>\"", ",", "e", ",", "0.", ",", 
                "0."}], "}"}], "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Change", " ", "of", " ", "sign", " ", "during", " ", "iteration"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"dfline1", "[", 
                RowBox[{"p0", "-", "dv1sign"}], "]"}], "*", "d1"}], "<", 
              "0"}], "||", 
             RowBox[{
              RowBox[{
               RowBox[{"dfline2", "[", 
                RowBox[{"p0", "+", "dv2sign"}], "]"}], "*", "d2"}], "<", 
              "0"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "2"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<flip\>\"", ",", 
                RowBox[{"e", "+", "1"}], ",", "dv1sign", ",", "dv2sign"}], 
               "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
               "0.", ",", "0.", ",", "\"\<flip\>\"", ",", "e", ",", "0.", ",",
                 "0."}], "}"}], "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "d1", " ", "and", " ", "d2", " ", "have", " ", "to", " ", "be", " ",
            "the", " ", "same", " ", "sign", " ", "in", " ", "every", " ", 
           "iteration"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"d1", "*", "d2"}], " ", "<", "0"}], ",", " ", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "2"}], ",", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "if", " ", "p", " ", "at", " ", "initial", " ", "position", 
                " ", "and", " ", "failed"}], "..."}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"p0", "\[Equal]", "p1"}], " ", "&&", " ", 
                 RowBox[{"p0", "\[Equal]", "p2"}]}], ")"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "we", " ", "could", " ", "use", " ", "the", " ", "root", " ", 
                 "to", " ", "find", " ", "the", " ", "new", " ", "dv1", " ", 
                 "too"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"we", " ", "feed", " ", "new", " ", "dv1sign"}], 
                 "..."}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", "d1", "]"}], ">", 
                   RowBox[{"Abs", "[", "d2", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"newdv1sign", ",", "newdv2sign"}], "}"}], "=", 
                   RowBox[{"{", 
                    RowBox[{"0.", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"c", "-", 
                    RowBox[{"fline2", "[", "p2", "]"}]}], ")"}], "/", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"d2", "+", 
                    RowBox[{
                    RowBox[{"Sign", "[", "d2", "]"}], "*", "0.01"}]}], 
                    ")"}]}]}]}], "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"newdv1sign", ",", "newdv2sign"}], "}"}], "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"fline1", "[", "p1", "]"}], "-", "c"}], ")"}], 
                    "/", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"d1", "+", 
                    RowBox[{
                    RowBox[{"Sign", "[", "d1", "]"}], "*", "0.01"}]}], 
                    ")"}]}]}], ",", "0."}], "}"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"Return", "[", 
                 RowBox[{"PyrUpgrade1D", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "v1", ",", "v2", ",", "\"\<oksign\>\"", ",", "e", ",", 
                    "newdv1sign", ",", " ", "newdv2sign"}], "}"}], ",", "p0", 
                   ",", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"fline1", ",", "dfline1"}], "}"}], " ", ",", 
                    RowBox[{"{", 
                    RowBox[{"fline2", ",", "dfline2"}], "}"}]}], "}"}], ",", 
                   " ", "threshold", ",", "\"\<ConstrainedInitialSign\>\""}], 
                  "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"Return", "[", 
                RowBox[{"PyrUpgrade1D", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "v1", ",", "v2", ",", "\"\<oksign\>\"", ",", "e", ",", 
                    "dv1sign", ",", "dv2sign"}], "}"}], ",", "p0", ",", " ", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"fline1", ",", "dfline1"}], "}"}], " ", ",", 
                    RowBox[{"{", 
                    RowBox[{"fline2", ",", "dfline2"}], "}"}]}], "}"}], ",", 
                  " ", "threshold", ",", "\"\<ConstrainedInitialSign\>\""}], 
                 "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
               "0.", ",", "0.", ",", "\"\<sign\>\"", ",", "e", ",", "0.", ",",
                 "0."}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"dv1", ",", 
           RowBox[{"dv2", " ", ":", " ", 
            RowBox[{"step", " ", "from", " ", "last", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}], " ", "to", " ", "new", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dv1", ",", "dv2"}], "}"}], "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fline1", "[", "p1", "]"}], "-", "c"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"d1", "+", 
               RowBox[{
                RowBox[{"Sign", "[", "d1", "]"}], "*", 
                RowBox[{"Abs", "[", "fric1", "]"}]}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "-", 
               RowBox[{"fline2", "[", "p2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"d2", "+", 
               RowBox[{
                RowBox[{"Sign", "[", "d2", "]"}], "*", 
                RowBox[{"Abs", "[", "fric2", "]"}]}]}], ")"}]}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v1", "+", "dv1"}], ",", 
           RowBox[{"v2", "+", "dv2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"{", 
                RowBox[{"dv1", ",", "dv2"}], "}"}], "]"}], "<", "0.001"}], 
             ",", "\"\<converged\>\"", ",", "\"\<ok\>\""}], "]"}], ",", "e", 
           ",", "dv1sign", ",", "dv2sign"}], "}"}]}], "\[IndentingNewLine]", 
        ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"status", ":", " ", "\"\<OK\>\""}], " ", "->", " ", 
      RowBox[{"solution", " ", "respects", " ", "constraints"}]}], ",", "  ", 
     RowBox[{"errors", ":", " ", "\"\<sign\>\""}], ",", " ", "\"\<mag\>\"", 
     ",", " ", "\"\<flip\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"status", ":", " ", "\"\<converged\>\""}], " ", "->", " ", 
     RowBox[{"we", " ", 
      RowBox[{"converged", "!!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1_", ",", "v2_", ",", "\"\<oksign\>\"", ",", "e_", ",", "dv1sign_", 
         ",", "dv2sign_"}], "}"}], ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "fric1", ",", "fric2", ",", "p1", ",", "p2", ",", "c", ",", "d1", ",",
          "d2", ",", "dv1", ",", "dv2", ",", "r0"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p0", "-", "dv1sign"}], ")"}], "-", "v1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p0", "+", "dv2sign"}], ")"}], "+", "v2"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fline1", "[", "p0", "]"}], "+", 
             RowBox[{"fline2", "[", "p0", "]"}]}], ")"}], "/", "2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d1", "=", 
          RowBox[{"dfline1", "[", "p1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d2", "=", 
          RowBox[{"dfline2", "[", "p2", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"fric1", "=", 
          RowBox[{"1", "*", 
           RowBox[{
            RowBox[{"dfline1", "'"}], "[", "p1", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fric2", "=", 
          RowBox[{"1", "*", 
           RowBox[{
            RowBox[{"dfline2", "'"}], "[", "p2", "]"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"{", 
           RowBox[{"Null", ",", "Null"}], "}"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "magnitude", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "d1", "]"}], "<", "threshold"}], "||", 
             RowBox[{
              RowBox[{"Abs", "[", "d2", "]"}], "<", "threshold"}]}], " ", 
            ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "2"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<mag\>\"", ",", 
                RowBox[{"e", "+", "1"}], ",", "dv1sign", ",", "dv2sign"}], 
               "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
               "0.", ",", "0.", ",", "\"\<mag\>\"", ",", "e", ",", "0.", ",", 
                "0."}], "}"}], "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Change", " ", "of", " ", "sign", " ", "during", " ", "iteration"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"dfline1", "[", 
                RowBox[{"p0", "-", "dv1sign"}], "]"}], "*", "d1"}], "<", 
              "0"}], "||", 
             RowBox[{
              RowBox[{
               RowBox[{"dfline2", "[", 
                RowBox[{"p0", "+", "dv2sign"}], "]"}], "*", "d2"}], "<", 
              "0"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "2"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<flip\>\"", ",", 
                RowBox[{"e", "+", "1"}], ",", "dv1sign", ",", "dv2sign"}], 
               "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
               "0.", ",", "0.", ",", "\"\<flip\>\"", ",", "e", ",", "0.", ",",
                 "0."}], "}"}], "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"{", 
           RowBox[{"Null", ",", "Null"}], "}"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "d1", " ", "and", " ", "d2", " ", "have", " ", "to", " ", "be", " ",
            "the", " ", "same", " ", "sign"}], " ", "*)"}], 
         "\[IndentingNewLine]", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"d1", "*", "d2"}], " ", "<", "0"}], ",", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"e", "<", "2"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"v1", ",", "v2", ",", "\"\<sign\>\"", ",", 
                RowBox[{"e", "+", "1"}], ",", "dv1sign", ",", "dv2sign"}], 
               "}"}], "]"}], ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{
               "0.", ",", "0.", ",", "\"\<sign\>\"", ",", "e", ",", "0.", ",",
                 "0."}], "}"}], "]"}]}], "]"}]}], "]"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"dv1", ",", 
           RowBox[{"dv2", " ", ":", " ", 
            RowBox[{"step", " ", "from", " ", "last", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}], " ", "to", " ", "new", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dv1", ",", "dv2"}], "}"}], "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fline1", "[", "p1", "]"}], "-", "c"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"d1", "+", 
               RowBox[{
                RowBox[{"Sign", "[", "d1", "]"}], "*", 
                RowBox[{"Abs", "[", "fric1", "]"}]}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "-", 
               RowBox[{"fline2", "[", "p2", "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"d2", "+", 
               RowBox[{
                RowBox[{"Sign", "[", "d2", "]"}], "*", 
                RowBox[{"Abs", "[", "fric2", "]"}]}]}], ")"}]}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v1", "+", "dv1"}], ",", 
           RowBox[{"v2", "+", "dv2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"{", 
                RowBox[{"dv1", ",", "dv2"}], "}"}], "]"}], "<", "0.001"}], 
             ",", "\"\<converged\>\"", ",", "\"\<oksign\>\""}], "]"}], ",", 
           "e", ",", "dv1sign", ",", "dv2sign"}], "}"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1_", ",", "v2_", ",", "status_", ",", "2", ",", "dv1sign_", ",", 
         "dv2sign_"}], "}"}], ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "0.", ",", "0.", ",", "status", ",", "2", ",", "0.", ",", "0."}], 
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1_", ",", "v2_", ",", "\"\<sign\>\"", ",", "e_", ",", "dv1sign_", 
         ",", "dv2sign_"}], "}"}], ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "v1", ",", "v2", ",", "\"\<sign\>\"", ",", "e", ",", "dv1sign", ",", 
        "dv2sign"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1_", ",", "v2_", ",", "\"\<mag\>\"", ",", "e_", ",", "dv1sign_", 
         ",", "dv2sign_"}], "}"}], ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "v1", ",", "v2", ",", "\"\<mag\>\"", ",", "e", ",", "dv1sign", ",", 
        "dv2sign"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1_", ",", "v2_", ",", "\"\<flip\>\"", ",", "e_", ",", "dv1sign_", 
         ",", "dv2sign_"}], "}"}], ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "v1", ",", "v2", ",", "\"\<flip\>\"", ",", "e", ",", "dv1sign", ",", 
        "dv2sign"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "::", "usage"}], "=", 
     "\"\<\nFunction to update values of v1 and v2 with Constrained standards\
\nInput\[Rule] [{v1,v2,status,e},p0,{{f1,df1},{f2,df2},threshold}\nOutput-> \
{v1,v2,status}\nv1= Solution of f1\nv2= Solution of f2\nstatus= Status of the \
solution (ok, sign, mag, flip, converged)\ne= counts the amount of \
constraints not met\np0= point of interest\n{f1,df1}={function 1, derivative \
of function 1}\n{f2,df2}={function 2, derivative of function 2}\nthreshold= \
threshold to respect magnitude constraint\n\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8363952713646383`*^9, 3.836395285622998*^9}, {
   3.836395339420894*^9, 3.836395340499365*^9}, {3.8363960314026394`*^9, 
   3.83639606263406*^9}, {3.836488222237672*^9, 3.8364882261367626`*^9}, 
   3.836488794120328*^9, 3.8366473739266353`*^9, {3.8370817604645205`*^9, 
   3.837081837795313*^9}, {3.8370818949284244`*^9, 3.83708194197997*^9}, {
   3.8370842312798247`*^9, 3.8370843044170694`*^9}, 3.837084651677993*^9, {
   3.8370847210046616`*^9, 3.837084725007778*^9}, {3.8377956666920443`*^9, 
   3.8377956995724106`*^9}, {3.8377957498926754`*^9, 3.83779581642708*^9}, {
   3.8378749336691175`*^9, 3.837874935107934*^9}, {3.837875154862604*^9, 
   3.8378751613696737`*^9}, {3.838079285613141*^9, 3.8380792941631727`*^9}, {
   3.8380795418031816`*^9, 3.838079563444045*^9}, {3.8380797346993732`*^9, 
   3.8380797393432436`*^9}, {3.83807982197386*^9, 3.8380798582862535`*^9}, {
   3.8380805890530586`*^9, 3.838080591503376*^9}, {3.8380809576132145`*^9, 
   3.8380809678530693`*^9}, {3.838740908992169*^9, 3.838740950609075*^9}, {
   3.838832496708708*^9, 3.838832519171462*^9}, {3.8400446630563745`*^9, 
   3.840044714150585*^9}, 3.8400449264576254`*^9, {3.8400453571541862`*^9, 
   3.8400453654985714`*^9}, {3.8400456962038565`*^9, 3.840045715342576*^9}, {
   3.8400459309942083`*^9, 3.8400459656201653`*^9}, {3.8400668389960976`*^9, 
   3.840066846494582*^9}, {3.8401886870003967`*^9, 3.840188820046699*^9}, {
   3.840188896296138*^9, 3.840188925231366*^9}, {3.840188999652712*^9, 
   3.840189013444944*^9}, {3.840189096038698*^9, 3.8401891974523277`*^9}, {
   3.840189624170314*^9, 3.840189800290779*^9}, {3.840189958389654*^9, 
   3.8401900137831907`*^9}, 3.8402120639745617`*^9, {3.8402121216067257`*^9, 
   3.84021212708329*^9}, {3.8402122805477524`*^9, 3.840212286917535*^9}, 
   3.8402132864409337`*^9, {3.840213485572333*^9, 3.840213490367629*^9}, {
   3.840214015425631*^9, 3.8402140182491136`*^9}, 3.8402801476209807`*^9, 
   3.84028020940808*^9, {3.840281347776226*^9, 3.8402813646606426`*^9}, 
   3.8402849362643695`*^9, {3.840285277474245*^9, 3.8402852834041367`*^9}, {
   3.8402881918413506`*^9, 3.8402881935364695`*^9}, {3.8402918630085573`*^9, 
   3.8402918666426845`*^9}, {3.840535302919426*^9, 3.8405353122265525`*^9}, {
   3.840535355695983*^9, 3.8405353675596466`*^9}, {3.8405478262244816`*^9, 
   3.8405478282532935`*^9}, {3.84054786170028*^9, 3.8405479597319727`*^9}, {
   3.8405487500943556`*^9, 3.8405487530817695`*^9}, {3.840548890802074*^9, 
   3.840548895672971*^9}, {3.8405489566370993`*^9, 3.8405489677693124`*^9}, {
   3.840558898944503*^9, 3.840558919673791*^9}, {3.8405590751929426`*^9, 
   3.8405590905799665`*^9}, {3.8405786182601976`*^9, 
   3.8405786202723913`*^9}, {3.8414190328513837`*^9, 3.841419038459272*^9}, {
   3.8414202168521104`*^9, 3.841420329531598*^9}, {3.841420439013297*^9, 
   3.8414205133814917`*^9}, {3.8414205831457896`*^9, 
   3.8414205862091703`*^9}, {3.8414212543379865`*^9, 
   3.8414212550688157`*^9}, {3.8414217649166536`*^9, 3.841421771344642*^9}, {
   3.8414218060941353`*^9, 3.841421831565406*^9}, {3.8414223452355947`*^9, 
   3.8414223582096825`*^9}, {3.8414865132710576`*^9, 
   3.8414865464466257`*^9}, {3.841495145124576*^9, 3.8414952155814676`*^9}, {
   3.8414953307795877`*^9, 3.8414953942366886`*^9}, {3.841508125479186*^9, 
   3.8415081301234617`*^9}, {3.842637401140934*^9, 3.8426374123839664`*^9}, {
   3.8426374548457556`*^9, 3.842637457843338*^9}, 3.843049982100257*^9, {
   3.843050021340685*^9, 3.8430500999008293`*^9}, {3.8430501434061136`*^9, 
   3.8430501534972377`*^9}, {3.843050317710548*^9, 3.843050374728256*^9}, {
   3.843050532771618*^9, 3.8430505426132917`*^9}, {3.8430505912578697`*^9, 
   3.843050629003641*^9}, {3.843050769213539*^9, 3.8430508007053356`*^9}, {
   3.843050857941908*^9, 3.843050893728114*^9}, {3.8431562683776445`*^9, 
   3.843156300047364*^9}, {3.8432380519579687`*^9, 3.8432380595109124`*^9}, {
   3.8432383702531567`*^9, 3.843238373254682*^9}, {3.8432386407608576`*^9, 
   3.8432387147264*^9}, {3.8432387609363174`*^9, 3.8432388099733896`*^9}, {
   3.843318401941639*^9, 3.8433184420460978`*^9}, {3.843320006904053*^9, 
   3.8433200112934194`*^9}, {3.8433202677981052`*^9, 
   3.8433202867001824`*^9}, {3.843320823628084*^9, 3.8433208263772078`*^9}, {
   3.843321370194274*^9, 3.843321371975088*^9}, {3.843321438098985*^9, 
   3.84332144108267*^9}, {3.8433215405595207`*^9, 3.8433215452146764`*^9}, {
   3.8433238994156475`*^9, 3.843323908020013*^9}, {3.843324426639652*^9, 
   3.843324427655038*^9}, {3.8433245969655886`*^9, 3.8433246284943953`*^9}, {
   3.84332472235494*^9, 3.843324751813099*^9}, {3.8433251453789067`*^9, 
   3.843325244881585*^9}, {3.8433254327524137`*^9, 3.8433254396671004`*^9}, {
   3.8435886977439137`*^9, 3.8435887006809373`*^9}, {3.843588734341316*^9, 
   3.843588736964617*^9}, {3.843657623112109*^9, 3.8436576258550887`*^9}, {
   3.843657672813307*^9, 3.8436576734384823`*^9}, {3.843657704089922*^9, 
   3.8436577052782707`*^9}, {3.843657794121241*^9, 3.843657882071515*^9}, {
   3.843658133191927*^9, 3.8436582945712557`*^9}, {3.84365851961432*^9, 
   3.843658521663968*^9}, {3.8436585793200884`*^9, 3.843658716872859*^9}, {
   3.8436588045824523`*^9, 3.8436588049949584`*^9}, {3.843658863053029*^9, 
   3.843658961505745*^9}, {3.843659043035465*^9, 3.8436591702348037`*^9}, {
   3.8436599006955757`*^9, 3.843659992999459*^9}, {3.843660619810734*^9, 
   3.843660698842578*^9}, {3.843660799915493*^9, 3.843660800440464*^9}, {
   3.8436608401266212`*^9, 3.8436608405104103`*^9}, {3.843660949146835*^9, 
   3.843660954051989*^9}, {3.843661000414298*^9, 3.8436610224729176`*^9}, {
   3.8436611014606276`*^9, 3.8436611298293953`*^9}, {3.843661197665208*^9, 
   3.843661254265544*^9}, {3.843661550414008*^9, 3.84366157741346*^9}, {
   3.843661658275545*^9, 3.8436617022235255`*^9}, {3.8436617540912647`*^9, 
   3.8436617792385283`*^9}, {3.843661857169232*^9, 3.8436618843083487`*^9}, {
   3.8436619600753984`*^9, 3.843661961715836*^9}, {3.8436622514912148`*^9, 
   3.8436622635466537`*^9}, {3.843662413438278*^9, 3.843662448400967*^9}, {
   3.8436625285918655`*^9, 3.8436625471865697`*^9}, {3.8436626135925455`*^9, 
   3.843662661976474*^9}, {3.843662724660755*^9, 3.84366272547377*^9}, {
   3.843662763298168*^9, 3.8436628277886276`*^9}, {3.8436629883722124`*^9, 
   3.843662990351551*^9}, {3.843663265773568*^9, 3.8436632660029507`*^9}, {
   3.843663624473485*^9, 3.8436636836013775`*^9}, {3.8436638758273687`*^9, 
   3.843664023666267*^9}, {3.8436641359683046`*^9, 3.843664142494645*^9}, {
   3.843664185610051*^9, 3.8436642410585537`*^9}, {3.8436643673624783`*^9, 
   3.8436644473962812`*^9}, {3.843664481875358*^9, 3.843664496689361*^9}, {
   3.8436645319383373`*^9, 3.843664562815386*^9}, 3.843664609261511*^9, {
   3.843664665585013*^9, 3.8436646739273057`*^9}, {3.8436647495305347`*^9, 
   3.843664782514429*^9}, {3.843664961648424*^9, 3.843664964318406*^9}, {
   3.84366504056983*^9, 3.843665052694545*^9}, {3.843665090619931*^9, 
   3.8436650909375334`*^9}, {3.8436651233461323`*^9, 3.843665126897846*^9}, {
   3.843665209910304*^9, 3.843665216647706*^9}, {3.8436654162553616`*^9, 
   3.843665419537364*^9}, {3.8436654965013795`*^9, 3.8436655779694576`*^9}, 
   3.8436656975706797`*^9, {3.8436657540746517`*^9, 3.843665765869897*^9}, {
   3.84373988851646*^9, 3.8437399592309017`*^9}, {3.8437402002474284`*^9, 
   3.843740249369633*^9}, {3.8437404455371885`*^9, 3.8437404546797605`*^9}, {
   3.8437411272918453`*^9, 3.8437411784718847`*^9}, {3.8437414253265247`*^9, 
   3.843741430878599*^9}, {3.8437422526881843`*^9, 3.843742280332114*^9}, {
   3.843831236498489*^9, 3.843831244666244*^9}, {3.8438316444280415`*^9, 
   3.843831676956211*^9}, {3.8438333194973483`*^9, 3.843833324633465*^9}, {
   3.843833573862584*^9, 3.8438335842731075`*^9}, 3.8438336149044266`*^9, 
   3.843833644966114*^9, {3.843833873065646*^9, 3.8438338778213515`*^9}, {
   3.8438339337966547`*^9, 3.8438339516206846`*^9}, {3.8438351131820297`*^9, 
   3.843835127868786*^9}, {3.8438362047018023`*^9, 3.843836257490957*^9}, {
   3.84384913667455*^9, 3.8438492603924522`*^9}, {3.843849293285287*^9, 
   3.843849323433752*^9}, {3.843850686361608*^9, 3.8438507095946765`*^9}, {
   3.8438529456193323`*^9, 3.843852981421211*^9}, {3.843853042882265*^9, 
   3.8438534780784693`*^9}, {3.8438535616140213`*^9, 
   3.8438535696904235`*^9}, {3.8438535997714205`*^9, 
   3.8438536007396636`*^9}, {3.8438537050039663`*^9, 3.843853705232463*^9}, {
   3.843853758937474*^9, 3.8438537667763124`*^9}, {3.843853846383272*^9, 
   3.8438538577711287`*^9}, {3.843853902479278*^9, 3.843853923988542*^9}, 
   3.8438539593340025`*^9, {3.843854015467157*^9, 3.8438540365325413`*^9}, {
   3.8438540756473484`*^9, 3.843854075900713*^9}, {3.843916986984389*^9, 
   3.8439170409992275`*^9}, {3.8439170969318132`*^9, 
   3.8439171373043585`*^9}, {3.8442599172086864`*^9, 3.84425998948857*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"4fdc4427-ab7c-4822-8290-a142d2bfc29e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Test", "Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"ae9c1c19-996f-4736-a4d8-\
9d1e6e3e2062"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"initial", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v1", ",", " ", "v2", ",", "status", ",", "e", ",", "dv1sign", ",", 
       "dv2sign"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "0.", ",", "0.", ",", "\"\<ok\>\"", ",", "0.", ",", "0.", ",", "0."}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", "18"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8363961378588843`*^9, {3.8363967443857393`*^9, 3.8363967528759184`*^9}, {
   3.8363968389271307`*^9, 3.8363968394458265`*^9}, 3.8363986080928793`*^9, {
   3.8363995877529974`*^9, 3.8363995880494523`*^9}, {3.8401892506832857`*^9, 
   3.840189256145101*^9}, {3.84141418354974*^9, 3.841414205257785*^9}, {
   3.8430483435931425`*^9, 3.843048352325457*^9}, {3.8435736817894325`*^9, 
   3.8435736942554803`*^9}, {3.8437537396040974`*^9, 
   3.8437537554626484`*^9}, {3.8437538585293627`*^9, 
   3.8437538590227833`*^9}, {3.8438317262806945`*^9, 3.843831758878952*^9}, {
   3.84383230217494*^9, 3.8438323408943057`*^9}, 3.8438333519274297`*^9, 
   3.8438334402400837`*^9, 3.843833497494026*^9, 3.8438336588116317`*^9, {
   3.8438337015966387`*^9, 3.84383370202672*^9}, 3.843833787385521*^9, {
   3.843853482389247*^9, 3.8438534909963074`*^9}, {3.8438537391798325`*^9, 
   3.8438537395924234`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"8afbc134-2a96-4829-a98d-261227ff5001"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"status", "=", "\"\<ok\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.8437542033517194`*^9, 3.8437542128398094`*^9}, {
   3.843832275680855*^9, 3.8438322921697855`*^9}, 3.843832601497947*^9, {
   3.843833506562276*^9, 3.843833528608164*^9}, 3.8438337842905464`*^9, {
   3.843853804698841*^9, 3.843853809642054*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"df917fe6-c171-4677-bfcd-46b626c18e59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Test", " ", "for", " ", "PyrUpgrade1D"}], ",", " ", 
    RowBox[{
    "manual", " ", "test", " ", "to", " ", "iterate", " ", "multiple", " ", 
     "times"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "n", " ", "is", " ", "the", " ", "level", " ", "of", " ", "pyramid"}], " ",
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "v1", ",", "v2", ",", "status", ",", "e", ",", "dv1sign", ",", 
     "dv2sign"}], "}"}], "=", 
   RowBox[{"PyrUpgrade1D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v1", ",", "v2", ",", "status", ",", "e", ",", "dv1sign", ",", 
       "dv2sign"}], "}"}], ",", "p", ",", " ", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", "n", "]"}], "]"}], ",", "0.01", ",", "noteBookMode"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8363967651550703`*^9, 3.8363968130279603`*^9}, {
   3.836396853335551*^9, 3.8363968558471217`*^9}, {3.836398527992988*^9, 
   3.836398541330168*^9}, {3.836399044228342*^9, 3.8363990495392766`*^9}, {
   3.836399208159257*^9, 3.8363992132916665`*^9}, {3.8400458463150663`*^9, 
   3.8400458889085207`*^9}, 3.8400459372136974`*^9, {3.8400459743200526`*^9, 
   3.840045979480372*^9}, {3.840189232799335*^9, 3.840189243506825*^9}, 
   3.8402145895445347`*^9, 3.8402800323364515`*^9, 3.840280121570874*^9, 
   3.840280181640683*^9, {3.840280221138157*^9, 3.8402802307424874`*^9}, {
   3.840280262614027*^9, 3.840280329574231*^9}, 3.840548072388741*^9, {
   3.841319243228366*^9, 3.8413192702952523`*^9}, {3.8413206397350407`*^9, 
   3.8413206517595778`*^9}, 3.8414141937325172`*^9, {3.843153289728837*^9, 
   3.8431533303648815`*^9}, 3.8435737335282726`*^9, {3.843673768874278*^9, 
   3.8436737693178988`*^9}, {3.843675813944577*^9, 3.843675814060481*^9}, {
   3.843676226210335*^9, 3.843676250671171*^9}, {3.8437479795353403`*^9, 
   3.8437479971997814`*^9}, {3.843748584473981*^9, 3.8437485968546877`*^9}, {
   3.8437524135173283`*^9, 3.8437524152382493`*^9}, {3.843753838280105*^9, 
   3.8437538424018755`*^9}, {3.8437540451602316`*^9, 3.8437540745383673`*^9}, 
   3.8437542020459256`*^9, {3.8438317402397795`*^9, 3.843831747944312*^9}, 
   3.843831869854334*^9, {3.8438535195505447`*^9, 3.8438535290094166`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"9aa1df55-4b50-4c69-af76-58c3366fca58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "see", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"seePlot", "[", 
   RowBox[{"p", ",", "5", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v1", "+", "dv1sign"}], ",", 
      RowBox[{"v2", "+", "dv2sign"}]}], "}"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", "n", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8363983430106754`*^9, 3.8363983604496603`*^9}, {
   3.8363989657393045`*^9, 3.8363989940990686`*^9}, {3.836399252495593*^9, 
   3.836399458153307*^9}, 3.840214598251926*^9, 3.8402801272137938`*^9, {
   3.8402801885832624`*^9, 3.840280253201376*^9}, {3.840280283420054*^9, 
   3.8402803342978687`*^9}, 3.84054808258837*^9, 3.841319285628847*^9, {
   3.84315333406427*^9, 3.8431533569493647`*^9}, {3.8435736708990726`*^9, 
   3.843573675032316*^9}, 3.843748176006432*^9, {3.8437524294863195`*^9, 
   3.843752440945123*^9}, 3.8437538508453565`*^9, 3.84383369028327*^9, {
   3.8438338299677925`*^9, 3.8438338367674365`*^9}, {3.843853619174862*^9, 
   3.843853622708226*^9}, 3.8438539767549386`*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"8ac72149-7774-43cb-be5f-c0e6e76366d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PyrFlow1D", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9},ExpressionUUID->"9476c611-cedb-4e14-b4f1-\
a7f3e4e663c4"],

Cell["\<\
pyrfunctions : all levels of pyramid. {l1,l2,l3,l4,...} or {l1}\
\>", "Text",
 CellChangeTimes->{{3.840190264918742*^9, 
  3.84019029066455*^9}},ExpressionUUID->"dc51e695-7873-4d23-8fd3-\
56cf6235c000"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PyrFlow1D", "[", 
     RowBox[{
     "i_", ",", " ", "p0_", ",", " ", "pyrfunctions_", ",", "threshold_", 
      ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v1", ",", " ", "v2", ",", "c", ",", "d", ",", "dd", ",", "cc", ",", 
        "status", ",", "e", ",", "dv1sign", ",", "iterTable", ",", 
        "updateValues"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"Length", "[", "pyrfunctions", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"{", 
          RowBox[{
          "v1", ",", " ", "v2", ",", " ", "status", ",", " ", "e", ",", " ", 
           "dv1sign", ",", " ", "dv2sign"}], "}"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"updateValues", "=", 
         RowBox[{"{", 
          RowBox[{
          "0.", ",", "0.", ",", "\"\<ok\>\"", ",", "0.", ",", "0.", ",", 
           "0."}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"compute", " ", "at", " ", "this", " ", "scale"}], ",", 
           " ", 
           RowBox[{
           "using", " ", "current", " ", "motion", " ", "estimate"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "<", "2"}], ",", 
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", "\"\<ok\>\""}], ",", 
             RowBox[{"updateValues", "=", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", 
                RowBox[{"updateValues", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "2.", ",", "0.", ",", 
                "0."}], "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"iterTable", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"updateValues", "=", 
                RowBox[{"PyrUpgrade1D", "[", 
                 RowBox[{"updateValues", ",", "p0", ",", " ", 
                  RowBox[{"pyrfunctions", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "f"}], "]"}], "]"}], ",", 
                  RowBox[{"threshold", "*", 
                   RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "c"}], "+", "1"}], ")"}]}]}], ",", 
                  "\"\<ConstrainedInitialSign\>\""}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Scaling", " ", "v", " ", "values"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "=", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"updateValues", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", 
               RowBox[{"(", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pyrfunctions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "f"}], ",", "1", ",", "2"}], "]"}], "]"}], 
                   "'"}], "[", 
                  RowBox[{"p0", "-", 
                   RowBox[{"updateValues", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ")"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"updateValues", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"(", 
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pyrfunctions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "f"}], ",", "2", ",", "2"}], "]"}], "]"}], 
                   "'"}], "[", 
                  RowBox[{"p0", "-", 
                   RowBox[{"updateValues", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ")"}]}]}],
              "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"c", "-", "1"}]}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "1", ",", 
            RowBox[{"Length", "[", "pyrfunctions", "]"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"updateValues", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"updateValues", "[", 
            RowBox[{"[", 
             RowBox[{"-", "2"}], "]"}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"updateValues", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", 
           RowBox[{"updateValues", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"updateValues", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PyrFlow1D", "::", "usage"}], "=", 
   "\"\<\nFunction to update values of v1 and v2 over all levels of a \
pyramidal function representation\nwith OverConstrained standards.\nInput\
\[Rule] [i, p0, pyrfunctions, threshold]\nOutput-> {v1, v2, status,e}\ni= \
number of iterations\np0= point of interest\npyrfunctions= list with the \
dimensions of {pyrlvl, number of image(1 or 2), kind of function(f or df)}\n\
where pyrlvl is the pyramidal level\nthreshold= threshold to respect \
magnitude constraint\nv1= Solution of f1\nv2= Solution of f2\nstatus= Status \
of the solution (ok, sign, mag, flip, converged)\ne= Counts the amount of \
times the constraints were not met\n\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.836395257636574*^9, 3.836395272859167*^9}, {
   3.83708196322594*^9, 3.8370820062598658`*^9}, {3.837083182655498*^9, 
   3.8370832734823055`*^9}, {3.8370843532979484`*^9, 
   3.8370843675088606`*^9}, {3.838080701244558*^9, 3.8380807259152684`*^9}, {
   3.838080793823208*^9, 3.8380808755938196`*^9}, {3.8380809401222954`*^9, 
   3.838080942274747*^9}, 3.8380810086446276`*^9, {3.8380816063631763`*^9, 
   3.8380816393331475`*^9}, {3.8380820470151634`*^9, 
   3.8380820558435106`*^9}, {3.8380823886542034`*^9, 
   3.8380824062240515`*^9}, {3.8380824773647776`*^9, 
   3.8380825736331425`*^9}, {3.8380826279050765`*^9, 3.838082713503049*^9}, {
   3.8380828471635237`*^9, 3.8380828901935434`*^9}, {3.83848262336782*^9, 
   3.8384826483396864`*^9}, {3.838483209637656*^9, 3.838483252891429*^9}, {
   3.83848337672888*^9, 3.838483389713195*^9}, 3.8384834622891912`*^9, {
   3.838483925470047*^9, 3.838483959825934*^9}, 3.8384839932092*^9, {
   3.8384840245223246`*^9, 3.83848406745443*^9}, {3.8384841090878415`*^9, 
   3.838484119135103*^9}, {3.8384842940787163`*^9, 3.8384842965189843`*^9}, {
   3.838484331536871*^9, 3.838484376855281*^9}, {3.8384844316993575`*^9, 
   3.8384844364710684`*^9}, {3.838484472533862*^9, 3.838484496768239*^9}, {
   3.838484653516262*^9, 3.8384846980991325`*^9}, 3.8384847407136316`*^9, {
   3.838484789836351*^9, 3.838484836358838*^9}, {3.838485707284088*^9, 
   3.838485708317006*^9}, {3.838745304433283*^9, 3.838745304748513*^9}, 
   3.8387454287233124`*^9, {3.838745566958905*^9, 3.838745572968202*^9}, {
   3.838832480835082*^9, 3.8388324858883576`*^9}, 3.838832662601839*^9, 
   3.8400444674100447`*^9, {3.840044657898258*^9, 3.840044675080756*^9}, {
   3.840044792234081*^9, 3.8400448028818226`*^9}, {3.840045382891678*^9, 
   3.8400454107116804`*^9}, {3.8400457742282677`*^9, 3.840045782682536*^9}, {
   3.840046004923623*^9, 3.840046009099416*^9}, 3.8400460619888587`*^9, {
   3.8400460949919004`*^9, 3.84004610011978*^9}, {3.8400461438186865`*^9, 
   3.8400461690448275`*^9}, {3.8400536215227985`*^9, 
   3.8400536593035183`*^9}, {3.840053705946847*^9, 3.840053723757249*^9}, {
   3.8400537835503826`*^9, 3.8400538050647817`*^9}, {3.8400538490526533`*^9, 
   3.840053877267029*^9}, {3.840054015361252*^9, 3.840054050881156*^9}, 
   3.8400541211876483`*^9, {3.840054841363824*^9, 3.840054842590229*^9}, {
   3.8400548774584274`*^9, 3.8400548954699373`*^9}, 3.840062489108899*^9, {
   3.8400625230755796`*^9, 3.8400625357077594`*^9}, {3.840062608567613*^9, 
   3.840062609225909*^9}, 3.840064282796586*^9, {3.840064347610565*^9, 
   3.8400643514241934`*^9}, {3.840064435863537*^9, 3.840064436038506*^9}, {
   3.840066248372734*^9, 3.8400662514900155`*^9}, {3.8400664641163483`*^9, 
   3.8400664688160753`*^9}, 3.8400666848661065`*^9, {3.8400668057053223`*^9, 
   3.8400668205868874`*^9}, {3.8400669375243015`*^9, 3.840067029056565*^9}, {
   3.8400670665699735`*^9, 3.8400670668913956`*^9}, {3.8400673521968985`*^9, 
   3.840067373037039*^9}, {3.8400674925370984`*^9, 3.840067499815276*^9}, {
   3.8400676885764246`*^9, 3.8400676914667573`*^9}, {3.840067767866358*^9, 
   3.840067799215399*^9}, {3.8400678334141483`*^9, 3.840067834605913*^9}, {
   3.8400678737948313`*^9, 3.840067881587015*^9}, {3.840067987954644*^9, 
   3.840067988566532*^9}, {3.8400687429367623`*^9, 3.8400688146563964`*^9}, 
   3.8400688885471363`*^9, {3.8400690624252715`*^9, 3.8400690763966675`*^9}, {
   3.840069180186268*^9, 3.84006918878432*^9}, {3.8400699684665527`*^9, 
   3.840070030673232*^9}, {3.840070069194943*^9, 3.840070130021838*^9}, {
   3.8400702050033846`*^9, 3.840070295059636*^9}, {3.8400703424521255`*^9, 
   3.8400703701890373`*^9}, {3.840070536126915*^9, 3.840070543162916*^9}, {
   3.8400707194066267`*^9, 3.840070723381528*^9}, {3.840071016027475*^9, 
   3.840071035148421*^9}, 3.840071082957506*^9, {3.8400711294374886`*^9, 
   3.8400712078568583`*^9}, {3.8400720622403393`*^9, 3.840072062449636*^9}, {
   3.8400725161957693`*^9, 3.8400725194734535`*^9}, {3.840190301254188*^9, 
   3.840190369112875*^9}, {3.840190421163118*^9, 3.840190483558923*^9}, {
   3.8401905169341288`*^9, 3.8401905686044073`*^9}, {3.840190665069972*^9, 
   3.840190691093354*^9}, {3.840190764716844*^9, 3.840190909552351*^9}, {
   3.840190952571726*^9, 3.840190994597392*^9}, 3.840191052489993*^9, {
   3.84019109858766*^9, 3.840191106858177*^9}, {3.840212643647187*^9, 
   3.8402126587042575`*^9}, {3.840212948316355*^9, 3.840213092874155*^9}, {
   3.8402131666079383`*^9, 3.8402131696129346`*^9}, {3.8402143027437525`*^9, 
   3.8402143267459517`*^9}, {3.8402804561573114`*^9, 3.840280523225045*^9}, {
   3.8402809376168385`*^9, 3.840280971021533*^9}, {3.8402849953143473`*^9, 
   3.840284995539066*^9}, {3.840285203246116*^9, 3.8402852211954503`*^9}, {
   3.8405484745807753`*^9, 3.840548502614027*^9}, {3.840548682116254*^9, 
   3.8405486958534555`*^9}, {3.8405786523932867`*^9, 3.840578657988408*^9}, {
   3.8414189828506317`*^9, 3.8414190153348923`*^9}, {3.8414201999561043`*^9, 
   3.8414202059767733`*^9}, {3.841422235821972*^9, 3.8414222386898837`*^9}, {
   3.842637171335677*^9, 3.842637171767519*^9}, {3.8430502619890904`*^9, 
   3.843050270518544*^9}, {3.843050460398434*^9, 3.8430504611482496`*^9}, {
   3.8430511064726257`*^9, 3.843051108768953*^9}, {3.843059830007685*^9, 
   3.8430598306316833`*^9}, {3.8431563089552684`*^9, 
   3.8431563349852266`*^9}, {3.8435877450299177`*^9, 3.843587927732647*^9}, 
   3.8435879648494453`*^9, {3.8435882518247757`*^9, 3.8435882583050823`*^9}, {
   3.8435884431319437`*^9, 3.843588446792751*^9}, {3.843588502609065*^9, 
   3.8435885039545493`*^9}, {3.84358854311246*^9, 3.84358855472566*^9}, {
   3.843659177420129*^9, 3.8436591938425274`*^9}, {3.843663546652871*^9, 
   3.8436636100555925`*^9}, {3.84366370307749*^9, 3.8436637094891386`*^9}, {
   3.843663835431464*^9, 3.8436638656803412`*^9}, {3.8436657352242646`*^9, 
   3.8436657482571917`*^9}, {3.843666159144108*^9, 3.8436661632291436`*^9}, {
   3.8436663018785105`*^9, 3.843666306822632*^9}, {3.8436664460298877`*^9, 
   3.8436665476066637`*^9}, {3.843666582354282*^9, 3.843666582822295*^9}, {
   3.843666794547901*^9, 3.843666795475816*^9}, {3.84366687001715*^9, 
   3.8436668781864004`*^9}, 3.843667267634773*^9, {3.843667418386608*^9, 
   3.8436674400611563`*^9}, {3.8436676285197315`*^9, 3.843667628818766*^9}, {
   3.8436678394563875`*^9, 3.843667862134698*^9}, {3.84374042807281*^9, 
   3.843740432503826*^9}, {3.8437404739313974`*^9, 3.8437404797123957`*^9}, {
   3.843740549711228*^9, 3.8437405596339397`*^9}, {3.8437406315099144`*^9, 
   3.843740631785816*^9}, {3.8437407528485146`*^9, 3.8437407539730225`*^9}, {
   3.8437416380222497`*^9, 3.8437416609835267`*^9}, {3.843831885008831*^9, 
   3.843831895846131*^9}, {3.843831930040265*^9, 3.843832010857004*^9}, {
   3.843832043973868*^9, 3.843832095327493*^9}, {3.8438321275150204`*^9, 
   3.8438321934420013`*^9}, {3.843835065528225*^9, 3.8438350660889874`*^9}, {
   3.8438492653977942`*^9, 3.843849269401266*^9}, {3.8438493770922575`*^9, 
   3.8438493773653746`*^9}, {3.843850718357809*^9, 3.843850720319829*^9}, {
   3.84385298783541*^9, 3.8438529928686028`*^9}, {3.8438536382562723`*^9, 
   3.843853677500249*^9}, {3.8442599933780375`*^9, 3.8442599947214794`*^9}, 
   3.8442604301474943`*^9, {3.8443442238087225`*^9, 
   3.8443442253144455`*^9}},ExpressionUUID->"2ba813e8-f4d4-445d-9ef4-\
e02d9a926ee0"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"ba5cc455-fcf1-4e82-9c11-\
345ce239926d"],

Cell["\<\
0.01*2^(-m) depends on m to update the error depending on the highest \
resolution scale\
\>", "Text",
 CellChangeTimes->{{3.840548374592219*^9, 
  3.8405484003331394`*^9}},ExpressionUUID->"d665bf0a-b30b-44e3-a00d-\
ac5233747928"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initializing", " ", "values"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "v2"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", "18"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"m", "\[Rule]", " ", 
      RowBox[{"max", " ", "lvl"}]}], ",", " ", 
     RowBox[{"n", "\[Rule]", " ", 
      RowBox[{"min", " ", "lvl"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PyrFlow1D", " ", "solution"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2", ",", "status"}], "}"}], "=", 
    RowBox[{"PyrFlow1D", "[", 
     RowBox[{"i", ",", " ", "p", ",", 
      RowBox[{"pyrf12", "[", 
       RowBox[{"[", 
        RowBox[{"m", ";;", "n"}], "]"}], "]"}], ",", 
      RowBox[{"0.0001", "*", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "m"}], "+", "1"}], ")"}]}]}], ",", "noteBookMode"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2"}], "}"}], "]"}], ",", "status"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.83639948364995*^9, 3.836399519806125*^9}, {
   3.8363995590245132`*^9, 3.83639960757861*^9}, {3.838080084756638*^9, 
   3.8380800851141353`*^9}, {3.8380804424545712`*^9, 
   3.8380804457646008`*^9}, {3.8380805343644238`*^9, 
   3.8380805622628913`*^9}, {3.8380806157132387`*^9, 3.8380806315133705`*^9}, 
   3.838080662503994*^9, {3.838080878494111*^9, 3.838080920662928*^9}, 
   3.838082457493312*^9, {3.840045753265614*^9, 3.8400457539577885`*^9}, 
   3.84004579390691*^9, {3.840046163537953*^9, 3.840046164081414*^9}, {
   3.840064234698558*^9, 3.8400642457064667`*^9}, 3.8400643170265927`*^9, {
   3.8400670995057793`*^9, 3.8400671416366897`*^9}, {3.840067276996817*^9, 
   3.840067280625373*^9}, 3.8400676368053093`*^9, 3.8400679985153937`*^9, {
   3.840191148333891*^9, 3.840191262607202*^9}, {3.8402805474678636`*^9, 
   3.8402805841324234`*^9}, 3.8402806423025513`*^9, {3.8402806786126747`*^9, 
   3.840280914219866*^9}, 3.8402810301816626`*^9, 3.840281335289158*^9, 
   3.8402847673221245`*^9, {3.8402849473165145`*^9, 3.840284950986496*^9}, 
   3.8402850025598235`*^9, {3.8405484097849054`*^9, 3.8405484111283555`*^9}, {
   3.8405485354254704`*^9, 3.8405485555772915`*^9}, {3.8405486541284895`*^9, 
   3.8405486554873114`*^9}, {3.840548721600456*^9, 3.840548733226588*^9}, {
   3.8405488364992127`*^9, 3.840548857907818*^9}, {3.8413207426066556`*^9, 
   3.8413207925909653`*^9}, {3.8413209376882544`*^9, 3.8413210241504335`*^9}, 
   3.8413222332344046`*^9, {3.8414140432904825`*^9, 3.8414140724559326`*^9}, {
   3.84141413690991*^9, 3.84141413740768*^9}, {3.8414142297267976`*^9, 
   3.841414240079482*^9}, {3.841414549010152*^9, 3.8414145504451213`*^9}, {
   3.8414146901179533`*^9, 3.8414146986307*^9}, {3.841415020445265*^9, 
   3.841415021414605*^9}, {3.8430474058140574`*^9, 3.843047448725752*^9}, {
   3.84367389883642*^9, 3.843673905167404*^9}, {3.843675682137754*^9, 
   3.843675684292006*^9}, 3.8437485674067793`*^9, {3.8437487258149405`*^9, 
   3.843748726711255*^9}, {3.8437526740847363`*^9, 3.843752682484831*^9}, {
   3.8437546371842413`*^9, 3.8437546374028807`*^9}, {3.843754674012761*^9, 
   3.843754739857795*^9}, 3.8437553466508884`*^9, 3.8438322358191843`*^9, {
   3.843833973504225*^9, 3.8438340019471693`*^9}, {3.843834062048588*^9, 
   3.8438341209426413`*^9}, 3.8438349655313034`*^9, {3.843853729551586*^9, 
   3.8438537299624414`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"92b9953a-3f65-4581-92ba-aa1b6d592b38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "see", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"seePlot", "[", 
   RowBox[{"p", ",", "5", ",", 
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2"}], "}"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", "m", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8363995323142886`*^9, 3.8363995497959876`*^9}, {
   3.836399619173401*^9, 3.836399627315104*^9}, {3.8384848657173834`*^9, 
   3.8384848695138836`*^9}, {3.8400640901794996`*^9, 3.840064096563566*^9}, 
   3.8400642190695267`*^9, 3.840064254160406*^9, 3.8400643231875253`*^9, 
   3.8400671534853387`*^9, 3.840067289625275*^9, 3.840067719035468*^9, 
   3.8400678437352333`*^9, 3.840067979214921*^9, 3.840068024446211*^9, 
   3.8400681171252265`*^9, {3.8400681524745507`*^9, 3.840068183426964*^9}, {
   3.8400682390152364`*^9, 3.8400682603653374`*^9}, 3.8400703249464455`*^9, {
   3.840070381556637*^9, 3.8400703854466133`*^9}, 3.8400705520194263`*^9, {
   3.84019115414285*^9, 3.840191221424403*^9}, 3.840280708155969*^9, 
   3.8402807658886623`*^9, {3.840280821326911*^9, 3.8402808379807625`*^9}, 
   3.8402809199145455`*^9, {3.8405485709314113`*^9, 3.8405485739471397`*^9}, 
   3.8413207591374435`*^9, {3.8413208116846724`*^9, 3.8413208985881786`*^9}, {
   3.843153463279521*^9, 3.843153469118759*^9}, {3.8436756974695063`*^9, 
   3.8436757009951077`*^9}, {3.843748733032687*^9, 3.8437487368004684`*^9}, 
   3.843752705032522*^9, 3.843833456936058*^9},
 CellLabel->"In[47]:=",ExpressionUUID->"9f5e2abd-c86d-409d-b148-1edc64ec627b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics for All pixels", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431519453413677`*^9, 
  3.8431519506391954`*^9}},ExpressionUUID->"48df32ca-fd60-406d-8945-\
a49b0001894a"],

Cell[CellGroupData[{

Cell["All Pixel Graphics", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9, {3.842703573534071*^9, 3.8427035807603846`*^9}, {
   3.843053597749626*^9, 
   3.84305360317021*^9}},ExpressionUUID->"155883ba-978a-41a6-93c7-\
b6d9e5f422e9"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"c9b86259-19bb-47f6-b975-\
2475f6a3f617"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tes1", "=", 
   RowBox[{"lineTest", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "line1", "]"}]}], "]"}], ",", 
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "0.001", ",", 
     "noteBookMode"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"seeAllLine", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "30"}], "]"}], ",", 
   RowBox[{"pyrf12", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", "0.001", ",", 
   "noteBookMode"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8430541726603727`*^9, 3.8430542426021805`*^9}, {
   3.8430542768852186`*^9, 3.843054302157134*^9}, {3.843054883911598*^9, 
   3.843054892362711*^9}, {3.843675061980145*^9, 3.843675066076097*^9}, 
   3.843675916016576*^9, {3.8437488485031247`*^9, 3.843748850201047*^9}, 
   3.843749691364495*^9, {3.8437501069007096`*^9, 3.8437501071598454`*^9}, {
   3.8437524967568636`*^9, 3.843752505823826*^9}, {3.8437527308973703`*^9, 
   3.843752736972122*^9}, 3.8437533329129972`*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"1bfb77de-7d5d-48b9-b030-f47911106b61"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics for One pixel", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431519453413677`*^9, 
  3.8431519506391954`*^9}, {3.843758114814825*^9, 
  3.8437581174592934`*^9}},ExpressionUUID->"442894b3-418d-4bc4-b4db-\
12b253b50133"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Function", " ", "to", " ", "find", " ", "solutions", " ", "for", " ", 
    "all", " ", "levels", " ", "of", " ", "pyramid", " ", 
    RowBox[{"{", 
     RowBox[{"l1", ",", "l2", ",", "l3", ",", "l4", ",", "..."}], "}"}], " ", 
    "or", " ", 
    RowBox[{"{", "l1", "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"number", " ", "of", " ", "iterations"}], ",", " ", 
      RowBox[{"pixel", " ", "of", " ", "interests"}], ",", " ", 
      "pyrfunctions", ",", "threshold"}], " "}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"v1", ",", " ", "v2", ",", "status"}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"PyrFlow1DIter", "[", 
     RowBox[{
     "i_", ",", " ", "p0_", ",", "v0_", ",", " ", "pyrfunctions_", ",", 
      "threshold_", ",", "\"\<ConstrainedInitialSign\>\""}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "v1", ",", " ", "v2", ",", "c", ",", "status", ",", "iterTable", ",", 
        "updateValues"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c", "=", 
         RowBox[{"Length", "[", "pyrfunctions", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"{", 
          RowBox[{
          "v1", ",", " ", "v2", ",", " ", "status", ",", " ", "e", ",", " ", 
           "dv1sign", ",", " ", "dv2sign"}], "}"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"updateValues", "=", 
         RowBox[{"{", 
          RowBox[{
          "0.", ",", "0.", ",", "\"\<ok\>\"", ",", "0.", ",", "0.", ",", 
           "0."}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"compute", " ", "at", " ", "this", " ", "scale"}], ",", 
           " ", 
           RowBox[{
           "using", " ", "current", " ", "motion", " ", "estimate"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "<", "2"}], ",", 
             RowBox[{
              RowBox[{"updateValues", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", "\"\<ok\>\""}], ",", 
             RowBox[{"updateValues", "=", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0.", ",", 
                RowBox[{"updateValues", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", "2.", ",", "0."}], 
               "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"iterTable", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"updateValues", "=", 
                RowBox[{"PyrUpgrade1D", "[", 
                 RowBox[{"updateValues", ",", "p0", ",", " ", 
                  RowBox[{"pyrfunctions", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "f"}], "]"}], "]"}], ",", 
                  RowBox[{"threshold", "*", 
                   RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "c"}], "+", "1"}], ")"}]}]}], ",", 
                  "\"\<ConstrainedInitialSign\>\""}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"updateValues", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "+", 
                  RowBox[{"updateValues", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"updateValues", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", 
                  RowBox[{"updateValues", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"updateValues", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"i", "*", "2"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"c", "=", 
            RowBox[{"c", "-", "1"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "iterTable"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "1", ",", 
            RowBox[{"Length", "[", "pyrfunctions", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.836395257636574*^9, 3.836395272859167*^9}, {
   3.83708196322594*^9, 3.8370820062598658`*^9}, {3.837083182655498*^9, 
   3.8370832734823055`*^9}, {3.8370843532979484`*^9, 
   3.8370843675088606`*^9}, {3.838080701244558*^9, 3.8380807259152684`*^9}, {
   3.838080793823208*^9, 3.8380808755938196`*^9}, {3.8380809401222954`*^9, 
   3.838080942274747*^9}, 3.8380810086446276`*^9, {3.8380816063631763`*^9, 
   3.8380816393331475`*^9}, {3.8380820470151634`*^9, 
   3.8380820558435106`*^9}, {3.8380823886542034`*^9, 
   3.8380824062240515`*^9}, {3.8380824773647776`*^9, 
   3.8380825736331425`*^9}, {3.8380826279050765`*^9, 3.838082713503049*^9}, {
   3.8380828471635237`*^9, 3.8380828901935434`*^9}, {3.83848262336782*^9, 
   3.8384826483396864`*^9}, {3.838483209637656*^9, 3.838483252891429*^9}, {
   3.83848337672888*^9, 3.838483389713195*^9}, 3.8384834622891912`*^9, {
   3.838483925470047*^9, 3.838483959825934*^9}, 3.8384839932092*^9, {
   3.8384840245223246`*^9, 3.83848406745443*^9}, {3.8384841090878415`*^9, 
   3.838484119135103*^9}, {3.8384842940787163`*^9, 3.8384842965189843`*^9}, {
   3.838484331536871*^9, 3.838484376855281*^9}, {3.8384844316993575`*^9, 
   3.8384844364710684`*^9}, {3.838484472533862*^9, 3.838484496768239*^9}, {
   3.838484653516262*^9, 3.8384846980991325`*^9}, 3.8384847407136316`*^9, {
   3.838484789836351*^9, 3.838484836358838*^9}, {3.838485707284088*^9, 
   3.838485708317006*^9}, {3.838745304433283*^9, 3.838745304748513*^9}, 
   3.8387454287233124`*^9, {3.838745566958905*^9, 3.838745572968202*^9}, {
   3.838832480835082*^9, 3.8388324858883576`*^9}, 3.838832662601839*^9, 
   3.8400444674100447`*^9, {3.840044657898258*^9, 3.840044675080756*^9}, {
   3.840044792234081*^9, 3.8400448028818226`*^9}, {3.840045382891678*^9, 
   3.8400454107116804`*^9}, {3.8400457742282677`*^9, 3.840045782682536*^9}, {
   3.840046004923623*^9, 3.840046009099416*^9}, 3.8400460619888587`*^9, {
   3.8400460949919004`*^9, 3.84004610011978*^9}, {3.8400461438186865`*^9, 
   3.8400461690448275`*^9}, {3.8400536215227985`*^9, 
   3.8400536593035183`*^9}, {3.840053705946847*^9, 3.840053723757249*^9}, {
   3.8400537835503826`*^9, 3.8400538050647817`*^9}, {3.8400538490526533`*^9, 
   3.840053877267029*^9}, {3.840054015361252*^9, 3.840054050881156*^9}, 
   3.8400541211876483`*^9, {3.840054841363824*^9, 3.840054842590229*^9}, {
   3.8400548774584274`*^9, 3.8400548954699373`*^9}, 3.840062489108899*^9, {
   3.8400625230755796`*^9, 3.8400625357077594`*^9}, {3.840062608567613*^9, 
   3.840062609225909*^9}, 3.840064282796586*^9, {3.840064347610565*^9, 
   3.8400643514241934`*^9}, {3.840064435863537*^9, 3.840064436038506*^9}, {
   3.840066248372734*^9, 3.8400662514900155`*^9}, {3.8400664641163483`*^9, 
   3.8400664688160753`*^9}, 3.8400666848661065`*^9, {3.8400668057053223`*^9, 
   3.8400668205868874`*^9}, {3.8400669375243015`*^9, 3.840067029056565*^9}, {
   3.8400670665699735`*^9, 3.8400670668913956`*^9}, {3.8400673521968985`*^9, 
   3.840067373037039*^9}, {3.8400674925370984`*^9, 3.840067499815276*^9}, {
   3.8400676885764246`*^9, 3.8400676914667573`*^9}, {3.840067767866358*^9, 
   3.840067799215399*^9}, {3.8400678334141483`*^9, 3.840067834605913*^9}, {
   3.8400678737948313`*^9, 3.840067881587015*^9}, {3.840067987954644*^9, 
   3.840067988566532*^9}, {3.8400687429367623`*^9, 3.8400688146563964`*^9}, 
   3.8400688885471363`*^9, {3.8400690624252715`*^9, 3.8400690763966675`*^9}, {
   3.840069180186268*^9, 3.84006918878432*^9}, {3.8400699684665527`*^9, 
   3.840070030673232*^9}, {3.840070069194943*^9, 3.840070130021838*^9}, {
   3.8400702050033846`*^9, 3.840070295059636*^9}, {3.8400703424521255`*^9, 
   3.8400703701890373`*^9}, {3.840070536126915*^9, 3.840070543162916*^9}, {
   3.8400707194066267`*^9, 3.840070723381528*^9}, {3.840071016027475*^9, 
   3.840071035148421*^9}, 3.840071082957506*^9, {3.8400711294374886`*^9, 
   3.8400712078568583`*^9}, {3.8400720622403393`*^9, 3.840072062449636*^9}, {
   3.8400725161957693`*^9, 3.8400725194734535`*^9}, {3.840190301254188*^9, 
   3.840190369112875*^9}, {3.840190421163118*^9, 3.840190483558923*^9}, {
   3.8401905169341288`*^9, 3.8401905686044073`*^9}, {3.840190665069972*^9, 
   3.840190691093354*^9}, {3.840190764716844*^9, 3.840190909552351*^9}, {
   3.840190952571726*^9, 3.840190994597392*^9}, 3.840191052489993*^9, {
   3.84019109858766*^9, 3.840191106858177*^9}, {3.840212643647187*^9, 
   3.8402126587042575`*^9}, {3.840212948316355*^9, 3.840213092874155*^9}, {
   3.8402131666079383`*^9, 3.8402131696129346`*^9}, {3.8402143027437525`*^9, 
   3.8402143267459517`*^9}, {3.8402804561573114`*^9, 3.840280523225045*^9}, {
   3.8402809376168385`*^9, 3.840280971021533*^9}, {3.8402849953143473`*^9, 
   3.840284995539066*^9}, {3.840285203246116*^9, 3.8402852211954503`*^9}, {
   3.8405484745807753`*^9, 3.840548502614027*^9}, {3.840548682116254*^9, 
   3.8405486958534555`*^9}, {3.8405779593968954`*^9, 
   3.8405779632643437`*^9}, {3.841320470752817*^9, 3.8413204988403115`*^9}, 
   3.843047234386615*^9, 3.8430472681286163`*^9, {3.84304837339767*^9, 
   3.8430484122480726`*^9}, {3.8430489408235273`*^9, 
   3.8430489753452682`*^9}, {3.8431533802072535`*^9, 3.843153400508676*^9}, {
   3.843154934308928*^9, 3.8431552055729947`*^9}, {3.843673779979858*^9, 
   3.843673789025011*^9}, 3.843673852135035*^9, {3.843674526555189*^9, 
   3.843674537257772*^9}, {3.843674794777981*^9, 3.8436747954682493`*^9}, {
   3.843675843849382*^9, 3.843675846572392*^9}, {3.843676285948403*^9, 
   3.843676311895507*^9}, {3.8437483660430927`*^9, 3.843748369909861*^9}, {
   3.843748466865801*^9, 3.843748496811301*^9}, {3.8437485324572587`*^9, 
   3.843748532728025*^9}, {3.8437524869653664`*^9, 3.8437524904354153`*^9}, {
   3.84375262295919*^9, 3.8437526282741756`*^9}, {3.8437534026858854`*^9, 
   3.8437534055344925`*^9}, {3.8437581420635324`*^9, 3.843758143053544*^9}, {
   3.843758386780986*^9, 3.8437584076658106`*^9}, {3.843758459073492*^9, 
   3.8437585931004405`*^9}, {3.84375993122773*^9, 3.843759941699638*^9}, {
   3.8437617332613707`*^9, 3.8437617485600877`*^9}, {3.8437617824128203`*^9, 
   3.843761891345723*^9}, {3.843834362022087*^9, 3.8438344150614185`*^9}, {
   3.8438345567901006`*^9, 3.8438346039124*^9}, {3.843835076663509*^9, 
   3.8438350769760375`*^9}, {3.84384927747968*^9, 3.8438492805985184`*^9}, {
   3.843849390184264*^9, 3.8438493904102345`*^9}, {3.8438507300249376`*^9, 
   3.8438507319495664`*^9}, {3.8438529975555964`*^9, 
   3.8438529995112753`*^9}, {3.843854116314721*^9, 3.8438541398282475`*^9}, {
   3.844259999298771*^9, 3.8442600013136473`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"c9b76b1a-1222-44a6-8150-b11ad5d9db43"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"9500677b-47ae-454e-a7fa-\
d33ab1ac2f88"],

Cell[BoxData[
 RowBox[{"iter", "=", 
  RowBox[{"PyrFlow1DIter", "[", 
   RowBox[{"10", ",", " ", "11", ",", 
    RowBox[{"{", 
     RowBox[{"0.", ",", "0."}], "}"}], ",", " ", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", 
      RowBox[{"1", " ", ";;", "3"}], "]"}], "]"}], ",", "0.001", ",", 
    "noteBookMode"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.8427011171311693`*^9, {3.8427011579256897`*^9, 3.8427011722779355`*^9}, {
   3.842701297457902*^9, 3.8427012976177683`*^9}, 3.842702107395807*^9, {
   3.842702956024593*^9, 3.8427029573174276`*^9}, {3.843674018607419*^9, 
   3.843674022402357*^9}, {3.843678971174404*^9, 3.8436790129068117`*^9}, 
   3.8437586436966314`*^9, {3.8437586845840893`*^9, 3.8437586855190554`*^9}, 
   3.8437618402596893`*^9, 3.8437618985421076`*^9, {3.843834619168625*^9, 
   3.843834632287681*^9}, 3.843849361597576*^9, {3.8438507365290756`*^9, 
   3.843850739632452*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"da479219-da0c-4c71-833a-5e483d5120da"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{958.5, 741.},
WindowMargins->{{Automatic, -5.25}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>0.85 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"22fbbe29-5702-4af0-a979-80bb27605aa4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 533, 8, 83, "Title",ExpressionUUID->"7afc5b65-0b5e-4320-8af8-efa1ad27aa25"],
Cell[1116, 32, 479, 9, 24, "Input",ExpressionUUID->"d6613b5f-169d-4924-a7bf-e1328c874886"],
Cell[1598, 43, 590, 16, 42, "Input",ExpressionUUID->"41e1c256-78cb-4820-90cf-01209722e819"],
Cell[2191, 61, 535, 8, 42, "Input",ExpressionUUID->"8671407a-4f01-418c-b8d5-eb14191aec4b"],
Cell[2729, 71, 519, 10, 24, "Input",ExpressionUUID->"d1bc8fcf-74b6-4b1d-a5a8-1732c355759d"],
Cell[CellGroupData[{
Cell[3273, 85, 337, 5, 57, "Section",ExpressionUUID->"49cdbca1-85b1-42e3-a9fb-95cdbab14151"],
Cell[3613, 92, 2440, 58, 136, "Input",ExpressionUUID->"63e606eb-af9d-4b38-8042-9c69524c2133"],
Cell[6056, 152, 2143, 63, 136, "Input",ExpressionUUID->"26805c80-4731-40a2-851e-420a0b82d2d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[8236, 220, 219, 4, 46, "Section",ExpressionUUID->"18e1ac0b-2e67-4ae4-85a8-851f071e6799"],
Cell[CellGroupData[{
Cell[8480, 228, 162, 3, 46, "Subsection",ExpressionUUID->"4d85132e-f9aa-4886-993d-13ba7706c410"],
Cell[8645, 233, 33729, 720, 1946, "Input",ExpressionUUID->"4fdc4427-ab7c-4822-8290-a142d2bfc29e",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[42411, 958, 191, 3, 45, "Subsection",ExpressionUUID->"ae9c1c19-996f-4736-a4d8-9d1e6e3e2062"],
Cell[42605, 963, 1587, 33, 76, "Input",ExpressionUUID->"8afbc134-2a96-4829-a98d-261227ff5001"],
Cell[44195, 998, 498, 9, 42, "Input",ExpressionUUID->"df917fe6-c171-4677-bfcd-46b626c18e59"],
Cell[44696, 1009, 2408, 45, 76, "Input",ExpressionUUID->"9aa1df55-4b50-4c69-af76-58c3366fca58"],
Cell[47107, 1056, 1158, 21, 42, "Input",ExpressionUUID->"8ac72149-7774-43cb-be5f-c0e6e76366d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48302, 1082, 182, 3, 46, "Subsection",ExpressionUUID->"9476c611-cedb-4e14-b4f1-a7f3e4e663c4"],
Cell[48487, 1087, 212, 5, 29, "Text",ExpressionUUID->"dc51e695-7873-4d23-8fd3-56cf6235c000"],
Cell[48702, 1094, 14296, 260, 731, "Input",ExpressionUUID->"2ba813e8-f4d4-445d-9ef4-e02d9a926ee0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[63023, 1358, 182, 3, 39, "Subsubsection",ExpressionUUID->"ba5cc455-fcf1-4e82-9c11-345ce239926d"],
Cell[63208, 1363, 240, 6, 29, "Text",ExpressionUUID->"d665bf0a-b30b-44e3-a00d-ac5233747928"],
Cell[63451, 1371, 4109, 83, 211, "Input",ExpressionUUID->"92b9953a-3f65-4581-92ba-aa1b6d592b38"],
Cell[67563, 1456, 1548, 25, 42, "Input",ExpressionUUID->"9f5e2abd-c86d-409d-b148-1edc64ec627b"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69172, 1488, 275, 4, 57, "Section",ExpressionUUID->"48df32ca-fd60-406d-8945-a49b0001894a"],
Cell[CellGroupData[{
Cell[69472, 1496, 292, 5, 46, "Subsection",ExpressionUUID->"155883ba-978a-41a6-93c7-b6d9e5f422e9"],
Cell[CellGroupData[{
Cell[69789, 1505, 182, 3, 39, "Subsubsection",ExpressionUUID->"c9b86259-19bb-47f6-b975-2475f6a3f617"],
Cell[69974, 1510, 1216, 27, 42, "Input",ExpressionUUID->"1bfb77de-7d5d-48b9-b030-f47911106b61"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71251, 1544, 325, 5, 57, "Section",ExpressionUUID->"442894b3-418d-4bc4-b4db-12b253b50133"],
Cell[71579, 1551, 11905, 214, 444, "Input",ExpressionUUID->"c9b76b1a-1222-44a6-8150-b11ad5d9db43",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[83509, 1769, 182, 3, 39, "Subsubsection",ExpressionUUID->"9500677b-47ae-454e-a7fa-d33ab1ac2f88"],
Cell[83694, 1774, 989, 19, 24, "Input",ExpressionUUID->"da479219-da0c-4c71-833a-5e483d5120da"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

