(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     69883,       1623]
NotebookOptionsPosition[     63862,       1513]
NotebookOutlinePosition[     64436,       1534]
CellTagsIndexPosition[     64393,       1531]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Pyramidal Cyclope 1D (SemiConstrainted)", "Title",
 CellChangeTimes->{{3.832408884851491*^9, 3.83240890773357*^9}, {
  3.8328619391991744`*^9, 3.8328619410067196`*^9}, {3.8363940054558916`*^9, 
  3.8363940275291505`*^9}, {3.840280041419174*^9, 3.840280042503207*^9}, {
  3.8405480171717796`*^9, 3.8405480257182446`*^9}, {3.8430497179919558`*^9, 
  3.8430497185855436`*^9}, {3.843155987985685*^9, 
  3.8431559886182976`*^9}},ExpressionUUID->"76329b2f-faa1-4991-b7bc-\
3f37e4fd90db"],

Cell["\<\
Model where we update solutions anytime possible through scale iteration.
The undefined value will be cero.\
\>", "Text",
 CellChangeTimes->{{3.840547707465996*^9, 3.8405477559767013`*^9}, {
   3.840548923268324*^9, 3.8405489243477573`*^9}, {3.8405489729205017`*^9, 
   3.840548984338951*^9}, 
   3.843048698556714*^9},ExpressionUUID->"e540e878-50f7-487d-9812-\
829d0d84e570"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",\

 CellChangeTimes->{
  3.832189670547576*^9, {3.8372610411417527`*^9, 3.837261053402938*^9}, 
   3.8372611225950527`*^9, {3.8431521762677693`*^9, 3.8431521765291877`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d6613b5f-169d-4924-a7bf-e1328c874886"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"packageDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<*\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Path", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"$Path", ",", 
     RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8431516160201325`*^9, 3.843151637488711*^9}, {
  3.843675966109468*^9, 3.843675971562093*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b4f7a231-7676-48b5-8f20-01e7af950631"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Package", " ", "to", " ", "obtain", " ", "the", " ", "pyramidal", " ", 
    "representation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
   RowBox[{"<<", "\"\<pyramidalCyclope1DLK`\>\""}]}]}]], "Input",
 CellChangeTimes->{{3.836396430700433*^9, 3.836396440553816*^9}, {
   3.836396483243249*^9, 3.836396483782277*^9}, {3.8363965197501154`*^9, 
   3.8363965208316736`*^9}, 3.8363965992226734`*^9, {3.843048630635351*^9, 
   3.843048631557007*^9}, {3.843675996855527*^9, 3.843675997300641*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"8671407a-4f01-418c-b8d5-eb14191aec4b"],

Cell[CellGroupData[{

Cell["Test Points {line1, line2, pyrf12}", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431530928617816`*^9, 
  3.8431531095074196`*^9}, {3.8431536160653305`*^9, 
  3.843153621995445*^9}},ExpressionUUID->"1de7d95c-4776-46ae-8af3-\
331fe1c87c24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "We", " ", "create", " ", "test", " ", "points", " ", "for", " ", 
    "compilation", " ", "test"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"line1", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"11", "<=", " ", "p", "<=", "18"}], ",", "1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "1", ",", "30"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"line2", "=", 
     RowBox[{"GaussianFilter", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"11", "<=", " ", "p", "<=", "18"}], ",", "1", ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", 
           RowBox[{"1", "-", "1"}], ",", 
           RowBox[{"30", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"line1", ",", " ", "line2"}], "}"}], ",", 
     RowBox[{"Joined", "->", "True"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
     RowBox[{"PlotRange", "->", "All"}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", "\"\<Test Points\>\""}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<ia\>\"", ",", "\"\<ib\>\""}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.832269136912603*^9, 3.8322691462380075`*^9}, {
   3.8324089382989807`*^9, 3.832408951506154*^9}, {3.8324104077397842`*^9, 
   3.832410511519393*^9}, 3.832410602016293*^9, {3.832410661166127*^9, 
   3.832410748366403*^9}, {3.832411297859131*^9, 3.832411301951344*^9}, {
   3.836395098441699*^9, 3.836395118010255*^9}, {3.836396148580798*^9, 
   3.836396159588914*^9}, {3.836396194334372*^9, 3.8363962079578047`*^9}, {
   3.836398891705703*^9, 3.836398893325742*^9}, {3.8365003825221486`*^9, 
   3.83650041642003*^9}, {3.8402800509000998`*^9, 3.840280051642571*^9}, {
   3.8430474630811205`*^9, 3.843047543816728*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"7f413bb8-506f-4434-8ffe-4a139a612f2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "functions", " ", "of", " ", "pyramid", " ", "with", " ", 
    "pyrFuncGen"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"original", " ", "points"}], ",", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "functions", " ", "f", " ", "and", " ", "df", " ", "for", " ", "n"}], 
      "+", 
      RowBox[{"1", " ", "levels"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pyrf1", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line1", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf2", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line2", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf12", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pyrf1", ",", " ", "pyrf2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], 
        ",", 
        RowBox[{
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "2", ",", "1"}], "]"}], "]"}], "[", "x", "]"}]}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", "30"}], "}"}]}], "]"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{3.8431536109231205`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"1f6b702f-16ce-4ee0-8ccd-161a2fb6f757"]
}, Closed]],

Cell[CellGroupData[{

Cell["Pyramidal Flow 1D", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 
  3.8363952460112877`*^9}},ExpressionUUID->"18e1ac0b-2e67-4ae4-85a8-\
851f071e6799"],

Cell[CellGroupData[{

Cell["PyrUpgrade1D", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 
  3.8363959796401834`*^9}},ExpressionUUID->"4d85132e-f9aa-4886-993d-\
13ba7706c410"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"initial", " ", "values", " ", "for", " ", "v1"}], ",", " ", 
        RowBox[{"v2", " ", "and", " ", "status"}]}], "}"}], ",", " ", 
      RowBox[{"pixel", " ", "of", " ", "interest"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"functions", " ", "f1"}], ",", " ", "df1", ",", " ", "f2", 
        ",", " ", "df2"}], "}"}], ",", " ", 
      RowBox[{"threshold", " ", "for", " ", "magnitude", " ", "error"}]}], 
     "}"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"new", " ", "values", " ", "for", " ", "v1"}], ",", " ", 
      RowBox[{"v2", " ", "and", " ", "status"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "status_", ",", "e_"}], "}"}], ",", 
       "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<SemiConstrained\>\""}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "p1", ",", " ", "p2", ",", " ", "c", ",", "d1", ",", "d2", ",", "dv1",
          ",", "dv2"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"p0", "-", "v1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{"p0", "+", "v2"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"c", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"fline1", "[", "p0", "]"}], "+", 
             RowBox[{"fline2", "[", "p0", "]"}]}], ")"}], "/", "2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d1", "=", 
          RowBox[{"dfline1", "[", "p1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"d2", "=", 
          RowBox[{"dfline2", "[", "p2", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "d1", " ", "and", " ", "d2", " ", "have", " ", "to", " ", "be", " ",
            "the", " ", "same", " ", "sign", " ", "in", " ", "every", " ", 
           "iteration"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"d1", "*", "d2"}], " ", "<", "0"}], ",", " ", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "v2", ",", "\"\<sign\>\"", ",", "e"}], "}"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "magnitude", " ", "needs", " ", "to", " ", "be", " ", "bigger", " ",
            "than", " ", "threshold", " ", "every", " ", "iteration"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", "d1", "]"}], "<", "threshold"}], "||", 
             RowBox[{
              RowBox[{"Abs", "[", "d2", "]"}], "<", "threshold"}]}], " ", 
            ")"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "v2", ",", "\"\<mag\>\"", ",", "e"}], "}"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Change", " ", "of", " ", "sign", " ", "during", " ", "iteration"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"dfline1", "[", "p0", "]"}], "*", "d1"}], "<", "0"}], "||", 
             RowBox[{
              RowBox[{
               RowBox[{"dfline2", "[", "p0", "]"}], "*", "d2"}], "<", "0"}]}],
             ")"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"v1", ",", "v2", ",", "\"\<flip\>\"", ",", "e"}], "}"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"dv1", ",", 
           RowBox[{"dv2", " ", ":", " ", 
            RowBox[{"step", " ", "from", " ", "last", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}], " ", "to", " ", "new", " ", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dv1", ",", "dv2"}], "}"}], "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"fline1", "[", "p1", "]"}], "-", "c"}], ")"}], "/", 
             "d1"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "-", 
               RowBox[{"fline2", "[", "p2", "]"}]}], ")"}], "/", "d2"}]}], 
           "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"v1", "+", "dv1"}], ",", 
           RowBox[{"v2", "+", "dv2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"{", 
                RowBox[{"dv1", ",", "dv2"}], "}"}], "]"}], "<", "0.001"}], 
             ",", "\"\<converged\>\"", ",", "\"\<ok\>\""}], "]"}], ",", "e"}],
           "}"}]}], "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"status", ":", " ", "\"\<OK\>\""}], " ", "->", " ", 
      RowBox[{"solution", " ", "respects", " ", "constraints"}]}], ",", "  ", 
     
     RowBox[{"errors", ":", " ", "\"\<sign\>\""}], ",", " ", "\"\<mag\>\"", 
     ",", " ", "\"\<flip\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"status", ":", " ", "\"\<converged\>\""}], " ", "->", " ", 
     RowBox[{"we", " ", 
      RowBox[{"converged", "!!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "No", " ", "other", " ", "solution", " ", "will", " ", "be", " ", 
     "calculated", " ", "when", " ", "status", " ", "records", " ", "an", " ",
      "error", " ", "message"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "\"\<sign\>\"", ",", "e_"}], "}"}], 
       ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<SemiConstrained\>\""}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2", ",", "\"\<sign\>\"", ",", "e"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "\"\<mag\>\"", ",", "e_"}], "}"}], 
       ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<SemiConstrained\>\""}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2", ",", "\"\<mag\>\"", ",", "e"}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PyrUpgrade1D", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1_", ",", "v2_", ",", "\"\<flip\>\"", ",", "e_"}], "}"}], 
       ",", "p0_", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"fline1_", ",", "dfline1_"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"fline2_", ",", "dfline2_"}], "}"}]}], "}"}], ",", " ", 
       "threshold_", ",", "\"\<SemiConstrained\>\""}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2", ",", "\"\<flip\>\"", ",", "e"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8363952713646383`*^9, 3.836395285622998*^9}, {
   3.836395339420894*^9, 3.836395340499365*^9}, {3.8363960314026394`*^9, 
   3.83639606263406*^9}, {3.836488222237672*^9, 3.8364882261367626`*^9}, 
   3.836488794120328*^9, 3.8366473739266353`*^9, {3.8370817604645205`*^9, 
   3.837081837795313*^9}, {3.8370818949284244`*^9, 3.83708194197997*^9}, {
   3.8370842312798247`*^9, 3.8370843044170694`*^9}, 3.837084651677993*^9, {
   3.8370847210046616`*^9, 3.837084725007778*^9}, {3.8377956666920443`*^9, 
   3.8377956995724106`*^9}, {3.8377957498926754`*^9, 3.83779581642708*^9}, {
   3.8378749336691175`*^9, 3.837874935107934*^9}, {3.837875154862604*^9, 
   3.8378751613696737`*^9}, {3.838079285613141*^9, 3.8380792941631727`*^9}, {
   3.8380795418031816`*^9, 3.838079563444045*^9}, {3.8380797346993732`*^9, 
   3.8380797393432436`*^9}, {3.83807982197386*^9, 3.8380798582862535`*^9}, {
   3.8380805890530586`*^9, 3.838080591503376*^9}, {3.8380809576132145`*^9, 
   3.8380809678530693`*^9}, {3.838740908992169*^9, 3.838740950609075*^9}, {
   3.838832496708708*^9, 3.838832519171462*^9}, {3.8400446630563745`*^9, 
   3.840044714150585*^9}, 3.8400449264576254`*^9, {3.8400453571541862`*^9, 
   3.8400453654985714`*^9}, {3.8400456962038565`*^9, 3.840045715342576*^9}, {
   3.8400459309942083`*^9, 3.8400459656201653`*^9}, {3.8400668389960976`*^9, 
   3.840066846494582*^9}, {3.8401886870003967`*^9, 3.840188820046699*^9}, {
   3.840188896296138*^9, 3.840188925231366*^9}, {3.840188999652712*^9, 
   3.840189013444944*^9}, {3.840189096038698*^9, 3.8401891974523277`*^9}, {
   3.840189624170314*^9, 3.840189800290779*^9}, {3.840189958389654*^9, 
   3.8401900137831907`*^9}, 3.8402120639745617`*^9, {3.8402121216067257`*^9, 
   3.84021212708329*^9}, {3.8402122805477524`*^9, 3.840212286917535*^9}, 
   3.8402132864409337`*^9, {3.840213485572333*^9, 3.840213490367629*^9}, {
   3.840214015425631*^9, 3.8402140182491136`*^9}, 3.8402801476209807`*^9, 
   3.84028020940808*^9, {3.840281347776226*^9, 3.8402813646606426`*^9}, 
   3.8402849362643695`*^9, {3.840285277474245*^9, 3.8402852834041367`*^9}, {
   3.8402881918413506`*^9, 3.8402881935364695`*^9}, {3.8402918630085573`*^9, 
   3.8402918666426845`*^9}, {3.840535302919426*^9, 3.8405353122265525`*^9}, {
   3.840535355695983*^9, 3.8405353675596466`*^9}, {3.8405478262244816`*^9, 
   3.8405478282532935`*^9}, {3.84054786170028*^9, 3.8405479597319727`*^9}, {
   3.8405487500943556`*^9, 3.8405487530817695`*^9}, {3.840548890802074*^9, 
   3.840548895672971*^9}, {3.8405489566370993`*^9, 3.8405489677693124`*^9}, {
   3.840558898944503*^9, 3.840558919673791*^9}, {3.8405590751929426`*^9, 
   3.8405590905799665`*^9}, {3.8405786182601976`*^9, 
   3.8405786202723913`*^9}, {3.843048722176126*^9, 3.84304882158899*^9}, {
   3.8430488584862995`*^9, 3.843048859205057*^9}, {3.8430497467137966`*^9, 
   3.843049761663333*^9}, {3.8431560410031586`*^9, 3.8431560460054913`*^9}, {
   3.8432447561255207`*^9, 3.8432447669552584`*^9}, 3.843244839663809*^9, {
   3.8432450435696077`*^9, 3.84324505383434*^9}, {3.8432451037670264`*^9, 
   3.84324511177654*^9}, {3.843245290506007*^9, 3.8432452908053255`*^9}, {
   3.843673674989368*^9, 3.8436737074750557`*^9}, {3.8436760328446074`*^9, 
   3.843676033825618*^9}, {3.843676433604192*^9, 3.843676470522996*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a13d90b2-dea1-4b19-a655-f82fe55fa81b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Test", "Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"057490d3-59e3-4979-8857-\
b71daab20425"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "generate", " ", "levels", " ", "of", " ", "pyramid", " ", "with", " ", 
    "pyrFuncGen"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"original", " ", "points"}], ",", " ", 
      RowBox[{"number", " ", "of", " ", "levels"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
      "functions", " ", "f", " ", "and", " ", "df", " ", "for", " ", "n"}], 
      "+", 
      RowBox[{"1", " ", "levels"}]}], "}"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pyrf1", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line1", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf2", "=", 
     RowBox[{"pyrFuncGen", "[", 
      RowBox[{"line2", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pyrf12", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pyrf1", ",", " ", "pyrf2"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], 
        ",", 
        RowBox[{
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "2", ",", "1"}], "]"}], "]"}], "[", "x", "]"}]}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", "30"}], "}"}]}], "]"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.836396648130644*^9, 3.8363967311993866`*^9}, {
   3.8363988295079536`*^9, 3.836398880510977*^9}, 3.836399230446312*^9, {
   3.8400672559952717`*^9, 3.840067257876457*^9}, {3.8402800634269857`*^9, 
   3.8402800643649364`*^9}, {3.8414155445057583`*^9, 3.841415555839461*^9}, {
   3.8430488762819834`*^9, 3.84304888636779*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"984b118d-0285-4cf5-b45c-d8a67865e6d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"initial", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "v2"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"status", "=", "\"\<ok\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", "13"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8363961378588843`*^9, {3.8363967443857393`*^9, 3.8363967528759184`*^9}, {
   3.8363968389271307`*^9, 3.8363968394458265`*^9}, 3.8363986080928793`*^9, {
   3.8363995877529974`*^9, 3.8363995880494523`*^9}, {3.8401892506832857`*^9, 
   3.840189256145101*^9}, {3.8430489008487344`*^9, 3.843048901754769*^9}, {
   3.8436766174388113`*^9, 3.843676642518906*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"e8a19c3b-7ce4-41c9-9e2b-b6be0c488e6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Manual", " ", "test", " ", "only", " ", "of", " ", "lvl", " ", "n"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], "=", 
    RowBox[{"PyrUpgrade1D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2", ",", "status", ",", "0"}], "}"}], ",", "p", 
      ",", " ", 
      RowBox[{"pyrf12", "[", 
       RowBox[{"[", "n", "]"}], "]"}], ",", "0.01", ",", 
      "\"\<SemiConstrained\>\""}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8363967651550703`*^9, 3.8363968130279603`*^9}, {
   3.836396853335551*^9, 3.8363968558471217`*^9}, {3.836398527992988*^9, 
   3.836398541330168*^9}, {3.836399044228342*^9, 3.8363990495392766`*^9}, {
   3.836399208159257*^9, 3.8363992132916665`*^9}, {3.8400458463150663`*^9, 
   3.8400458889085207`*^9}, 3.8400459372136974`*^9, {3.8400459743200526`*^9, 
   3.840045979480372*^9}, {3.840189232799335*^9, 3.840189243506825*^9}, 
   3.8402145895445347`*^9, 3.8402800323364515`*^9, 3.840280121570874*^9, 
   3.840280181640683*^9, {3.840280221138157*^9, 3.8402802307424874`*^9}, {
   3.840280262614027*^9, 3.840280329574231*^9}, 3.840548072388741*^9, {
   3.841415635193651*^9, 3.84141565117542*^9}, {3.843048907815837*^9, 
   3.843048908784094*^9}, {3.843676483784803*^9, 3.843676487506768*^9}, {
   3.843676595348319*^9, 3.8436765993629007`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"8e2e9166-e587-42d9-a494-f7bdc0bc8ffa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"seePlot", "[", 
   RowBox[{"p", ",", "2", ",", 
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2"}], "}"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", "n", "]"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8363983430106754`*^9, 3.8363983604496603`*^9}, {
   3.8363989657393045`*^9, 3.8363989940990686`*^9}, {3.836399252495593*^9, 
   3.836399458153307*^9}, 3.840214598251926*^9, 3.8402801272137938`*^9, {
   3.8402801885832624`*^9, 3.840280253201376*^9}, {3.840280283420054*^9, 
   3.8402803342978687`*^9}, 3.84054808258837*^9, 3.841415643451585*^9, {
   3.843676604479568*^9, 3.843676604856051*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"98c7f0d8-9bb8-43a4-9b19-323d9cc80ddb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["PyrFlow1D", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9},ExpressionUUID->"9476c611-cedb-4e14-b4f1-\
a7f3e4e663c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Input", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"number", " ", "of", " ", "iterations"}], ",", " ", 
      RowBox[{"pixel", " ", "of", " ", "interests"}], ",", " ", 
      "pyrfunctions", ",", "threshold"}], " "}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Output", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{"v1", ",", " ", "v2", ",", "status", ",", "e"}], "}"}]}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PyrFlow1D", "[", 
      RowBox[{
      "i_", ",", " ", "p0_", ",", " ", "pyrfunctions_", ",", "threshold_", 
       ",", "\"\<SemiConstrained\>\""}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1", ",", " ", "v2", ",", "c", ",", "d", ",", "dd", ",", "cc", ",", 
         "status", ",", "e"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"Length", "[", "pyrfunctions", "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0."}], "}"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"compute", " ", "at", " ", "this", " ", "scale"}], ",", 
            " ", 
            RowBox[{
            "using", " ", "current", " ", "motion", " ", "estimate"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], "=", 
             
             RowBox[{"Nest", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"PyrUpgrade1D", "[", 
                 RowBox[{"#", ",", "p0", ",", " ", 
                  RowBox[{"pyrfunctions", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "f"}], "]"}], "]"}], ",", 
                  RowBox[{"threshold", "*", 
                   RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "c"}], "+", "1"}], ")"}]}]}], ",", 
                  "\"\<SemiConstrained\>\""}], "]"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"v1", ",", "v2", ",", "\"\<ok\>\"", ",", "0"}], "}"}],
                ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"c", "=", 
             RowBox[{"c", "-", "1"}]}]}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"f", ",", "1", ",", 
             RowBox[{"Length", "[", "pyrfunctions", "]"}]}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"v1", ",", " ", "v2", ",", "status", ",", "0"}], "}"}]}], 
        "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], "\n"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.836395257636574*^9, 3.836395272859167*^9}, {
   3.83708196322594*^9, 3.8370820062598658`*^9}, {3.837083182655498*^9, 
   3.8370832734823055`*^9}, {3.8370843532979484`*^9, 
   3.8370843675088606`*^9}, {3.838080701244558*^9, 3.8380807259152684`*^9}, {
   3.838080793823208*^9, 3.8380808755938196`*^9}, {3.8380809401222954`*^9, 
   3.838080942274747*^9}, 3.8380810086446276`*^9, {3.8380816063631763`*^9, 
   3.8380816393331475`*^9}, {3.8380820470151634`*^9, 
   3.8380820558435106`*^9}, {3.8380823886542034`*^9, 
   3.8380824062240515`*^9}, {3.8380824773647776`*^9, 
   3.8380825736331425`*^9}, {3.8380826279050765`*^9, 3.838082713503049*^9}, {
   3.8380828471635237`*^9, 3.8380828901935434`*^9}, {3.83848262336782*^9, 
   3.8384826483396864`*^9}, {3.838483209637656*^9, 3.838483252891429*^9}, {
   3.83848337672888*^9, 3.838483389713195*^9}, 3.8384834622891912`*^9, {
   3.838483925470047*^9, 3.838483959825934*^9}, 3.8384839932092*^9, {
   3.8384840245223246`*^9, 3.83848406745443*^9}, {3.8384841090878415`*^9, 
   3.838484119135103*^9}, {3.8384842940787163`*^9, 3.8384842965189843`*^9}, {
   3.838484331536871*^9, 3.838484376855281*^9}, {3.8384844316993575`*^9, 
   3.8384844364710684`*^9}, {3.838484472533862*^9, 3.838484496768239*^9}, {
   3.838484653516262*^9, 3.8384846980991325`*^9}, 3.8384847407136316`*^9, {
   3.838484789836351*^9, 3.838484836358838*^9}, {3.838485707284088*^9, 
   3.838485708317006*^9}, {3.838745304433283*^9, 3.838745304748513*^9}, 
   3.8387454287233124`*^9, {3.838745566958905*^9, 3.838745572968202*^9}, {
   3.838832480835082*^9, 3.8388324858883576`*^9}, 3.838832662601839*^9, 
   3.8400444674100447`*^9, {3.840044657898258*^9, 3.840044675080756*^9}, {
   3.840044792234081*^9, 3.8400448028818226`*^9}, {3.840045382891678*^9, 
   3.8400454107116804`*^9}, {3.8400457742282677`*^9, 3.840045782682536*^9}, {
   3.840046004923623*^9, 3.840046009099416*^9}, 3.8400460619888587`*^9, {
   3.8400460949919004`*^9, 3.84004610011978*^9}, {3.8400461438186865`*^9, 
   3.8400461690448275`*^9}, {3.8400536215227985`*^9, 
   3.8400536593035183`*^9}, {3.840053705946847*^9, 3.840053723757249*^9}, {
   3.8400537835503826`*^9, 3.8400538050647817`*^9}, {3.8400538490526533`*^9, 
   3.840053877267029*^9}, {3.840054015361252*^9, 3.840054050881156*^9}, 
   3.8400541211876483`*^9, {3.840054841363824*^9, 3.840054842590229*^9}, {
   3.8400548774584274`*^9, 3.8400548954699373`*^9}, 3.840062489108899*^9, {
   3.8400625230755796`*^9, 3.8400625357077594`*^9}, {3.840062608567613*^9, 
   3.840062609225909*^9}, 3.840064282796586*^9, {3.840064347610565*^9, 
   3.8400643514241934`*^9}, {3.840064435863537*^9, 3.840064436038506*^9}, {
   3.840066248372734*^9, 3.8400662514900155`*^9}, {3.8400664641163483`*^9, 
   3.8400664688160753`*^9}, 3.8400666848661065`*^9, {3.8400668057053223`*^9, 
   3.8400668205868874`*^9}, {3.8400669375243015`*^9, 3.840067029056565*^9}, {
   3.8400670665699735`*^9, 3.8400670668913956`*^9}, {3.8400673521968985`*^9, 
   3.840067373037039*^9}, {3.8400674925370984`*^9, 3.840067499815276*^9}, {
   3.8400676885764246`*^9, 3.8400676914667573`*^9}, {3.840067767866358*^9, 
   3.840067799215399*^9}, {3.8400678334141483`*^9, 3.840067834605913*^9}, {
   3.8400678737948313`*^9, 3.840067881587015*^9}, {3.840067987954644*^9, 
   3.840067988566532*^9}, {3.8400687429367623`*^9, 3.8400688146563964`*^9}, 
   3.8400688885471363`*^9, {3.8400690624252715`*^9, 3.8400690763966675`*^9}, {
   3.840069180186268*^9, 3.84006918878432*^9}, {3.8400699684665527`*^9, 
   3.840070030673232*^9}, {3.840070069194943*^9, 3.840070130021838*^9}, {
   3.8400702050033846`*^9, 3.840070295059636*^9}, {3.8400703424521255`*^9, 
   3.8400703701890373`*^9}, {3.840070536126915*^9, 3.840070543162916*^9}, {
   3.8400707194066267`*^9, 3.840070723381528*^9}, {3.840071016027475*^9, 
   3.840071035148421*^9}, 3.840071082957506*^9, {3.8400711294374886`*^9, 
   3.8400712078568583`*^9}, {3.8400720622403393`*^9, 3.840072062449636*^9}, {
   3.8400725161957693`*^9, 3.8400725194734535`*^9}, {3.840190301254188*^9, 
   3.840190369112875*^9}, {3.840190421163118*^9, 3.840190483558923*^9}, {
   3.8401905169341288`*^9, 3.8401905686044073`*^9}, {3.840190665069972*^9, 
   3.840190691093354*^9}, {3.840190764716844*^9, 3.840190909552351*^9}, {
   3.840190952571726*^9, 3.840190994597392*^9}, 3.840191052489993*^9, {
   3.84019109858766*^9, 3.840191106858177*^9}, {3.840212643647187*^9, 
   3.8402126587042575`*^9}, {3.840212948316355*^9, 3.840213092874155*^9}, {
   3.8402131666079383`*^9, 3.8402131696129346`*^9}, {3.8402143027437525`*^9, 
   3.8402143267459517`*^9}, {3.8402804561573114`*^9, 3.840280523225045*^9}, {
   3.8402809376168385`*^9, 3.840280971021533*^9}, {3.8402849953143473`*^9, 
   3.840284995539066*^9}, {3.840285203246116*^9, 3.8402852211954503`*^9}, {
   3.8405484745807753`*^9, 3.840548502614027*^9}, {3.840548682116254*^9, 
   3.8405486958534555`*^9}, {3.8405786523932867`*^9, 3.840578657988408*^9}, {
   3.843048933981492*^9, 3.8430489827653337`*^9}, {3.843156067210787*^9, 
   3.8431560738818665`*^9}, {3.843673823484939*^9, 3.843673845079752*^9}, {
   3.84367455535194*^9, 3.843674556182434*^9}, {3.843674811161117*^9, 
   3.843674811879682*^9}, {3.843676664029125*^9, 3.843676676427333*^9}, 
   3.843676708501584*^9, {3.843676759622218*^9, 3.84367677437171*^9}, {
   3.843676960753503*^9, 3.843676961090637*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"2ba813e8-f4d4-445d-9ef4-e02d9a926ee0"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"bd0e4e5e-07ac-4d81-8d42-\
091704d955dc"],

Cell["Test for scale reduction ratio during downscaling", "Text",
 CellChangeTimes->{{3.84006719879638*^9, 
  3.8400672414768887`*^9}},ExpressionUUID->"72690261-41c4-44e8-894e-\
424c3aadbc63"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"2.", ",", "x"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "6"}], "}"}]}], "]"}], "\[IndentingNewLine]",
   "*)"}]], "Input",
 CellChangeTimes->{{3.838481480296423*^9, 3.838481501447732*^9}, {
  3.841415676486165*^9, 3.8414156825441313`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"4a2d9cdc-af0c-4209-87b2-b87eb70ed9b6"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"x", "=", "1"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"x", "*", "2"}]}], ",", "6"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"x", "=", "1"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"y", "=", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"2", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"x", "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", "y", "]"}]}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.8384821585723815`*^9, 3.8384822114444637`*^9}, {
   3.838482458593239*^9, 3.838482468762911*^9}, {3.838482501888792*^9, 
   3.838482578038643*^9}, 3.8384826095327625`*^9, {3.8384826811927257`*^9, 
   3.838482691735092*^9}, {3.841415687509756*^9, 3.8414156924341836`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"c762d551-3cb1-49bc-a28a-ed51f8e2b718"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"0.001", "^", "i"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"64", "*", 
       RowBox[{"2", "^", 
        RowBox[{"-", "i"}]}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "6"}], "}"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.84004722081765*^9, 3.8400472511938562`*^9}, {
   3.840053530250901*^9, 3.840053534144755*^9}, 3.8400724971509066`*^9, {
   3.8402124536219654`*^9, 3.840212479952806*^9}, {3.8402125984668093`*^9, 
   3.8402126023267517`*^9}, {3.841415696485509*^9, 3.8414157012070227`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"ce477a78-ea2e-4373-a69b-a57aecd4adf6"],

Cell["Test for Pyrflow1D and scale tracking", "Text",
 CellChangeTimes->{{3.84006719879638*^9, 
  3.8400672133345633`*^9}},ExpressionUUID->"33afa66a-7a5a-4c28-a638-\
4e16bc8e59fc"],

Cell["\<\
0.01*2^(-m) depends on m to update the error depending on the highest \
resolution scale\
\>", "Text",
 CellChangeTimes->{{3.840548374592219*^9, 
  3.8405484003331394`*^9}},ExpressionUUID->"6b52b0d8-024c-41a6-a4fa-\
ff4f0506ee33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initializing", " ", "values"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", " ", "v2"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "0."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", "14"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"m", "\[Rule]", " ", 
      RowBox[{"max", " ", "lvl"}]}], ",", " ", 
     RowBox[{"n", "\[Rule]", " ", 
      RowBox[{"min", " ", "lvl"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"PyrFlow1D", " ", "solution"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], "=", 
    RowBox[{"PyrFlow1D", "[", 
     RowBox[{"i", ",", " ", "p", ",", 
      RowBox[{"pyrf12", "[", 
       RowBox[{"[", 
        RowBox[{"m", ";;", "n"}], "]"}], "]"}], ",", 
      RowBox[{"0.01", "*", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "m"}], "+", "1"}], ")"}]}]}], ",", 
      "\"\<SemiConstrained\>\""}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"{", 
       RowBox[{"v1", ",", "v2"}], "}"}], "]"}], ",", "status"}], 
    "}"}]}]}]], "Input",
 CellChangeTimes->{{3.83639948364995*^9, 3.836399519806125*^9}, {
   3.8363995590245132`*^9, 3.83639960757861*^9}, {3.838080084756638*^9, 
   3.8380800851141353`*^9}, {3.8380804424545712`*^9, 
   3.8380804457646008`*^9}, {3.8380805343644238`*^9, 
   3.8380805622628913`*^9}, {3.8380806157132387`*^9, 3.8380806315133705`*^9}, 
   3.838080662503994*^9, {3.838080878494111*^9, 3.838080920662928*^9}, 
   3.838082457493312*^9, {3.840045753265614*^9, 3.8400457539577885`*^9}, 
   3.84004579390691*^9, {3.840046163537953*^9, 3.840046164081414*^9}, {
   3.840064234698558*^9, 3.8400642457064667`*^9}, 3.8400643170265927`*^9, {
   3.8400670995057793`*^9, 3.8400671416366897`*^9}, {3.840067276996817*^9, 
   3.840067280625373*^9}, 3.8400676368053093`*^9, 3.8400679985153937`*^9, {
   3.840191148333891*^9, 3.840191262607202*^9}, {3.8402805474678636`*^9, 
   3.8402805841324234`*^9}, 3.8402806423025513`*^9, {3.8402806786126747`*^9, 
   3.840280914219866*^9}, 3.8402810301816626`*^9, 3.840281335289158*^9, 
   3.8402847673221245`*^9, {3.8402849473165145`*^9, 3.840284950986496*^9}, 
   3.8402850025598235`*^9, {3.8405484097849054`*^9, 3.8405484111283555`*^9}, {
   3.8405485354254704`*^9, 3.8405485555772915`*^9}, {3.8405486541284895`*^9, 
   3.8405486554873114`*^9}, {3.840548721600456*^9, 3.840548733226588*^9}, {
   3.8405488364992127`*^9, 3.840548857907818*^9}, {3.8430490024950776`*^9, 
   3.843049018131991*^9}, {3.84367392707541*^9, 3.843673930828207*^9}, {
   3.8436766930748377`*^9, 3.8436766931711187`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"2609a419-770e-40a0-824d-e1ef4cdb0071"],

Cell[BoxData[
 RowBox[{"seePlot", "[", 
  RowBox[{"p", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"v1", ",", "v2"}], "}"}], ",", 
   RowBox[{"pyrf12", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8363995323142886`*^9, 3.8363995497959876`*^9}, {
   3.836399619173401*^9, 3.836399627315104*^9}, {3.8384848657173834`*^9, 
   3.8384848695138836`*^9}, {3.8400640901794996`*^9, 3.840064096563566*^9}, 
   3.8400642190695267`*^9, 3.840064254160406*^9, 3.8400643231875253`*^9, 
   3.8400671534853387`*^9, 3.840067289625275*^9, 3.840067719035468*^9, 
   3.8400678437352333`*^9, 3.840067979214921*^9, 3.840068024446211*^9, 
   3.8400681171252265`*^9, {3.8400681524745507`*^9, 3.840068183426964*^9}, {
   3.8400682390152364`*^9, 3.8400682603653374`*^9}, 3.8400703249464455`*^9, {
   3.840070381556637*^9, 3.8400703854466133`*^9}, 3.8400705520194263`*^9, {
   3.84019115414285*^9, 3.840191221424403*^9}, 3.840280708155969*^9, 
   3.8402807658886623`*^9, {3.840280821326911*^9, 3.8402808379807625`*^9}, 
   3.8402809199145455`*^9, {3.8405485709314113`*^9, 3.8405485739471397`*^9}, {
   3.8436767881037817`*^9, 3.843676788403307*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"10603e1f-ab0f-41e3-a7a6-b4cd1ded3daf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", " ", "v2", ",", "status", ",", "e"}], "}"}], "=", 
      RowBox[{"PyrFlow1D", "[", 
       RowBox[{"10", ",", "p", ",", " ", 
        RowBox[{"pyrf12", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "5"}], "]"}], "]"}], ",", "0.01", ",", 
        "\"\<SemiConstrained\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"v1", "+", "v2"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v1", "+", "v2"}], ")"}], "-", "1"}], ",", "status"}], 
      "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", 
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", " ", "30", ",", " ", "1"}], "]"}]}], "}"}]}], "]"}], 
  "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.836499324689963*^9, 3.836499348577834*^9}, {
   3.8364997365618815`*^9, 3.836499750430583*^9}, {3.83650004985175*^9, 
   3.8365001527098722`*^9}, {3.8400462015559807`*^9, 
   3.8400462044039545`*^9}, {3.8400640505875683`*^9, 3.840064057846557*^9}, 
   3.8400662827537003`*^9, {3.8400663206400986`*^9, 3.8400663450911584`*^9}, 
   3.8400663830449533`*^9, 3.840066447727253*^9, 3.8400665501156096`*^9, {
   3.8400672934971447`*^9, 3.8400672945063057`*^9}, 3.840068086326285*^9, {
   3.840191271303691*^9, 3.840191285728421*^9}, {3.8401913600592318`*^9, 
   3.8401914917744627`*^9}, 3.8402131368901725`*^9, {3.8402806560586977`*^9, 
   3.840280657225114*^9}, {3.843676796956463*^9, 3.843676804233185*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"2b8fa10b-2455-437d-a597-696051382bd9"],

Cell["Testing all scale for one pixel", "Text",
 CellChangeTimes->{{3.8401915462198973`*^9, 
  3.840191554613942*^9}},ExpressionUUID->"f69c735a-a188-455c-a6c5-\
2fb3cf320fa3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", "8"}], ";"}]}], "Input",
 CellChangeTimes->{{3.836399597284279*^9, 3.8363996054333725`*^9}, {
   3.838080076942332*^9, 3.838080077133206*^9}, 3.838080532524396*^9, 
   3.840064157773669*^9, {3.8400644557376595`*^9, 3.840064520622788*^9}, 
   3.840067093216194*^9, 3.840067161906935*^9, {3.840067441726561*^9, 
   3.840067442126357*^9}, {3.840067594845196*^9, 3.8400675950365334`*^9}, 
   3.8400677054053097`*^9, {3.8400680796966324`*^9, 3.840068129676839*^9}, {
   3.840068180047144*^9, 3.840068256136609*^9}, {3.840068831216014*^9, 
   3.8400688611865463`*^9}, 3.8402806756476183`*^9, {3.8402853727759953`*^9, 
   3.8402853980045505`*^9}, 3.841416001759392*^9, 3.841495531055027*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"3f4c1867-bd09-4c1e-92e8-e8d5fa88e88f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", " ", "v2", ",", " ", "status", ",", "e"}], "}"}], 
       " ", "=", " ", 
       RowBox[{"PyrFlow1D", "[", 
        RowBox[{"i", ",", " ", "p", ",", " ", 
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"scale", " ", ";;", " ", "5"}], "]"}], "]"}], ",", 
         RowBox[{"0.01", "*", "2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "scale"}], "-", "1"}], ")"}]}], ",", 
         "\"\<SemiConstrained\>\""}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{"scale", ",", "5", ",", " ", 
        RowBox[{"v1", " ", "+", " ", "v2"}], ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v1", " ", "+", " ", "v2"}], ")"}], " ", "-", " ", "1"}], 
        ",", " ", "status"}], "}"}]}], "\n", " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"scale", ",", "1", ",", "5"}], "}"}]}], "]"}], " ", "//", " ", 
   "MatrixForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", "\n", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", " ", "v2", ",", " ", "status", ",", "e"}], "}"}], 
       " ", "=", " ", 
       RowBox[{"PyrFlow1D", "[", 
        RowBox[{"10", ",", " ", "p", ",", " ", 
         RowBox[{"pyrf12", "[", 
          RowBox[{"[", 
           RowBox[{"scale", " ", ";;", " ", "scale"}], "]"}], "]"}], ",", 
         RowBox[{"0.01", "*", "2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "scale"}], "-", "1"}], ")"}]}], ",", 
         "\"\<SemiConstrained\>\""}], "]"}]}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{"scale", ",", "scale", ",", " ", 
        RowBox[{"v1", " ", "+", " ", "v2"}], ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"v1", " ", "+", " ", "v2"}], ")"}], " ", "-", " ", "1"}], 
        ",", " ", "status"}], "}"}]}], "\n", " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"scale", ",", "1", ",", "5"}], "}"}]}], "]"}], " ", "//", " ", 
   "MatrixForm"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\n", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", " ", "v2", ",", " ", "status", ",", "e"}], "}"}], 
      " ", "=", " ", 
      RowBox[{"PyrFlow1D", "[", 
       RowBox[{"10", ",", " ", "p", ",", " ", 
        RowBox[{"pyrf12", "[", 
         RowBox[{"[", 
          RowBox[{"1", " ", ";;", " ", "scale"}], "]"}], "]"}], ",", 
        RowBox[{"0.01", "*", "2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "scale"}], "-", "1"}], ")"}]}], ",", 
        "\"\<SemiConstrained\>\""}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "scale", ",", " ", 
       RowBox[{"v1", " ", "+", " ", "v2"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v1", " ", "+", " ", "v2"}], ")"}], " ", "-", " ", "1"}], 
       ",", " ", "status"}], "}"}]}], "\n", " ", ",", " ", 
    RowBox[{"{", 
     RowBox[{"scale", ",", "1", ",", "5"}], "}"}]}], "]"}], " ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", "\n", "  ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v1", ",", " ", "v2", ",", " ", "status", ",", "e"}], "}"}], 
      " ", "=", " ", 
      RowBox[{"PyrFlow1D", "[", 
       RowBox[{"10", ",", " ", "p", ",", " ", 
        RowBox[{"pyrf12", "[", 
         RowBox[{"[", 
          RowBox[{"scale", ";;", " ", 
           RowBox[{"scale", "+", "1"}]}], "]"}], "]"}], ",", 
        RowBox[{"0.01", "*", "2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "scale"}], "-", "1"}], ")"}]}], ",", 
        "\"\<SemiConstrained\>\""}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"{", 
      RowBox[{"scale", ",", 
       RowBox[{"scale", "+", "1"}], ",", " ", 
       RowBox[{"v1", " ", "+", " ", "v2"}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v1", " ", "+", " ", "v2"}], ")"}], " ", "-", " ", "1"}], 
       ",", " ", "status"}], "}"}]}], "\n", " ", ",", " ", 
    RowBox[{"{", 
     RowBox[{"scale", ",", "1", ",", "4"}], "}"}]}], "]"}], " ", "//", " ", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.840191566120503*^9, 3.840191698236615*^9}, {
  3.8401917729313173`*^9, 3.840191794282414*^9}, {3.840191901316683*^9, 
  3.840191902051524*^9}, {3.840285353800062*^9, 3.84028536888945*^9}, {
  3.840285401197082*^9, 3.8402854497544556`*^9}, {3.843676813010517*^9, 
  3.843676868644951*^9}, {3.843676925861679*^9, 3.843676931642219*^9}, {
  3.843677078680336*^9, 3.843677082401039*^9}, {3.84367713947053*^9, 
  3.8436771665266314`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"5f3c7b77-566e-44ea-904f-9ee47450a3b0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics for one pixel iteration (pixelIterGraphics)", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431519286434603`*^9, 
  3.843151934406221*^9}, {3.843153522326394*^9, 
  3.843153538327319*^9}},ExpressionUUID->"fed493e6-7b8d-4ff8-84b2-\
6658c2dcae65"],

Cell[CellGroupData[{

Cell["One Pixel Iteration", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9, {3.842703573534071*^9, 3.8427035807603846`*^9}, {
   3.843152221644866*^9, 
   3.8431522261599483`*^9}},ExpressionUUID->"445466a1-9fbc-4a6e-a554-\
63a1db493034"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Makes", " ", "iterations", " ", "by", " ", "saving", " ", "all", " ", 
    "the", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pixelIter", "[", 
      RowBox[{
      "i_", ",", " ", "p0_", ",", "v0_", ",", " ", "pyrfunctions_", ",", 
       "threshold_", ",", "\"\<SemiConstrained\>\""}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "v1", ",", " ", "v2", ",", "c", ",", "status", ",", "e", ",", 
         "iterTable"}], "}"}], ",", 
       RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{
           RowBox[{"Length", "[", "pyrfunctions", "]"}], "-", "1"}]}], ";", 
         " ", 
         RowBox[{"(*", " ", 
          RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", " ", "v2"}], "}"}], "=", "v0"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"compute", " ", "at", " ", "this", " ", "scale"}], ",", 
            " ", 
            RowBox[{
            "using", " ", "current", " ", "motion", " ", "estimate"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"status", "=", "\"\<ok\>\""}], ";", "\[IndentingNewLine]", 
            RowBox[{"iterTable", "=", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "index", " ", "of", " ", "pyrfunction", " ", "works", " ", 
                "only", " ", "if", " ", "fed", " ", "the", " ", "right", " ", 
                "range", " ", "of", " ", "pyrfunctions"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], 
                "=", 
                RowBox[{"PyrUpgrade1D", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"v1", ",", "v2", ",", "status", ",", "0"}], "}"}], 
                  ",", "p0", ",", " ", 
                  RowBox[{"pyrfunctions", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "f"}], "]"}], "]"}], ",", 
                  RowBox[{"threshold", "*", 
                   RowBox[{"2", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "c"}], ")"}]}]}], ",", 
                  "\"\<SemiConstrained\>\""}], "]"}]}], "\[IndentingNewLine]",
                ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "i"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"c", "=", 
             RowBox[{"c", "-", "1"}]}], ";", "\[IndentingNewLine]", 
            "iterTable"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"f", ",", "1", ",", 
             RowBox[{"Length", "[", "pyrfunctions", "]"}]}], "}"}]}], "]"}]}],
         "\[IndentingNewLine]", "\[IndentingNewLine]", ")"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.842697230934749*^9, 3.8426972527368526`*^9}, {
   3.8426973082279644`*^9, 3.842697361429648*^9}, {3.842697403265497*^9, 
   3.842697432855535*^9}, 3.842701002025896*^9, {3.8427010404503565`*^9, 
   3.842701135067622*^9}, {3.8427021386829405`*^9, 3.8427021544660206`*^9}, {
   3.842702855554968*^9, 3.8427028558462524`*^9}, {3.842704183726611*^9, 
   3.842704209359651*^9}, {3.8430497895630035`*^9, 3.8430497902347226`*^9}, {
   3.843051341313095*^9, 3.843051357589853*^9}, {3.8431560989922137`*^9, 
   3.8431561028310223`*^9}, {3.8436740344645157`*^9, 3.843674054127366*^9}, {
   3.8436771840203953`*^9, 3.84367720630402*^9}, {3.843678799909462*^9, 
   3.843678804052929*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"c8c27b2d-d18f-4c95-bef1-5f998b4a8001"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"414a2ebe-88a9-4fc7-b1d9-\
02834e86dcae"],

Cell[BoxData[
 RowBox[{"iter", "=", 
  RowBox[{"pixelIter", "[", 
   RowBox[{"10", ",", " ", "11", ",", " ", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", 
      RowBox[{"4", " ", ";;", " ", "5"}], "]"}], "]"}], ",", "0.001", ",", 
    "\"\<SemiConstrained\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.8427011171311693`*^9, {3.8427011579256897`*^9, 3.8427011722779355`*^9}, {
   3.842701297457902*^9, 3.8427012976177683`*^9}, 3.842702107395807*^9, {
   3.842702956024593*^9, 3.8427029573174276`*^9}, {3.843674059594473*^9, 
   3.843674065492262*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"9836c30a-df24-45ab-a262-a38cf5142133"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["One level Pixel Iteration Graphics", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9, {3.842703573534071*^9, 3.8427035807603846`*^9}, {
   3.843151795867714*^9, 
   3.84315184249883*^9}},ExpressionUUID->"2a4482d0-bb6d-4987-b075-\
61f3421a4f05"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"471bfc50-96b4-4b4d-a023-\
15b497946231"],

Cell[BoxData[
 RowBox[{
  RowBox[{"oneLevelPixelIterGraphics", "[", 
   RowBox[{"5", ",", 
    RowBox[{"iter", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", "11", ",", "3", ",", "  ", 
    RowBox[{
     RowBox[{"pyrf12", "[", 
      RowBox[{"[", 
       RowBox[{"5", " ", ";;", " ", "5"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.842702628017497*^9, 3.8427026756641293`*^9}, {
   3.8427029479441376`*^9, 3.8427029808126087`*^9}, 3.8427030934790354`*^9, 
   3.842704305418618*^9, {3.8436772424414997`*^9, 3.843677250244462*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"da4cba98-61d5-4883-98c0-913f24d97963"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["All levels pixel iteration Graphics", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9, 
   3.8431522871282415`*^9},ExpressionUUID->"388a7423-4952-4f51-aecd-\
f43a7a71b70d"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"3e97a119-1f66-42ce-9378-\
03f01463ad0c"],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", 
  RowBox[{"pixelIterGraphics", "[", 
   RowBox[{"10", ",", " ", "11", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", "3", ",", "5", ",", " ", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", 
      RowBox[{"4", ";;", " ", "5"}], "]"}], "]"}], ",", "0.001", ",", 
    "\"\<SemiConstrained\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.84270325045253*^9, 3.84270328052081*^9}, {
  3.842703403288223*^9, 3.8427034035937777`*^9}, {3.8427034592427025`*^9, 
  3.842703465318783*^9}, {3.842703548805395*^9, 3.8427035491911554`*^9}, {
  3.8436743973079367`*^9, 3.8436744005565987`*^9}, {3.843679449039856*^9, 
  3.843679450891342*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"2b95903b-6261-4981-adf8-f2f066942a34"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics for All pixels", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431519453413677`*^9, 
  3.8431519506391954`*^9}},ExpressionUUID->"ae27ebd0-9429-44a0-8629-\
d3d6d290d306"],

Cell[CellGroupData[{

Cell["All Pixel Graphics", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9, {3.842703573534071*^9, 3.8427035807603846`*^9}, {
   3.843053597749626*^9, 
   3.84305360317021*^9}},ExpressionUUID->"5b1268b7-c082-489e-bb5f-\
0bac9abcdada"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lineTest", "[", 
    RowBox[{
    "rangex_", ",", "pyrab_", ",", "threshold_", ",", 
     "\"\<SemiConstrained\>\""}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2", ",", "status", ",", "e"}], "}"}], "=", 
          RowBox[{"PyrFlow1D", "[", 
           RowBox[{
           "10", ",", "x", ",", "pyrab", ",", "threshold", ",", 
            "\"\<SemiConstrained\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", ",", "status"}], "}"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "rangex"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8430536232334023`*^9, {3.843053877375848*^9, 3.8430539486245584`*^9}, {
   3.8430540149210873`*^9, 3.8430541575389752`*^9}, {3.8430548675404863`*^9, 
   3.843054872742379*^9}, {3.843155808869821*^9, 3.8431558644185762`*^9}, {
   3.843674831612629*^9, 3.8436748933415194`*^9}, {3.843675034199531*^9, 
   3.8436750522775106`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"447a98bf-29f6-4376-9889-49eb2a1cabc8"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"734d864b-6b05-4a4e-9301-\
3f75a4ffad07"],

Cell[BoxData[
 RowBox[{"tes1", "=", 
  RowBox[{"lineTest", "[", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", 
      RowBox[{"Length", "[", "line1", "]"}]}], "]"}], ",", 
    RowBox[{"pyrf12", "[", 
     RowBox[{"[", 
      RowBox[{"5", ";;", "5"}], "]"}], "]"}], ",", "0.001", ",", 
    "\"\<SemiConstrained\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8430541726603727`*^9, 3.8430542426021805`*^9}, {
  3.8430542768852186`*^9, 3.843054302157134*^9}, {3.843054883911598*^9, 
  3.843054892362711*^9}, {3.843675072136907*^9, 3.843675075324703*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"8883fa0f-5003-4803-ad23-d7013a44661c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["See All pixels in line", "Subsection",
 CellChangeTimes->{{3.836395934506852*^9, 3.8363959796401834`*^9}, 
   3.836396084971814*^9, {3.842703573534071*^9, 3.8427035807603846`*^9}, {
   3.843053597749626*^9, 3.84305360317021*^9}, 
   3.8431523233043365`*^9},ExpressionUUID->"e0aea832-b481-4c4e-b6ed-\
9de669698b61"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 3.832269218824854*^9}, 
   3.8380824185442553`*^9},ExpressionUUID->"f43c0cf6-8c47-4499-8611-\
da20b3238c98"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{"9", ",", "13"}], "]"}], ",", "pyrf12", ",", "0.001", ",", 
   "\"\<SemiConstrained\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8430546307493587`*^9, 3.843054688785618*^9}, {
   3.8430548021191974`*^9, 3.843054840458894*^9}, {3.8430572309687786`*^9, 
   3.8430572639138165`*^9}, {3.843057637652525*^9, 3.8430576404489775`*^9}, {
   3.8430577064955626`*^9, 3.8430577087296467`*^9}, {3.843059112390246*^9, 
   3.843059117654656*^9}, 3.8432372709252653`*^9, {3.8436752251160517`*^9, 
   3.843675227913855*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"7cd488a2-15e6-4f33-bbc7-c78ba080aa17"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1142, 575},
WindowMargins->{{Automatic, 16}, {Automatic, 224}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 pour Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b5e3074c-e7de-4ab3-bc63-5614f3a9bcf4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 487, 7, 123, "Title",ExpressionUUID->"76329b2f-faa1-4991-b7bc-3f37e4fd90db"],
Cell[1070, 31, 386, 8, 69, "Text",ExpressionUUID->"e540e878-50f7-487d-9812-829d0d84e570"],
Cell[1459, 41, 430, 9, 37, "Input",ExpressionUUID->"d6613b5f-169d-4924-a7bf-e1328c874886"],
Cell[1892, 52, 664, 17, 65, "Input",ExpressionUUID->"b4f7a231-7676-48b5-8f20-01e7af950631"],
Cell[2559, 71, 704, 13, 92, "Input",ExpressionUUID->"8671407a-4f01-418c-b8d5-eb14191aec4b"],
Cell[CellGroupData[{
Cell[3288, 88, 337, 5, 84, "Section",ExpressionUUID->"1de7d95c-4776-46ae-8af3-331fe1c87c24"],
Cell[3628, 95, 2335, 56, 146, "Input",ExpressionUUID->"7f413bb8-506f-4434-8ffe-4a139a612f2d"],
Cell[5966, 153, 2066, 62, 227, "Input",ExpressionUUID->"1f6b702f-16ce-4ee0-8ccd-161a2fb6f757"]
}, Closed]],
Cell[CellGroupData[{
Cell[8069, 220, 219, 4, 65, "Section",ExpressionUUID->"18e1ac0b-2e67-4ae4-85a8-851f071e6799"],
Cell[CellGroupData[{
Cell[8313, 228, 162, 3, 67, "Subsection",ExpressionUUID->"4d85132e-f9aa-4886-993d-13ba7706c410"],
Cell[8478, 233, 12239, 266, 1111, "Input",ExpressionUUID->"a13d90b2-dea1-4b19-a655-f82fe55fa81b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[20754, 504, 191, 3, 65, "Subsection",ExpressionUUID->"057490d3-59e3-4979-8857-b71daab20425"],
Cell[20948, 509, 2367, 66, 227, "Input",ExpressionUUID->"984b118d-0285-4cf5-b45c-d8a67865e6d1"],
Cell[23318, 577, 1000, 23, 146, "Input",ExpressionUUID->"e8a19c3b-7ce4-41c9-9e2b-b6be0c488e6e"],
Cell[24321, 602, 1597, 32, 84, "Input",ExpressionUUID->"8e2e9166-e587-42d9-a494-f7bdc0bc8ffa"],
Cell[25921, 636, 753, 15, 60, "Input",ExpressionUUID->"98c7f0d8-9bb8-43a4-9b19-323d9cc80ddb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26711, 656, 182, 3, 67, "Subsection",ExpressionUUID->"9476c611-cedb-4e14-b4f1-a7f3e4e663c4"],
Cell[26896, 661, 8783, 157, 598, "Input",ExpressionUUID->"2ba813e8-f4d4-445d-9ef4-e02d9a926ee0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[35704, 822, 182, 3, 55, "Subsubsection",ExpressionUUID->"bd0e4e5e-07ac-4d81-8d42-091704d955dc"],
Cell[35889, 827, 192, 3, 42, "Text",ExpressionUUID->"72690261-41c4-44e8-894e-424c3aadbc63"],
Cell[36084, 832, 472, 11, 92, "Input",ExpressionUUID->"4a2d9cdc-af0c-4209-87b2-b87eb70ed9b6"],
Cell[36559, 845, 1124, 27, 200, "Input",ExpressionUUID->"c762d551-3cb1-49bc-a28a-ed51f8e2b718"],
Cell[37686, 874, 921, 22, 119, "Input",ExpressionUUID->"ce477a78-ea2e-4373-a69b-a57aecd4adf6"],
Cell[38610, 898, 180, 3, 42, "Text",ExpressionUUID->"33afa66a-7a5a-4c28-a638-4e16bc8e59fc"],
Cell[38793, 903, 240, 6, 42, "Text",ExpressionUUID->"6b52b0d8-024c-41a6-a4fa-ff4f0506ee33"],
Cell[39036, 911, 3247, 71, 300, "Input",ExpressionUUID->"2609a419-770e-40a0-824d-e1ef4cdb0071"],
Cell[42286, 984, 1239, 20, 35, "Input",ExpressionUUID->"10603e1f-ab0f-41e3-a7a6-b4cd1ded3daf"],
Cell[43528, 1006, 1708, 36, 119, "Input",ExpressionUUID->"2b8fa10b-2455-437d-a597-696051382bd9"],
Cell[45239, 1044, 175, 3, 42, "Text",ExpressionUUID->"f69c735a-a188-455c-a6c5-2fb3cf320fa3"],
Cell[45417, 1049, 877, 14, 65, "Input",ExpressionUUID->"3f4c1867-bd09-4c1e-92e8-e8d5fa88e88f"],
Cell[46297, 1065, 4900, 124, 578, "Input",ExpressionUUID->"5f3c7b77-566e-44ea-904f-9ee47450a3b0"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51258, 1196, 351, 5, 84, "Section",ExpressionUUID->"fed493e6-7b8d-4ff8-84b2-6658c2dcae65"],
Cell[CellGroupData[{
Cell[51634, 1205, 296, 5, 67, "Subsection",ExpressionUUID->"445466a1-9fbc-4a6e-a554-63a1db493034"],
Cell[51933, 1212, 4236, 92, 652, "Input",ExpressionUUID->"c8c27b2d-d18f-4c95-bef1-5f998b4a8001",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[56194, 1308, 182, 3, 55, "Subsubsection",ExpressionUUID->"414a2ebe-88a9-4fc7-b1d9-02834e86dcae"],
Cell[56379, 1313, 636, 13, 37, "Input",ExpressionUUID->"9836c30a-df24-45ab-a262-a38cf5142133"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57064, 1332, 308, 5, 67, "Subsection",ExpressionUUID->"2a4482d0-bb6d-4987-b075-61f3421a4f05"],
Cell[CellGroupData[{
Cell[57397, 1341, 182, 3, 55, "Subsubsection",ExpressionUUID->"471bfc50-96b4-4b4d-a023-15b497946231"],
Cell[57582, 1346, 678, 14, 37, "Input",ExpressionUUID->"da4cba98-61d5-4883-98c0-913f24d97963"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58309, 1366, 238, 4, 67, "Subsection",ExpressionUUID->"388a7423-4952-4f51-aecd-f43a7a71b70d"],
Cell[CellGroupData[{
Cell[58572, 1374, 182, 3, 55, "Subsubsection",ExpressionUUID->"3e97a119-1f66-42ce-9378-03f01463ad0c"],
Cell[58757, 1379, 775, 15, 37, "Input",ExpressionUUID->"2b95903b-6261-4981-adf8-f2f066942a34"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59593, 1401, 275, 4, 84, "Section",ExpressionUUID->"ae27ebd0-9429-44a0-8629-d3d6d290d306"],
Cell[CellGroupData[{
Cell[59893, 1409, 292, 5, 67, "Subsection",ExpressionUUID->"5b1268b7-c082-489e-bb5f-0bac9abcdada"],
Cell[60188, 1416, 1505, 36, 220, "Input",ExpressionUUID->"447a98bf-29f6-4376-9889-49eb2a1cabc8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[61718, 1456, 182, 3, 55, "Subsubsection",ExpressionUUID->"734d864b-6b05-4a4e-9301-3f75a4ffad07"],
Cell[61903, 1461, 647, 14, 37, "Input",ExpressionUUID->"8883fa0f-5003-4803-ad23-d7013a44661c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62599, 1481, 320, 5, 67, "Subsection",ExpressionUUID->"e0aea832-b481-4c4e-b6ed-9de669698b61"],
Cell[CellGroupData[{
Cell[62944, 1490, 182, 3, 55, "Subsubsection",ExpressionUUID->"f43c0cf6-8c47-4499-8611-da20b3238c98"],
Cell[63129, 1495, 681, 12, 37, "Input",ExpressionUUID->"7cd488a2-15e6-4f33-bbc7-c78ba080aa17"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

