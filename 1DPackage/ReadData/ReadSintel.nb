(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10078,        273]
NotebookOptionsPosition[      9034,        247]
NotebookOutlinePosition[      9471,        264]
CellTagsIndexPosition[      9428,        261]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Read Sintel Data", "Title",
 CellChangeTimes->{{3.8437447831403275`*^9, 3.8437447860327096`*^9}, {
  3.84374508743766*^9, 
  3.8437450880213633`*^9}},ExpressionUUID->"8cc75733-29a5-4df8-9c72-\
fec019fe9bc3"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{3.8437453004718437`*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"afb4b6e5-62b0-4237-9086-8681037d42f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"read", "[", 
    RowBox[{
    "baseSINTEL_", ",", "set_", ",", "num_", ",", "reduce_", ",", "corf_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ia", ",", "ib", ",", "id", ",", "rgb2d", ",", "reduire", ",", "clean", 
       ",", "io", ",", "left", ",", "right", ",", "disp", ",", "occ", ",", 
       " ", "frame", ",", " ", "base", ",", "fileleft", ",", "fileright"}], 
      "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"frame", "=", 
        RowBox[{"\"\<frame_\>\"", "<>", "num", "<>", "\"\<.png\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fileleft", "=", 
        RowBox[{"corf", "<>", "\"\<_left\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fileright", "=", 
        RowBox[{"corf", "<>", "\"\<_right\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"left", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "fileleft", ",", "set", 
           ",", "frame"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"right", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "fileright", ",", "set",
            ",", "frame"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"disp", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "\"\<disparities\>\"", 
           ",", "set", ",", "frame"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"occ", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "\"\<occlusions\>\"", 
           ",", "set", ",", "frame"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rgb2d", "[", 
         RowBox[{"{", 
          RowBox[{"r_", ",", "g_", ",", "b_"}], "}"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"r", "*", "4"}], "+", 
         RowBox[{"g", "/", "64"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"clean", "[", "img_", "]"}], ":=", 
        RowBox[{"Image", "[", 
         RowBox[{"ImageData", "[", "img", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reduire", "[", 
         RowBox[{"img_", ",", "1"}], "]"}], ":=", "img"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reduire", "[", 
         RowBox[{"img_", ",", "factor_"}], "]"}], ":=", 
        RowBox[{"ImageResize", "[", 
         RowBox[{"img", ",", 
          RowBox[{
           RowBox[{"ImageDimensions", "[", "img", "]"}], "/", "factor"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ia", "=", 
        RowBox[{"reduire", "[", 
         RowBox[{
          RowBox[{"ColorConvert", "[", 
           RowBox[{
            RowBox[{"clean", "@", 
             RowBox[{"Import", "[", "left", "]"}]}], ",", 
            "\"\<GrayScale\>\""}], "]"}], ",", "reduce"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ib", "=", 
        RowBox[{"reduire", "[", 
         RowBox[{
          RowBox[{"ColorConvert", "[", 
           RowBox[{
            RowBox[{"clean", "@", 
             RowBox[{"Import", "[", "right", "]"}]}], ",", 
            "\"\<GrayScale\>\""}], "]"}], ",", "reduce"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"id", "=", 
        RowBox[{
         RowBox[{"reduire", "[", 
          RowBox[{
           RowBox[{"Image", "[", "\[IndentingNewLine]", 
            RowBox[{"rgb2d", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"N", "@", 
                RowBox[{"ImageData", "[", 
                 RowBox[{
                  RowBox[{"clean", "@", 
                   RowBox[{"Import", "[", "disp", "]"}]}], ",", 
                  "\"\<Byte\>\""}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "3", "}"}], ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}], "]"}], 
            "\[IndentingNewLine]", "]"}], ",", "reduce"}], "]"}], "/", 
         "reduce"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"io", "=", 
        RowBox[{"reduire", "[", 
         RowBox[{
          RowBox[{"ColorConvert", "[", 
           RowBox[{
            RowBox[{"clean", "@", 
             RowBox[{"Import", "[", "occ", "]"}]}], ",", 
            "\"\<GrayScale\>\""}], "]"}], ",", "reduce"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"read", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"left", ",", "right", ",", "disp", ",", "occ"}], "}"}], 
          ",", "reduce"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}], 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8437448011461754`*^9, {3.8437448353856688`*^9, 3.843744840368672*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"d0042a0e-ee75-4e98-9aac-7b0b4da8a57a"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8437448940129895`*^9, 
  3.843744894382441*^9}},ExpressionUUID->"0500f8c3-e60a-468f-b672-\
16f62d8abbcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"baseSINTEL", "=", 
   RowBox[{"Switch", "[", 
    RowBox[{
    "$UserName", ",", "\[IndentingNewLine]", "\"\<fieri\>\"", ",", 
     "\"\<D:\\\\MastersMathematica\\\\Data\\\\Sintel\>\"", ",", 
     "\[IndentingNewLine]", "\"\<roys\>\"", ",", 
     "\"\</home/roys/datasets/SINTEL-stereo\>\""}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.843744968075386*^9, 3.8437449728681917`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"6cb83fe5-c2fd-433a-a77a-d5ef200149fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
    RowBox[{"read", "[", 
     RowBox[{
     "baseSINTEL", ",", "\"\<bamboo_1\>\"", ",", "\"\<0001\>\"", ",", "r", 
      ",", "\"\<clean\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "downscaling", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nx", "=", 
   RowBox[{"150", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ny", "=", 
   RowBox[{"300", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ImageTake", "[", 
     RowBox[{"#", ",", 
      RowBox[{"{", 
       RowBox[{"ny", ",", 
        RowBox[{"ny", "+", "44"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nx", ",", 
        RowBox[{"nx", "+", "102"}]}], "}"}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImageDimensions", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], 
   "}"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.8437449379650106`*^9, {3.8437449773465023`*^9, 3.8437449815504665`*^9}, {
   3.8437450286039896`*^9, 3.8437450501324234`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"295d0248-2494-473e-9fae-4c6370f4c46e"],

Cell[BoxData[""], "Input",ExpressionUUID->"97aaf336-4709-49e5-b511-3e78728e33e6"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{574.8, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"47a7964a-77fd-4bc4-8364-b2d5b88d425e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 213, 4, 97, "Title",ExpressionUUID->"8cc75733-29a5-4df8-9c72-fec019fe9bc3"],
Cell[796, 28, 302, 6, 28, "Input",ExpressionUUID->"afb4b6e5-62b0-4237-9086-8681037d42f7"],
Cell[1101, 36, 5515, 138, 689, "Input",ExpressionUUID->"d0042a0e-ee75-4e98-9aac-7b0b4da8a57a",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[6641, 178, 151, 3, 67, "Section",ExpressionUUID->"0500f8c3-e60a-468f-b672-16f62d8abbcb"],
Cell[6795, 183, 529, 11, 88, "Input",ExpressionUUID->"6cb83fe5-c2fd-433a-a77a-d5ef200149fa"],
Cell[7327, 196, 1595, 45, 224, "Input",ExpressionUUID->"295d0248-2494-473e-9fae-4c6370f4c46e"],
Cell[8925, 243, 81, 0, 28, "Input",ExpressionUUID->"97aaf336-4709-49e5-b511-3e78728e33e6"]
}, Open  ]]
}, Open  ]]
}
]
*)

