(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33424,        846]
NotebookOptionsPosition[     28089,        746]
NotebookOutlinePosition[     28563,        764]
CellTagsIndexPosition[     28520,        761]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Spline Pyramids ", "Title",
 CellChangeTimes->{{3.832408884851491*^9, 3.83240890773357*^9}, {
  3.8328619391991744`*^9, 
  3.8328619410067196`*^9}},ExpressionUUID->"190398be-c937-4ed7-94c6-\
428d2100588a"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"InputNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{3.832189670547576*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"2e087c91-d8a2-4aa6-9b33-fdc5df53d784"],

Cell[CellGroupData[{

Cell["TestPoints", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8437458642868853`*^9, 
  3.843745867031088*^9}},ExpressionUUID->"24c858df-4b1f-4d0c-a962-\
c1643450fe2c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"line", "=", 
   RowBox[{"GaussianFilter", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"11", "<=", " ", "p", "<=", "18"}], ",", "1", ",", "0"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "1", ",", "30"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"line", ",", 
    RowBox[{"Joined", "->", "True"}], ",", 
    RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"PlotRange", "->", "All"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8437458774123664`*^9, 3.8437458867009087`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"e765c651-d581-4a5e-af12-87d1b3d2f30d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gaussian Kernel", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 
  3.8321935380848103`*^9}},ExpressionUUID->"fb8484bf-4867-4a1a-b0c1-\
5612010c9610"],

Cell["Gaussian filter tap 5 where a={0.3, 0.6}", "Text",
 CellChangeTimes->{{3.832193584275958*^9, 3.832193603380583*^9}, {
  3.844176468370038*^9, 
  3.8441764688336935`*^9}},ExpressionUUID->"ddee2555-a5ed-4a74-94e4-\
54c1f49f8abe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gaussianKernel", "[", "a_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"a", "*", "2"}]}], ",", " ", "1", ",", 
       RowBox[{"a", "*", "4"}], ",", "1", ",", 
       RowBox[{"1", "-", 
        RowBox[{"a", "*", "2"}]}]}], "}"}], "/", "4.0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gaussianKernel", "::", "usage"}], "=", 
   "\"\<\nGaussian filter tap 5 where a={0.3, 0.6}\n\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.832193545467044*^9, 3.8321935548249855`*^9}, {
  3.843157314751688*^9, 3.8431573381598816`*^9}, {3.84417647146355*^9, 
  3.8441764718027987`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"61a682cb-21a6-44ff-a813-622bc47fef77"],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"96a0f44f-c321-4523-bc44-\
ff4a06b75261"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gaussianKernel", "[", "0.5", "]"}]], "Input",
 CellChangeTimes->{{3.832289803887424*^9, 3.8322898266176043`*^9}, {
  3.832409017455782*^9, 3.832409040767367*^9}, {3.832410628308516*^9, 
  3.832410628384665*^9}, {3.8441770848601804`*^9, 3.8441770987319174`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"aa2f4645-bf37-4487-8f3a-d85d6c85891d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.25`", ",", "0.5`", ",", "0.25`", ",", "0.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.84417707765377*^9, 3.8441771097588663`*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"17e11fc0-b3bd-4903-a1a3-b2ca773cd8c1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["next Pyramid\[CloseCurlyQuote]s level values", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.83219365673135*^9, 3.832193665104113*^9}, {3.832193809551778*^9, 
  3.832193823897608*^9}},ExpressionUUID->"a1fb13ed-30d8-4a55-8660-\
795c8619b76c"],

Cell["\<\
Takes values from any level and return the values of the next level
ADDS a value before and after, padding of 2 which become 1 due to averaging\
\>", "Text",
 CellChangeTimes->{
  3.832193676907037*^9, {3.832193721046272*^9, 3.8321937353829317`*^9}, {
   3.832240320646142*^9, 3.832240340958784*^9}, {3.8322410250914526`*^9, 
   3.832241028610758*^9}},ExpressionUUID->"074122c8-5c82-4b8a-91e2-\
72263e658b64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pyrNextLevel", "[", "line_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "d", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"ListConvolve", "[", 
          RowBox[{
           RowBox[{"gaussianKernel", "[", "0.5", "]"}], ",", 
           RowBox[{"ArrayPad", "[", 
            RowBox[{"line", ",", 
             RowBox[{"2", "+", "2"}], 
             RowBox[{"(*", " ", 
              RowBox[{
              "to", " ", "get", " ", "1", " ", "extra", " ", "value", " ", 
               "on", " ", "each", " ", "side"}], " ", "*)"}], ",", 
             "\"\<Fixed\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Mean", "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{"d", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyrNextLevel", "::", "usage"}], "=", 
   "\"\<\nTakes values from any level and return the values of the next level\
\nADDS a value before and after, padding of 2 which become 1 due to averaging\
\n\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.83219368630394*^9, 3.8321937061279235`*^9}, 
   3.832193952243328*^9, 3.8322402279471493`*^9, 3.8322402861637926`*^9, 
   3.832240343525524*^9, {3.8322410021980352`*^9, 3.8322410043112965`*^9}, {
   3.8322483112045097`*^9, 3.8322483213838973`*^9}, {3.83224868040668*^9, 
   3.832248682162779*^9}, 3.8322624428420544`*^9, {3.832284794757285*^9, 
   3.832284805027375*^9}, {3.8322849833471518`*^9, 3.8322849915672784`*^9}, {
   3.8322891878477573`*^9, 3.832289191885934*^9}, {3.83228922508099*^9, 
   3.832289379079668*^9}, {3.8322898526775627`*^9, 3.8322898532775135`*^9}, {
   3.8324093743349648`*^9, 3.832409374861112*^9}, {3.832409508040867*^9, 
   3.832409532874847*^9}, 3.832409605796853*^9, {3.8324109845493402`*^9, 
   3.8324109865889482`*^9}, {3.832411234505508*^9, 3.8324112351789618`*^9}, {
   3.8431573451376143`*^9, 3.84315736413104*^9}, {3.8441764892595963`*^9, 
   3.844176489391522*^9}, {3.8441771043029585`*^9, 
   3.8441771048081236`*^9}},ExpressionUUID->"5d894479-7829-49c9-8437-\
a5521cc7385b"],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"fe709cae-cb4d-4e01-9350-\
a4984b71c21f"],

Cell[BoxData[{
 RowBox[{"pyrNextLevel", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pyrNextLevel", "[", 
  RowBox[{"{", 
   RowBox[{
   "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
    "8"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8324090779807053`*^9, 3.8324090912422028`*^9}, {
  3.832409125171077*^9, 3.832409171501914*^9}, {3.83240923437969*^9, 
  3.832409239013509*^9}, {3.83240933455023*^9, 3.832409350756954*^9}, {
  3.832409461523416*^9, 3.832409463288677*^9}, {3.832409581874894*^9, 
  3.832409582113636*^9}, {3.832409613328376*^9, 3.8324096194199142`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"c3b0fcaf-81b8-4b54-a9d0-ade9379a4c23"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"abf8e10f-23d0-494e-89c9-\
2adee75a39f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"pyrNextLevel", "[", "line", "]"}]}], 
  ";"}], "\[IndentingNewLine]", "line", "\[IndentingNewLine]", "y"}], "Input",
 CellChangeTimes->{{3.832263831446494*^9, 3.8322638513570905`*^9}, {
  3.832267458382874*^9, 3.8322674713858104`*^9}, {3.8322690775755324`*^9, 
  3.83226907779843*^9}, {3.8322691289521327`*^9, 3.8322691300817604`*^9}, {
  3.832410900896858*^9, 3.832410925027378*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"9333efd0-c0eb-493b-8f4c-d8a77c592c4f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[" next Pyramid\[CloseCurlyQuote]s level coordinates", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.83219365673135*^9, 3.832193665104113*^9}, {3.8321938281643553`*^9, 
  3.8321938400406*^9}},ExpressionUUID->"cc8a59fd-c067-4566-8107-9b571d8dfaef"],

Cell["\<\
compute the X coordinates of next level based on a current level
we usually start with Range[1,lineSize] at level 0\
\>", "Text",
 CellChangeTimes->{{3.832193854962858*^9, 3.832193862362031*^9}, {
  3.8322414154368534`*^9, 
  3.832241416395805*^9}},ExpressionUUID->"0fe83b93-9f60-4609-81a8-\
75632d6e57d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pyrNextCoord", "[", "coords_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"step", ",", "first", ",", "last", ",", "x"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"step", "=", 
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"first", "=", 
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", 
          RowBox[{"2", "*", 
           RowBox[{"(", "step", ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"last", "=", 
         RowBox[{
          RowBox[{"coords", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "+", 
          RowBox[{"2", "*", 
           RowBox[{"(", "step", ")"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "first", ",", "last", ",", "step"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"N", "[", 
         RowBox[{"Mean", "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"x", ",", "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyrNextCoord", "::", "usage"}], "=", 
   "\"\<\ncompute the X coordinates of next level based on a current level\n\
we usually start with Range[1,lineSize] at level 0\n\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.832193873053037*^9, 3.832193884282445*^9}, {
  3.8322414516494036`*^9, 3.8322414566568003`*^9}, {3.832247801534067*^9, 
  3.8322478724642286`*^9}, {3.832248055909544*^9, 3.8322480594829683`*^9}, {
  3.8322482186301727`*^9, 3.83224822402217*^9}, {3.832248335728506*^9, 
  3.8322483600389967`*^9}, {3.832248672491798*^9, 3.8322486780966525`*^9}, {
  3.8322894157303143`*^9, 3.832289419661435*^9}, {3.832409704822541*^9, 
  3.8324097118365192`*^9}, {3.843157368527275*^9, 3.8431574107973647`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7b40c924-37d0-4c8d-a452-6d803c65d64c"],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"f4d4de17-4e48-4526-85f7-\
cc2b9a20af89"],

Cell[BoxData[{
 RowBox[{"pyrNextLevel", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pyrNextCoord", "[", 
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", "7"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pyrNextLevel", "[", 
  RowBox[{"{", 
   RowBox[{
   "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", 
    "8"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pyrNextCoord", "[", 
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", "8"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.832409679557642*^9, 3.832409725716514*^9}, {
  3.832409756021291*^9, 3.832409766231242*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"3ce396b6-d35f-4914-886a-16ed63e46960"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"dd039da5-64c6-49b8-85a0-\
5d8eb1bd94c7"],

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"pyrNextCoord", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Length", "[", "line", "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.832267622709258*^9, {3.83226877244942*^9, 3.8322687850592866`*^9}, {
   3.832269080934141*^9, 3.8322690811566067`*^9}, {3.8324105431198893`*^9, 
   3.8324105447940607`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"361aa883-c1a7-414d-822f-5321e1c071d7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"92f99e69-8c1e-41f6-a207-\
5ccd1d60764c"],

Cell[BoxData[
 RowBox[{"Level", " ", "0"}]], "Input",
 CellChangeTimes->{{3.832409805869459*^9, 3.832409806673909*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"2b93c655-5d72-4168-91b4-cc3b3122bddd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"y", "=", "line"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Length", "[", "line", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"p0", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.832269285857695*^9, 3.832269306014606*^9}, {
   3.832289631777483*^9, 3.832289632667368*^9}, 3.8324098701104393`*^9, {
   3.832410550563307*^9, 3.832410552011723*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"aaa2c59c-dc79-4fa2-9c93-533e21bf082c"],

Cell[BoxData[
 RowBox[{"Level", " ", "1"}]], "Input",
 CellChangeTimes->{{3.832409815794381*^9, 3.8324098165544243`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"87c15ebe-a2e1-4238-9a1c-2c31e28eabea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"pyrNextLevel", "[", "y", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"pyrNextCoord", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"p1", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8322690865931168`*^9, 3.8322691066116815`*^9}, {
   3.832269252463165*^9, 3.8322693974686236`*^9}, {3.832289580934698*^9, 
   3.8322896157971334`*^9}, {3.83240982269834*^9, 3.8324098321990623`*^9}, 
   3.8324098726707697`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"e9302d98-9762-4e1c-9f56-c3b5450d32fd"],

Cell[BoxData[
 RowBox[{"Level", " ", "2"}]], "Input",
 CellChangeTimes->{{3.832409815794381*^9, 3.8324098165544243`*^9}, {
  3.832409884109336*^9, 3.832409884268816*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"f5d2613a-5076-425d-9041-635c652f42f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"pyrNextLevel", "[", "y", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"pyrNextCoord", "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"p2", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8322690865931168`*^9, 3.8322691066116815`*^9}, {
  3.832269252463165*^9, 3.8322693974686236`*^9}, {3.832289580934698*^9, 
  3.8322896157971334`*^9}, {3.83240982269834*^9, 3.8324098321990623`*^9}, {
  3.8324098726707697`*^9, 3.832409886102433*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"da93a991-3cff-4b22-a8ba-cbe2a6c5f2c8"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p0", ",", "p1", ",", "p2"}], "}"}], ",", 
   RowBox[{"Joined", "->", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8322694503592215`*^9, 3.8322694814265013`*^9}, {
  3.832409907254663*^9, 3.832409914584242*^9}, {3.83241079834391*^9, 
  3.832410801244772*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"5e2d0221-ca96-45e6-b462-756784c826ac"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pyramid\[CloseCurlyQuote]s first and last coordinates", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.83219365673135*^9, 3.832193665104113*^9}, {3.8321938281643553`*^9, 
  3.8321938400406*^9}, {3.8321941314798555`*^9, 
  3.832194148070655*^9}},ExpressionUUID->"a1884d1b-aec7-4a3b-bfb9-\
cb991f0d4360"],

Cell["\<\
return: first and last coordinates of a specific pyramid level.
 ATENTION: we need the lineSize of level 0 to figure out the coordinates of \
all following levels \
\>", "Text",
 CellChangeTimes->{{3.832193854962858*^9, 3.832193862362031*^9}, {
  3.8321940785441856`*^9, 
  3.832194103899931*^9}},ExpressionUUID->"59e23d5a-daf0-4f62-8116-\
28bcfe776d2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pyrCoordFirstLast", "[", 
     RowBox[{"level_", ",", "lineSizeLevel0_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Nest", "[", 
         RowBox[{"pyrNextCoord", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lineSizeLevel0"}], "]"}], ",", "level"}], "]"}],
         "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyrCoordFirstLast", "::", "usage"}], "=", 
   "\"\<\nreturn: first and last coordinates of a specific pyramid level.\n \
ATENTION: we need the lineSize of level 0 to figure out the coordinates of \
all following levels \n\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.832193873053037*^9, 3.832193884282445*^9}, {
  3.8321941219721975`*^9, 3.832194123558132*^9}, {3.8431573935082397`*^9, 
  3.843157409234243*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"c2cea440-ae33-49fc-a48b-3ae97e446dc9"],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"c44d453d-c60a-4cc9-b5fb-\
796e9aa2d504"],

Cell[BoxData[{
 RowBox[{"pyrNextCoord", "[", 
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", "8"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"pyrCoordFirstLast", "[", 
  RowBox[{"1", ",", "8"}], "]"}]}], "Input",
 CellChangeTimes->{{3.83240997669345*^9, 3.832410000877289*^9}, {
  3.832410031132039*^9, 3.832410031709365*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"20dfa0df-8d37-4be0-bef1-1ceb79fff9cb"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pyramid\[CloseCurlyQuote]s spline interpolation", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.83219365673135*^9, 3.832193665104113*^9}, {3.8321938281643553`*^9, 
  3.8321938400406*^9}, {3.8321941314798555`*^9, 3.832194148070655*^9}, {
  3.832194375747904*^9, 
  3.8321943844801683`*^9}},ExpressionUUID->"45bee8fd-0c33-4377-91a9-\
a8c9e867f32a"],

Cell["\<\
create a spline for the line containing y values, and coords contains the x \
coordinates of the values
  actually, only the first and last coords are used...\
\>", "Text",
 CellChangeTimes->{{3.832193854962858*^9, 3.832193862362031*^9}, {
  3.8321940785441856`*^9, 3.832194103899931*^9}, {3.832194187514305*^9, 
  3.8321942007184696`*^9}},ExpressionUUID->"f54d7360-52f8-4c0a-ac1c-\
a75ba6d66a89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"functionGen", "[", 
     RowBox[{"line_", ",", 
      RowBox[{"{", 
       RowBox[{"firstCoord_", ",", "___", ",", "lastCoord_"}], "}"}]}], "]"}],
     " ", ":=", " ", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "fline", "}"}], ",", " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fline", "=", 
         RowBox[{"ListInterpolation", "[", 
          RowBox[{"line", ",", " ", 
           RowBox[{"{", 
            RowBox[{"firstCoord", ",", "lastCoord"}], "}"}], ",", " ", 
           RowBox[{"Method", " ", "->", " ", "\"\<Spline\>\""}], ",", " ", 
           RowBox[{"InterpolationOrder", " ", "->", " ", "3"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"fline", ",", 
          RowBox[{"fline", "'"}]}], "}"}]}], "\[IndentingNewLine]", ")"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"functionGen", "::", "usage"}], "=", 
   "\"\<\ncreate a spline for the line containing y values, and coords \
contains the x coordinates of the values\n  actually, only the first and last \
coords are used...\n\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.832193873053037*^9, 3.832193884282445*^9}, {
   3.8321941219721975`*^9, 3.832194123558132*^9}, 3.832194216985752*^9, {
   3.832410136383348*^9, 3.832410155769808*^9}, {3.843157417675579*^9, 
   3.8431574320468554`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"6205c38d-7da4-40c5-bd24-37247ce19dec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pyramids generation", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.83219365673135*^9, 3.832193665104113*^9}, {3.8321938281643553`*^9, 
  3.8321938400406*^9}, {3.8321941314798555`*^9, 3.832194148070655*^9}, {
  3.832194375747904*^9, 3.8321943844801683`*^9}, {3.8321944460222735`*^9, 
  3.83219444884577*^9}},ExpressionUUID->"af2ad80b-ede8-4021-a2fa-\
abdd3b7857d0"],

Cell["\<\
 generate all pyramid lines
pyramid factor is hard-coded at 2
We assign coordinates 1..20 to a list of 20 values in line0.\
\>", "Text",
 CellChangeTimes->{{3.832193854962858*^9, 3.832193862362031*^9}, {
   3.8321940785441856`*^9, 3.832194103899931*^9}, {3.832194187514305*^9, 
   3.8321942007184696`*^9}, {3.8321944556082797`*^9, 3.8321944603991084`*^9}, 
   3.832243319580847*^9, {3.832410235773697*^9, 
   3.8324102584774218`*^9}},ExpressionUUID->"42829ba6-50e3-430b-a0ce-\
b5b9b5fb5209"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pyrFuncGen", "[", 
     RowBox[{"line0_", ",", "maxLevel_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"y", ",", "x"}], "}"}], ",", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"y", "=", 
         RowBox[{"NestList", "[", 
          RowBox[{"pyrNextLevel", ",", "line0", ",", "maxLevel"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"x", "=", 
         RowBox[{"NestList", "[", 
          RowBox[{"pyrNextCoord", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "line0", "]"}]}], "]"}], ",", 
           "maxLevel"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"functionGen", "[", 
           RowBox[{
            RowBox[{"y", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "y", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pyrFuncGen", "::", "usage"}], "=", 
   "\"\<\nInput= [Points to interpolate, max target lvl]\nOutput= {maxlvl+1, \
{f, df}}\n\>\""}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.832193873053037*^9, 3.832193884282445*^9}, {
   3.8321941219721975`*^9, 3.832194123558132*^9}, 3.832194216985752*^9, {
   3.832194466709077*^9, 3.832194482069251*^9}, {3.8322429436994133`*^9, 
   3.832242947178049*^9}, {3.8431574373528132`*^9, 3.8431574895989857`*^9}, 
   3.843157920826394*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"ac3258ce-3430-4c0a-be1c-f47c896d7018"],

Cell[CellGroupData[{

Cell["Test", "Subsection",
 CellChangeTimes->{{3.8322692006903553`*^9, 
  3.832269218824854*^9}},ExpressionUUID->"1584069f-09e6-432b-bb37-\
79ea53f0549d"],

Cell[BoxData[{
 RowBox[{"pyrf", "=", 
  RowBox[{"pyrFuncGen", "[", 
   RowBox[{"line", ",", "3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fontsize", "=", "16"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}], "&"}], "/@", 
     "pyrf"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", 
      RowBox[{"Length", "[", "line", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"AxesLabel", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<x\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", " ", 
         "Italic"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<I(x)\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", " ", 
         "Italic"}], "]"}]}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}], "&"}], "/@", "pyrf"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", 
     RowBox[{"Length", "[", "line", "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", "\[IndentingNewLine]", 
   RowBox[{"AxesLabel", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<x\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", " ", 
        "Italic"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<I(x)\>\"", ",", 
        RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", " ", 
        "Italic"}], "]"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.832248408711054*^9, 3.832248444013243*^9}, {
  3.8322485046551385`*^9, 3.8322485312161555`*^9}, {3.8322487145300455`*^9, 
  3.832248732210925*^9}, {3.832410565601493*^9, 3.8324105720637197`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"4162a1f9-caff-4e6f-a7fa-b4f2e9c35c05"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1152., 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8ba45a0d-4e12-47b9-a27c-9cfa4c35a5c1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 211, 4, 97, "Title",ExpressionUUID->"190398be-c937-4ed7-94c6-428d2100588a"],
Cell[794, 28, 300, 6, 28, "Input",ExpressionUUID->"2e087c91-d8a2-4aa6-9b33-fdc5df53d784"],
Cell[CellGroupData[{
Cell[1119, 38, 210, 4, 67, "Section",ExpressionUUID->"24c858df-4b1f-4d0c-a962-c1643450fe2c"],
Cell[1332, 44, 800, 21, 88, "Input",ExpressionUUID->"e765c651-d581-4a5e-af12-87d1b3d2f30d"]
}, Closed]],
Cell[CellGroupData[{
Cell[2169, 70, 164, 3, 53, "Section",ExpressionUUID->"fb8484bf-4867-4a1a-b0c1-5612010c9610"],
Cell[2336, 75, 233, 4, 35, "Text",ExpressionUUID->"ddee2555-a5ed-4a74-94e4-54c1f49f8abe"],
Cell[2572, 81, 851, 22, 123, "Input",ExpressionUUID->"61a682cb-21a6-44ff-a813-622bc47fef77",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3448, 107, 154, 3, 54, "Subsection",ExpressionUUID->"96a0f44f-c321-4523-bc44-ff4a06b75261"],
Cell[CellGroupData[{
Cell[3627, 114, 364, 5, 28, "Input",ExpressionUUID->"aa2f4645-bf37-4487-8f3a-d85d6c85891d"],
Cell[3994, 121, 267, 5, 32, "Output",ExpressionUUID->"17e11fc0-b3bd-4903-a1a3-b2ca773cd8c1"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4322, 133, 287, 4, 67, "Section",ExpressionUUID->"a1fb13ed-30d8-4a55-8660-795c8619b76c"],
Cell[4612, 139, 419, 8, 58, "Text",ExpressionUUID->"074122c8-5c82-4b8a-91e2-72263e658b64"],
Cell[5034, 149, 2312, 47, 201, "Input",ExpressionUUID->"5d894479-7829-49c9-8437-a5521cc7385b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[7371, 200, 154, 3, 54, "Subsection",ExpressionUUID->"fe709cae-cb4d-4e01-9350-a4984b71c21f"],
Cell[7528, 205, 787, 15, 49, "Input",ExpressionUUID->"c3b0fcaf-81b8-4b54-a9d0-ade9379a4c23"]
}, Closed]],
Cell[CellGroupData[{
Cell[8352, 225, 154, 3, 38, "Subsection",ExpressionUUID->"abf8e10f-23d0-494e-89c9-2adee75a39f1"],
Cell[8509, 230, 521, 9, 68, "Input",ExpressionUUID->"9333efd0-c0eb-493b-8f4c-d8a77c592c4f"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9079, 245, 291, 3, 67, "Section",ExpressionUUID->"cc8a59fd-c067-4566-8107-9b571d8dfaef"],
Cell[9373, 250, 316, 7, 58, "Text",ExpressionUUID->"0fe83b93-9f60-4609-81a8-75632d6e57d3"],
Cell[9692, 259, 2385, 55, 260, "Input",ExpressionUUID->"7b40c924-37d0-4c8d-a452-6d803c65d64c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[12102, 318, 154, 3, 54, "Subsection",ExpressionUUID->"f4d4de17-4e48-4526-85f7-cc2b9a20af89"],
Cell[12259, 323, 788, 18, 85, "Input",ExpressionUUID->"3ce396b6-d35f-4914-886a-16ed63e46960"]
}, Closed]],
Cell[CellGroupData[{
Cell[13084, 346, 154, 3, 38, "Subsection",ExpressionUUID->"dd039da5-64c6-49b8-85a0-5d8eb1bd94c7"],
Cell[13241, 351, 462, 10, 27, "Input",ExpressionUUID->"361aa883-c1a7-414d-822f-5321e1c071d7"]
}, Closed]],
Cell[CellGroupData[{
Cell[13740, 366, 154, 3, 38, "Subsection",ExpressionUUID->"92f99e69-8c1e-41f6-a207-5ccd1d60764c"],
Cell[13897, 371, 198, 3, 27, "Input",ExpressionUUID->"2b93c655-5d72-4168-91b4-cc3b3122bddd"],
Cell[14098, 376, 769, 21, 65, "Input",ExpressionUUID->"aaa2c59c-dc79-4fa2-9c93-533e21bf082c"],
Cell[14870, 399, 200, 3, 27, "Input",ExpressionUUID->"87c15ebe-a2e1-4238-9a1c-2c31e28eabea"],
Cell[15073, 404, 805, 20, 65, "Input",ExpressionUUID->"e9302d98-9762-4e1c-9f56-c3b5450d32fd"],
Cell[15881, 426, 249, 4, 27, "Input",ExpressionUUID->"f5d2613a-5076-425d-9041-635c652f42f5"],
Cell[16133, 432, 826, 20, 65, "Input",ExpressionUUID->"da93a991-3cff-4b22-a8ba-cbe2a6c5f2c8"],
Cell[16962, 454, 483, 10, 27, "Input",ExpressionUUID->"5e2d0221-ca96-45e6-b462-756784c826ac"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17494, 470, 347, 5, 67, "Section",ExpressionUUID->"a1884d1b-aec7-4a3b-bfb9-cb991f0d4360"],
Cell[17844, 477, 364, 8, 58, "Text",ExpressionUUID->"59e23d5a-daf0-4f62-8116-28bcfe776d2a"],
Cell[18211, 487, 1268, 32, 182, "Input",ExpressionUUID->"c2cea440-ae33-49fc-a48b-3ae97e446dc9",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[19504, 523, 154, 3, 54, "Subsection",ExpressionUUID->"c44d453d-c60a-4cc9-b5fb-796e9aa2d504"],
Cell[19661, 528, 410, 8, 47, "Input",ExpressionUUID->"20dfa0df-8d37-4be0-bef1-1ceb79fff9cb"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20120, 542, 392, 6, 67, "Section",ExpressionUUID->"45bee8fd-0c33-4377-91a9-a8c9e867f32a"],
Cell[20515, 550, 407, 8, 58, "Text",ExpressionUUID->"f54d7360-52f8-4c0a-ac1c-a75ba6d66a89"],
Cell[20925, 560, 1616, 37, 221, "Input",ExpressionUUID->"6205c38d-7da4-40c5-bd24-37247ce19dec",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[22578, 602, 411, 6, 67, "Section",ExpressionUUID->"af2ad80b-ede8-4021-a2fa-abdd3b7857d0"],
Cell[22992, 610, 501, 10, 81, "Text",ExpressionUUID->"42829ba6-50e3-430b-a0ce-b5b9b5fb5209"],
Cell[23496, 622, 1903, 47, 221, "Input",ExpressionUUID->"ac3258ce-3430-4c0a-be1c-f47c896d7018",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25424, 673, 154, 3, 54, "Subsection",ExpressionUUID->"1584069f-09e6-432b-bb37-79ea53f0549d"],
Cell[25581, 678, 2468, 63, 185, "Input",ExpressionUUID->"4162a1f9-caff-4e6f-a7fa-b4f2e9c35c05"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

