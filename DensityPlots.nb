(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87740,       2093]
NotebookOptionsPosition[     80608,       1977]
NotebookOutlinePosition[     81149,       1997]
CellTagsIndexPosition[     81106,       1994]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Density Plot", "Title",
 CellChangeTimes->{{3.836408933336395*^9, 3.836408939343516*^9}, 
   3.8364092608930736`*^9, {3.839597016893468*^9, 3.839597019185139*^9}, 
   3.8396001415844855`*^9, {3.840547036727909*^9, 3.8405470374003563`*^9}, {
   3.8431583610963435`*^9, 3.8431583669555917`*^9}, {3.8435589181641517`*^9, 
   3.8435589198932934`*^9}, {3.843571221954747*^9, 
   3.8435712284051995`*^9}},ExpressionUUID->"a09f1ec7-5059-44a7-a761-\
ac5c70f29164"],

Cell[BoxData[{
 RowBox[{"packageDirectory", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<1DPackage\>\"", ",", 
     "\"\<*\>\""}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"$Path", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"$Path", ",", 
    RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.8436691189498873`*^9, 3.843669252866984*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"8e43c757-a6c7-4d6e-aa00-d64500748adf"],

Cell[CellGroupData[{

Cell["Start", "Section",
 CellChangeTimes->{{3.8400383593859367`*^9, 3.8400383615886106`*^9}, {
  3.8433207191908846`*^9, 
  3.8433207198782096`*^9}},ExpressionUUID->"9e578964-cb44-43a4-a98e-\
14fb51d3aa1d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"$FrontEndSession", ",", 
    RowBox[{"NotebookAutoSave", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"NotebookSave", "[", "]"}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.8405470443985357`*^9, 3.841496081756846*^9, {3.843158352056238*^9, 
   3.8431583523965025`*^9}, {3.843668744094178*^9, 3.843668744576977*^9}, {
   3.843668995460195*^9, 3.84366900185364*^9}, {3.843669811249239*^9, 
   3.843669812805167*^9}},ExpressionUUID->"25a8476a-d820-47d4-adf9-\
b6a1da3d55b6"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramidalStereoAll`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<PixelTest`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<LineTest`\>\""}]}], "Input",
 CellChangeTimes->{{3.8405470666010065`*^9, 3.8405470721952195`*^9}, {
   3.840550195734952*^9, 3.840550216899179*^9}, {3.8417693956828256`*^9, 
   3.8417694295737267`*^9}, 3.8417694792252483`*^9, {3.8423558358531294`*^9, 
   3.842355838266631*^9}, {3.843139686906508*^9, 3.8431397006034536`*^9}, 
   3.8431400354897623`*^9, {3.8431583092259803`*^9, 3.843158312433055*^9}, {
   3.8431587050542717`*^9, 3.8431587088646235`*^9}, {3.8432405156973643`*^9, 
   3.8432405180756235`*^9}, {3.8432434086403227`*^9, 3.8432434521650333`*^9}, 
   3.8435782726566043`*^9, 3.8435783785411777`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"948cfa84-6d40-4231-915d-df703bf392be"],

Cell[BoxData[
 RowBox[{"baseSINTEL", "=", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "$UserName", ",", "\[IndentingNewLine]", "\"\<fieri\>\"", ",", 
    "\"\<D:\\\\MastersMathematica\\\\Data\\\\Sintel\>\"", ",", 
    "\[IndentingNewLine]", "\"\<roys\>\"", ",", 
    "\"\</home/roys/datasets/SINTEL-stereo\>\""}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.843668901137033*^9, 3.843668912182694*^9}, {
  3.843669300631761*^9, 3.843669383555538*^9}, {3.8436694647767344`*^9, 
  3.843669469735959*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"cc39dffe-27e6-4c48-8eff-c96b163f46cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["read", "Section",
 CellChangeTimes->{{3.8400383593859367`*^9, 
  3.8400383615886106`*^9}},ExpressionUUID->"7e632af5-bbd1-492c-a363-\
6ee34f85c7fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"read", "[", 
    RowBox[{"set_", ",", "num_", ",", "reduce_", ",", "corf_"}], "]"}], ":=", 
   
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ia", ",", "ib", ",", "id", ",", "rgb2d", ",", "reduire", ",", "clean", 
       ",", "io", ",", "left", ",", "right", ",", "disp", ",", "occ", ",", 
       " ", "frame", ",", " ", "base", ",", "fileleft", ",", "fileright"}], 
      "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"frame", "=", 
        RowBox[{"\"\<frame_\>\"", "<>", "num", "<>", "\"\<.png\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fileleft", "=", 
        RowBox[{"corf", "<>", "\"\<_left\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fileright", "=", 
        RowBox[{"corf", "<>", "\"\<_right\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"left", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "fileleft", ",", "set", 
           ",", "frame"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"right", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "fileright", ",", "set",
            ",", "frame"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"disp", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "\"\<disparities\>\"", 
           ",", "set", ",", "frame"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"occ", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
          "baseSINTEL", ",", "\"\<training\>\"", ",", "\"\<occlusions\>\"", 
           ",", "set", ",", "frame"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rgb2d", "[", 
         RowBox[{"{", 
          RowBox[{"r_", ",", "g_", ",", "b_"}], "}"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"r", "*", "4"}], "+", 
         RowBox[{"g", "/", "64"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"clean", "[", "img_", "]"}], ":=", 
        RowBox[{"Image", "[", 
         RowBox[{"ImageData", "[", "img", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reduire", "[", 
         RowBox[{"img_", ",", "1"}], "]"}], ":=", "img"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reduire", "[", 
         RowBox[{"img_", ",", "factor_"}], "]"}], ":=", 
        RowBox[{"ImageResize", "[", 
         RowBox[{"img", ",", 
          RowBox[{
           RowBox[{"ImageDimensions", "[", "img", "]"}], "/", "factor"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ia", "=", 
        RowBox[{"reduire", "[", 
         RowBox[{
          RowBox[{"ColorConvert", "[", 
           RowBox[{
            RowBox[{"clean", "@", 
             RowBox[{"Import", "[", "left", "]"}]}], ",", 
            "\"\<GrayScale\>\""}], "]"}], ",", "reduce"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ib", "=", 
        RowBox[{"reduire", "[", 
         RowBox[{
          RowBox[{"ColorConvert", "[", 
           RowBox[{
            RowBox[{"clean", "@", 
             RowBox[{"Import", "[", "right", "]"}]}], ",", 
            "\"\<GrayScale\>\""}], "]"}], ",", "reduce"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"id", "=", 
        RowBox[{
         RowBox[{"reduire", "[", 
          RowBox[{
           RowBox[{"Image", "[", "\[IndentingNewLine]", 
            RowBox[{"rgb2d", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"N", "@", 
                RowBox[{"ImageData", "[", 
                 RowBox[{
                  RowBox[{"clean", "@", 
                   RowBox[{"Import", "[", "disp", "]"}]}], ",", 
                  "\"\<Byte\>\""}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "3", "}"}], ",", 
                 RowBox[{"{", "1", "}"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}], "]"}], 
            "\[IndentingNewLine]", "]"}], ",", "reduce"}], "]"}], "/", 
         "reduce"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"io", "=", 
        RowBox[{"reduire", "[", 
         RowBox[{
          RowBox[{"ColorConvert", "[", 
           RowBox[{
            RowBox[{"clean", "@", 
             RowBox[{"Import", "[", "occ", "]"}]}], ",", 
            "\"\<GrayScale\>\""}], "]"}], ",", "reduce"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"read", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"left", ",", "right", ",", "disp", ",", "occ"}], "}"}], 
          ",", "reduce"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}], 
      "\[IndentingNewLine]", ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.839600208504036*^9, 3.8396003909770975`*^9, {3.8400348675272875`*^9, 
   3.8400350342853246`*^9}, {3.8436694187610807`*^9, 3.8436694394140263`*^9}},
 
 CellLabel->"In[43]:=",ExpressionUUID->"26dc27af-7dcd-4628-ad5e-4cc0a6a0579c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Design", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.8396043559414663`*^9, 
   3.839604357912614*^9}},ExpressionUUID->"723a872d-fa08-422b-b2b4-\
1a1a858e9e13"],

Cell[CellGroupData[{

Cell["Pythagoras", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.8435628529917016`*^9, 
   3.843562853963793*^9}, {3.843569312282384*^9, 
   3.84356931480581*^9}},ExpressionUUID->"e3be4378-c578-486e-a93e-\
e0dec4424685"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pyth", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"x", "^", "2"}], "+", 
     RowBox[{"y", "^", "2"}]}], ")"}], "]"}]}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"81973cf9-7f6a-4dd6-90b1-613f8cdc07b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RMSE", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.8435628529917016`*^9, 
   3.843562853963793*^9}},ExpressionUUID->"ff13a019-eaaf-4b2c-ac40-\
3aa325ff16ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rmse", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"N", "@", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"Mean", "[", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"x", "-", "y"}], ",", "2"}], "]"}], "]"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.8435628649538884`*^9, 3.84356289743945*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"7a55e7f9-2143-4ece-86b3-47220a4217b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Little Functions", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 
   3.8433080681141663`*^9}},ExpressionUUID->"3b31a1e8-defb-407b-b38d-\
4a817075ee82"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pyrfi", "[", 
   RowBox[{"ia_", ",", "ib_", ",", "row_", ",", "lvlmax_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pyrfia", ",", "pyrfib"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pyrfia", "=", 
      RowBox[{"pyrFuncGen", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ImageData", "[", "ia", "]"}], "[", 
         RowBox[{"[", "row", "]"}], "]"}], ",", " ", "lvlmax"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"pyrfib", "=", 
      RowBox[{"pyrFuncGen", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ImageData", "[", "ib", "]"}], "[", 
         RowBox[{"[", "row", "]"}], "]"}], ",", "lvlmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pyrfia", ",", "pyrfib"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.84313892088904*^9, 3.8431390761722784`*^9}, {
   3.8431392570148835`*^9, 3.843139273697956*^9}, {3.8431590848455114`*^9, 
   3.84315912015506*^9}, {3.843159154421751*^9, 3.843159154684618*^9}, 
   3.843159972594839*^9, {3.843224134943307*^9, 3.8432241373889875`*^9}, {
   3.843238887570883*^9, 3.8432388887128267`*^9}, {3.843244470687603*^9, 
   3.843244471083666*^9}, {3.843245943522396*^9, 3.843245953156348*^9}, 
   3.8432471526931915`*^9, 3.8432472029964914`*^9, 3.843247273562867*^9, {
   3.8432484084228573`*^9, 3.8432484087823677`*^9}, {3.8433081379635553`*^9, 
   3.843308241907001*^9}, {3.8433083959863462`*^9, 3.843308396126707*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"3a65afc6-732c-4083-9fd9-cff42128fd74"]
}, Closed]],

Cell[CellGroupData[{

Cell["count colors", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.8435593508255844`*^9}},ExpressionUUID->"21333ac8-aab1-4d6b-84e9-\
29783a0b619f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Counts", " ", "the", " ", "amount", " ", "of", " ", "colors", " ", "in", 
    " ", "solution"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"countColors", "[", "v_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "count", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ImageScan", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mean", "[", "#", "]"}], "\[NotEqual]", "0"}], ",", 
           RowBox[{"count", "++"}]}], "]"}], "&"}], ",", "v"}], "]"}], ";", 
      "\[IndentingNewLine]", "count"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8400336304540234`*^9, 3.8400336797908187`*^9}, 
   3.8400337423857036`*^9, 3.8400339269911633`*^9, {3.8400340382734385`*^9, 
   3.8400340501609755`*^9}, {3.840034491707554*^9, 3.840034507385169*^9}, {
   3.840122233033599*^9, 3.840122234272025*^9}, {3.840286824384574*^9, 
   3.840286824646947*^9}, {3.8402882774442463`*^9, 3.8402882902675805`*^9}, {
   3.8405549435715485`*^9, 3.840554948616949*^9}, {3.8405557842185664`*^9, 
   3.840555804650894*^9}, {3.840890884336002*^9, 3.840890885344373*^9}, {
   3.8423801413471007`*^9, 3.8423801422687283`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"5abc2659-dc82-4792-b94c-84a80f1b859a"]
}, Closed]],

Cell[CellGroupData[{

Cell["N tests", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.84355938026787*^9}},ExpressionUUID->"d33767c5-d87c-45be-9651-\
664c7e7d25ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Error", " ", "is", " ", "updated", " ", "depending", " ", "in", " ", 
    "the", " ", "highest", " ", "res", " ", "level"}], " ", "*)"}], 
  RowBox[{
   RowBox[{"test1", "[", 
    RowBox[{"ia_", ",", "ib_", ",", "lvlmax_", ",", "e_", ",", "mode_"}], 
    "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"(", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stereoDepth", "[", 
         RowBox[{"ia", ",", "ib", ",", "lvlmax", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "i"}], "}"}], ",", "e", ",", "mode"}], "]"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "lvlmax"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8396043718899903`*^9, 3.8396043735176196`*^9}, {
   3.839604432337651*^9, 3.839604488434334*^9}, {3.839604568238022*^9, 
   3.839604786437807*^9}, {3.8396048574565325`*^9, 3.8396048798443003`*^9}, {
   3.8396050659895935`*^9, 3.839605123271159*^9}, 3.839605249104582*^9, {
   3.839605309454554*^9, 3.839605310569953*^9}, {3.839605543224831*^9, 
   3.839605552486551*^9}, {3.839606951942525*^9, 3.8396069540609317`*^9}, {
   3.840286095596109*^9, 3.8402861285211997`*^9}, {3.8402861662761436`*^9, 
   3.8402861856590576`*^9}, {3.8402872776654205`*^9, 3.840287296400854*^9}, {
   3.8402882952283196`*^9, 3.840288354416576*^9}, {3.8405501658373513`*^9, 
   3.8405501881113462`*^9}, {3.840576166691247*^9, 3.8405761810323343`*^9}, {
   3.8405781840960283`*^9, 3.840578189691923*^9}, {3.840579273984714*^9, 
   3.8405793020158105`*^9}, {3.840579496843993*^9, 3.8405794984876966`*^9}, {
   3.84089587874543*^9, 3.8408959051686354`*^9}, {3.8408966352631397`*^9, 
   3.84089667009838*^9}, {3.8414962799020815`*^9, 3.8414963054084015`*^9}, {
   3.8418578009884644`*^9, 3.8418578023941636`*^9}, {3.8423801480330305`*^9, 
   3.842380160373893*^9}, {3.8425509766290684`*^9, 3.8425509847238283`*^9}, {
   3.8425510525488095`*^9, 3.8425511058345637`*^9}, {3.842552480219551*^9, 
   3.842552506521083*^9}, {3.8430719323722086`*^9, 3.8430719327531204`*^9}, {
   3.843223977664674*^9, 3.843223978732512*^9}, {3.84355997401611*^9, 
   3.8435600602026043`*^9}, {3.843560118908744*^9, 3.843560151969054*^9}, 
   3.84356027567049*^9},
 CellLabel->"In[48]:=",ExpressionUUID->"7e17f637-14e5-4463-83c7-4acad6c91dfe"]
}, Closed]],

Cell[CellGroupData[{

Cell["results ", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.84355938026787*^9}, {3.8435614896642585`*^9, 
   3.8435615086053314`*^9}},ExpressionUUID->"8da24f70-1bf4-4917-bd54-\
db5d84c90070"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res1Display", "[", 
   RowBox[{"res1_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "maxid", ",", "flipMask", ",", " ", "signMask", ",", " ", "magMask", ",",
       " ", "okMask", ",", " ", "convergedMask", ",", "imageConverged", ",", 
      " ", "imageOk", ",", " ", "imageFlip", ",", " ", "imageSign", ",", " ", 
      "imageMag"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"maxid", "=", 
       RowBox[{
        RowBox[{"MinMax", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"npixels", "=", 
       RowBox[{"103.", "*", "45."}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "\"\<converged\>\"", ",", " ", "\"\<ok\>\"", ",", "\"\<oksign\>\"", 
        ",", "\"\<flip\>\"", ",", "\"\<sign\>\"", ",", "\"\<mag\>\""}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"flipMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Orange"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"signMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"magMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Purple"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"okMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "\[Rule]", "Pink"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Blue"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"convergedMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "\[Rule]", "Green"}], ",", 
         RowBox[{"\"\<ok\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"imageConverged", "=", 
          RowBox[{"Image", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
            "convergedMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"imageOk", "=", 
          RowBox[{"Image", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
            "okMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"imageFlip", "=", 
          RowBox[{"Image", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
            "flipMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"imageSign", "=", 
          RowBox[{"Image", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
            "signMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"imageMag", "=", 
          RowBox[{"Image", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
            "magMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"lst1", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"-", 
            RowBox[{"res", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"lst2", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ImageData", "[", "id", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"res", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}],
                 ",", "#"}], "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{
              "\"\<sign\>\"", ",", "\"\<mag\>\"", ",", "\"\<flip\>\"", ",", 
               "\"\<ok\>\"", ",", "\"\<oksign\>\""}], "}"}]}], ",", "1"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lst11", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"lst1", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lst22", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"lst2", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Image", "[", 
             RowBox[{"-", 
              RowBox[{"res", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}], 
            "/", 
            RowBox[{"(", "maxid", ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"id", "/", 
            RowBox[{"(", "maxid", ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "imageConverged", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"countColors", "[", "imageConverged", "]"}], "}"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "imageOk", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"countColors", "[", "imageOk", "]"}], "}"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "imageFlip", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"countColors", "[", "imageFlip", "]"}], "}"}]}], "}"}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "imageSign", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"countColors", "[", "imageSign", "]"}], "}"}]}], "}"}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "imageMag", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"countColors", "[", "imageMag", "]"}], "}"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"rmse", "[", 
            RowBox[{"lst11", ",", "lst22"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rmse", "[", 
            RowBox[{"lst1", ",", "lst2"}], "]"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"1.", "/", 
            RowBox[{"countColors", "[", "imageConverged", "]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"res", ",", " ", "res1"}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8435617762793627`*^9, 3.843561778812292*^9}, {
   3.8435618227389984`*^9, 3.8435620915920067`*^9}, {3.843562129825905*^9, 
   3.843562230592733*^9}, {3.84356264425098*^9, 3.843562712105337*^9}, {
   3.8435627829392986`*^9, 3.843562784690528*^9}, {3.843562915092589*^9, 
   3.8435629453606105`*^9}, {3.8435630151037483`*^9, 3.843563119876939*^9}, {
   3.8435631781514177`*^9, 3.8435632148762255`*^9}, {3.8435632484895177`*^9, 
   3.843563252579732*^9}, {3.843565652879899*^9, 3.8435656568498487`*^9}, {
   3.8435656968102627`*^9, 3.8435656996349277`*^9}, {3.843565734303153*^9, 
   3.8435658063457155`*^9}, {3.843566112660023*^9, 3.843566113046097*^9}, 
   3.843566335035142*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"91ddb515-361c-4b0c-94ca-ef2c02094f33"]
}, Closed]],

Cell[CellGroupData[{

Cell["Display of results", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.843559410786008*^9}},ExpressionUUID->"1474df71-9d6e-414c-bca7-\
7bec8ee1f77d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res2ColorCode", "[", 
   RowBox[{"result_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"minmaxid", "=", 
       RowBox[{"MinMax", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"seeStatus", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
           RowBox[{"\"\<ok\>\"", "->", "Transparent"}], ",", 
           RowBox[{"\"\<flip\>\"", "->", "Red"}], ",", 
           RowBox[{"\"\<sign\>\"", "->", "Purple"}], ",", 
           RowBox[{"\"\<mag\>\"", "->", "Yellow"}]}], "}"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"flipMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Orange"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"signMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Red"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"magMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Purple"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"okMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "->", "Transparent"}], ",", 
         RowBox[{"\"\<ok\>\"", "\[Rule]", "Pink"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Blue"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"convergedMask", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<converged\>\"", "\[Rule]", "Green"}], ",", 
         RowBox[{"\"\<ok\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<flip\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<sign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<oksign\>\"", "\[Rule]", "Transparent"}], ",", 
         RowBox[{"\"\<mag\>\"", "\[Rule]", "Transparent"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"imageConverged", "=", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
         "convergedMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageOk", "=", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
         "okMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageFlip", "=", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
         "flipMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageSign", "=", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
         "signMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"imageMag", "=", 
       RowBox[{"Image", "[", 
        RowBox[{
         RowBox[{"result", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "/.", 
         "magMask"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Image", "[", 
          RowBox[{"-", 
           RowBox[{"result", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], "]"}], 
         "/", 
         RowBox[{"(", 
          RowBox[{"minmaxid", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"id", "/", 
         RowBox[{"(", 
          RowBox[{"minmaxid", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "imageConverged", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"countColors", "[", "imageConverged", "]"}], "}"}]}], 
          "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "imageOk", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"countColors", "[", "imageOk", "]"}], "}"}]}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "imageFlip", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"countColors", "[", "imageFlip", "]"}], "}"}]}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "imageSign", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"countColors", "[", "imageSign", "]"}], "}"}]}], "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Grid", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "imageMag", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"countColors", "[", "imageMag", "]"}], "}"}]}], "}"}], 
         "]"}]}], "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8433070045877094`*^9, 3.8433070833261366`*^9}, {
  3.8433071430686703`*^9, 3.8433071841138315`*^9}, {3.843307228876261*^9, 
  3.8433072870587854`*^9}, {3.843307425343623*^9, 3.843307431293394*^9}, {
  3.8433151866615024`*^9, 3.8433152967266083`*^9}, {3.843315327507221*^9, 
  3.84331535466228*^9}, {3.843315433836309*^9, 3.8433154405436673`*^9}, {
  3.8433155573887577`*^9, 3.8433155588728237`*^9}, {3.8433156058098435`*^9, 
  3.8433156098613095`*^9}, {3.8433156797810273`*^9, 3.8433156849290247`*^9}, {
  3.8433157645505686`*^9, 3.8433158311515846`*^9}, {3.8433162077371306`*^9, 
  3.843316210954539*^9}, {3.8433162815160255`*^9, 3.843316365688272*^9}, {
  3.8433167359845467`*^9, 3.843316736203251*^9}, {3.8433257690526237`*^9, 
  3.84332582683218*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"97b5fba1-2a6f-4c53-96a1-facf3428dc8f"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data ", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, 
   3.843559573693731*^9},ExpressionUUID->"dc60e2b1-f53e-4d00-a5fe-\
f391579f1fae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "downscaling", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
    RowBox[{"read", "[", 
     RowBox[{
     "\"\<bamboo_1\>\"", ",", "\"\<0001\>\"", ",", "r", ",", 
      "\"\<clean\>\""}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"a", " ", "reduction", " ", "of", " ", "6", " ", "is", " ", 
     RowBox[{"{", 
      RowBox[{"173", ",", "73"}], "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ImageCrop", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{"173", ",", "73"}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "44"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "102"}], "}"}], " ", "arbitrary", " ", "size", " ", 
      "to", " ", "make", " ", "the", " ", "method", " ", "faster"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nx", "=", 
     RowBox[{"150", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ny", "=", 
     RowBox[{"300", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ImageTake", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"ny", ",", 
          RowBox[{"ny", "+", "44"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nx", ",", 
          RowBox[{"nx", "+", "102"}]}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageDimensions", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ic", "=", 
    RowBox[{"move", "[", 
     RowBox[{"ia", ",", 
      RowBox[{"-", "7"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"max", "=", 
    RowBox[{
     RowBox[{"MinMax", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8396003256274347`*^9, 3.8396003578541155`*^9}, {
   3.839600425157134*^9, 3.8396004649983077`*^9}, {3.8396005389856977`*^9, 
   3.839600546649743*^9}, {3.8396011310882244`*^9, 3.839601134217896*^9}, 
   3.8396012905419645`*^9, {3.839602379561987*^9, 3.8396025339818263`*^9}, {
   3.840030499151252*^9, 3.8400306375625215`*^9}, {3.8400306711677523`*^9, 
   3.840030786190072*^9}, {3.8400308169412627`*^9, 3.840030833862471*^9}, {
   3.8400350426178727`*^9, 3.840035052697755*^9}, {3.8400350831828794`*^9, 
   3.8400351032596345`*^9}, {3.840039523687764*^9, 3.840039537444194*^9}, {
   3.841850521286316*^9, 3.841850524629063*^9}, {3.841857096634764*^9, 
   3.841857101118085*^9}, {3.84236669596311*^9, 3.8423668010730586`*^9}, {
   3.842376748243607*^9, 3.8423767597409086`*^9}, {3.8424572545027933`*^9, 
   3.842457267312318*^9}, {3.8424573743497686`*^9, 3.84245737461509*^9}, {
   3.8425357199254*^9, 3.84253572055615*^9}, {3.842537371210945*^9, 
   3.842537393306739*^9}, {3.8425374570660744`*^9, 3.8425374724005938`*^9}, {
   3.843069884562885*^9, 3.8430698851803913`*^9}, {3.843070017802307*^9, 
   3.843070018504942*^9}, {3.8430701500477524`*^9, 3.843070151944578*^9}, {
   3.8431394433950195`*^9, 3.843139449261375*^9}, {3.8431395263067265`*^9, 
   3.8431395360389404`*^9}, {3.8431598926882296`*^9, 3.843159926862395*^9}, 
   3.843224358896107*^9, {3.8435595774377785`*^9, 3.843559584978368*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"b9b43223-56d8-4058-a79a-123459ba4789"],

Cell[BoxData[{
 RowBox[{"Histogram", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"minmaxid", "=", 
  RowBox[{"MinMax", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.8396004123869095`*^9, {3.839600672774662*^9, 3.839600683549505*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"34dc2cc2-3b24-41f9-8779-de6d2091bb41"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculating results", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8432444128743267`*^9, 
   3.8432444151784225`*^9}, {3.843559434930586*^9, 
   3.843559438099536*^9}},ExpressionUUID->"30d9029f-7819-4092-b9eb-\
d6d25e583017"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"e", "=", "0.03"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lvls", "=", "7"}], ";"}]}], "Input",
 CellChangeTimes->{{3.843560169472889*^9, 3.8435601894730453`*^9}, {
   3.843568119109782*^9, 3.8435681193240623`*^9}, 3.8435749326061783`*^9, 
   3.8435750752699127`*^9, 3.8435872123947363`*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"d95bd0b1-e922-4716-8831-de2416e81d66"],

Cell[CellGroupData[{

Cell["Over Constrained {1, n} test", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.843559410786008*^9}, {3.843559456682927*^9, 3.8435594601493797`*^9}, {
   3.8435604399200315`*^9, 3.8435604403199635`*^9}, {3.843568061242906*^9, 
   3.843568065734262*^9}},ExpressionUUID->"804e40e4-80cf-4051-a4d8-\
4bc32713e58f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mode", "=", "\"\<OverConstrained\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.843560210521414*^9, 3.8435602241167946`*^9}, {
  3.8435604347334003`*^9, 3.8435604383644085`*^9}, {3.843568071624194*^9, 
  3.8435680717982306`*^9}, {3.843568118158429*^9, 3.8435681214649086`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"cdd3cdcc-e8be-4411-bd4b-cf2075797874"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["res1", "mode"], "=", 
   RowBox[{"test1", "[", 
    RowBox[{"ia", ",", "ib", ",", " ", "lvls", ",", "e", ",", "mode"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435596242336655`*^9, 3.8435596572144327`*^9}, {
   3.843560072562766*^9, 3.843560164356756*^9}, {3.8435601971723137`*^9, 
   3.8435602217565603`*^9}, {3.8435610273207684`*^9, 3.8435610575702786`*^9}, 
   3.8435660433910017`*^9, 3.843566187576016*^9, {3.8435674008202267`*^9, 
   3.843567408871667*^9}, 3.8435674768425393`*^9, {3.843568068632105*^9, 
   3.843568073878681*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[64]:=",ExpressionUUID->"39709794-9dda-4ee2-8f3c-848ed9b065b4"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["res1Dis", "mode"], "=", 
  RowBox[{"res1Display", "[", 
   RowBox[{
    SubscriptBox["res1", "mode"], ",", "id"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8435627257512913`*^9, 3.843562760052611*^9}, {
   3.84356558852423*^9, 3.843565603419176*^9}, 3.8435660328393927`*^9, 
   3.8435663003371277`*^9, 3.8435858998824434`*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"885faa68-92f6-4743-87a0-c39e1c0660cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["errorRMSE", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "3"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["density", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8435656233124614`*^9, 3.8435656250585213`*^9}, {
  3.843565852386916*^9, 3.843565923384411*^9}, {3.843566355545126*^9, 
  3.8435663702762613`*^9}, {3.8435664068160334`*^9, 3.8435664087286477`*^9}, {
  3.8435672089751215`*^9, 3.843567218290592*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"a409475b-08b1-4f46-bce1-080d91447eea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["densityRes", "mode"], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["density", "mode"], ",", 
       SubscriptBox["errorRMSE", "mode"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435671054746866`*^9, 3.8435671986510954`*^9}, {
   3.8435672326070848`*^9, 3.843567254797406*^9}, 3.843568084571852*^9},
 CellLabel->"In[68]:=",ExpressionUUID->"c9f819ed-1356-40ab-8f13-690e318de90a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"offset", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxX", ",", "maxY"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8435677891281443`*^9, 3.843567936678544*^9}, {
  3.843567988966451*^9, 3.8435680003405094`*^9}, {3.843568031021259*^9, 
  3.8435680351858425`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"c7d95468-930f-4534-b8d3-e06b10695219"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     SubscriptBox["densityRes", "mode"], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"maxX", "+", "0.001"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"maxY", "+", "1"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "@", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], "&"}], "/@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "n"}], "}"}], ",", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8435672232999535`*^9, 3.8435672393401055`*^9}, {
  3.843567312812736*^9, 3.8435673137976546`*^9}, {3.8435673803458414`*^9, 
  3.8435674659125233`*^9}, {3.843567537004793*^9, 3.8435675601257534`*^9}, {
  3.8435675946799755`*^9, 3.843567734096695*^9}, {3.8435677760244064`*^9, 
  3.8435678125011306`*^9}, {3.843567906391761*^9, 3.843568040248789*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"89a18cb4-2e52-42c6-936e-8b19fdfe9077"]
}, Closed]],

Cell[CellGroupData[{

Cell["Semi Constrained {1, n} test", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.843559410786008*^9}, {3.843559456682927*^9, 3.8435594601493797`*^9}, {
   3.8435604399200315`*^9, 3.8435604403199635`*^9}, {3.843568061242906*^9, 
   3.843568065734262*^9}, {3.8435681654299407`*^9, 
   3.8435681662043576`*^9}},ExpressionUUID->"f29f8f92-4c88-46d9-8d15-\
f6ff740b8c00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mode", "=", "\"\<SemiConstrained\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.843560210521414*^9, 3.8435602241167946`*^9}, {
  3.8435604347334003`*^9, 3.8435604383644085`*^9}, {3.843568071624194*^9, 
  3.8435680717982306`*^9}, {3.843568118158429*^9, 3.8435681214649086`*^9}, {
  3.843568168738282*^9, 3.843568169477273*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"6a9690fd-c57a-4cdb-8f0c-42b6601d123e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["res1", "mode"], "=", 
   RowBox[{"test1", "[", 
    RowBox[{"ia", ",", "ib", ",", " ", "lvls", ",", "e", ",", "mode"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435596242336655`*^9, 3.8435596572144327`*^9}, {
   3.843560072562766*^9, 3.843560164356756*^9}, {3.8435601971723137`*^9, 
   3.8435602217565603`*^9}, {3.8435610273207684`*^9, 3.8435610575702786`*^9}, 
   3.8435660433910017`*^9, 3.843566187576016*^9, {3.8435674008202267`*^9, 
   3.843567408871667*^9}, 3.8435674768425393`*^9, {3.843568068632105*^9, 
   3.843568073878681*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"eb350479-0efa-4615-a678-a4335927d06c"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["res1Dis", "mode"], "=", 
  RowBox[{"res1Display", "[", 
   RowBox[{
    SubscriptBox["res1", "mode"], ",", "id"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8435627257512913`*^9, 3.843562760052611*^9}, {
   3.84356558852423*^9, 3.843565603419176*^9}, 3.8435660328393927`*^9, 
   3.8435663003371277`*^9, 3.843586013798254*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"6e5fc8f5-f49d-4f84-8842-0583def81d4c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["errorRMSE", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "3"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["density", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8435656233124614`*^9, 3.8435656250585213`*^9}, {
  3.843565852386916*^9, 3.843565923384411*^9}, {3.843566355545126*^9, 
  3.8435663702762613`*^9}, {3.8435664068160334`*^9, 3.8435664087286477`*^9}, {
  3.8435672089751215`*^9, 3.843567218290592*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"117abb26-b5ac-4478-90b1-6c736a4b2ff4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["densityRes", "mode"], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["density", "mode"], ",", 
       SubscriptBox["errorRMSE", "mode"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435671054746866`*^9, 3.8435671986510954`*^9}, {
   3.8435672326070848`*^9, 3.843567254797406*^9}, 3.843568084571852*^9, {
   3.843569181105641*^9, 3.843569189057543*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"2cb0b02e-07a2-4bb3-b03d-9bc0c14e4e7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"offset", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxX", ",", "maxY"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8435677891281443`*^9, 3.843567936678544*^9}, {
  3.843567988966451*^9, 3.8435680003405094`*^9}, {3.843568031021259*^9, 
  3.8435680351858425`*^9}, {3.8435685289183893`*^9, 3.843568533400318*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"1f88d5a0-4595-48f8-8dcb-3afb8b1ab047"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     SubscriptBox["densityRes", "mode"], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.0013", ",", 
          RowBox[{"maxX", "+", "0.0001"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", 
          RowBox[{"maxY", "+", "1"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "@", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], "&"}], "/@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "n"}], "}"}], ",", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8435672232999535`*^9, 3.8435672393401055`*^9}, {
  3.843567312812736*^9, 3.8435673137976546`*^9}, {3.8435673803458414`*^9, 
  3.8435674659125233`*^9}, {3.843567537004793*^9, 3.8435675601257534`*^9}, {
  3.8435675946799755`*^9, 3.843567734096695*^9}, {3.8435677760244064`*^9, 
  3.8435678125011306`*^9}, {3.843567906391761*^9, 3.843568040248789*^9}, {
  3.8435682057955017`*^9, 3.843568321557461*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"2359d051-fa1c-4708-ace1-0154909a6b82"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constrained {1, n} test", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.843559410786008*^9}, {3.843559456682927*^9, 3.8435594601493797`*^9}, {
   3.8435604399200315`*^9, 3.8435604403199635`*^9}, {3.843568061242906*^9, 
   3.843568065734262*^9}, {3.8435681654299407`*^9, 3.8435681662043576`*^9}, 
   3.8435683646108847`*^9},ExpressionUUID->"0f6cb50e-be0a-46e8-9cb3-\
bd43f9f8e5c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mode", "=", "\"\<Constrained\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.843560210521414*^9, 3.8435602241167946`*^9}, {
   3.8435604347334003`*^9, 3.8435604383644085`*^9}, {3.843568071624194*^9, 
   3.8435680717982306`*^9}, {3.843568118158429*^9, 3.8435681214649086`*^9}, {
   3.843568168738282*^9, 3.843568169477273*^9}, 3.8435683630171824`*^9},
 CellLabel->"In[81]:=",ExpressionUUID->"3e32c6c0-e102-4014-9ac7-7a6e35bf7bf2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["res1", "mode"], "=", 
   RowBox[{"test1", "[", 
    RowBox[{"ia", ",", "ib", ",", " ", "lvls", ",", "e", ",", "mode"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435596242336655`*^9, 3.8435596572144327`*^9}, {
   3.843560072562766*^9, 3.843560164356756*^9}, {3.8435601971723137`*^9, 
   3.8435602217565603`*^9}, {3.8435610273207684`*^9, 3.8435610575702786`*^9}, 
   3.8435660433910017`*^9, 3.843566187576016*^9, {3.8435674008202267`*^9, 
   3.843567408871667*^9}, 3.8435674768425393`*^9, {3.843568068632105*^9, 
   3.843568073878681*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"ede91ecb-19b8-4f97-bcad-7fad7089b64f"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["res1Dis", "mode"], "=", 
  RowBox[{"res1Display", "[", 
   RowBox[{
    SubscriptBox["res1", "mode"], ",", "id"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8435627257512913`*^9, 3.843562760052611*^9}, {
   3.84356558852423*^9, 3.843565603419176*^9}, 3.8435660328393927`*^9, 
   3.8435663003371277`*^9, 3.843586052443518*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"df49b253-ecd0-48d4-8e26-0031f0ad581f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["errorRMSE", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "3"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["density", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8435656233124614`*^9, 3.8435656250585213`*^9}, {
  3.843565852386916*^9, 3.843565923384411*^9}, {3.843566355545126*^9, 
  3.8435663702762613`*^9}, {3.8435664068160334`*^9, 3.8435664087286477`*^9}, {
  3.8435672089751215`*^9, 3.843567218290592*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"188b6058-6661-4519-b3e6-894c9391d92e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["densityRes", "mode"], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["density", "mode"], ",", 
       SubscriptBox["errorRMSE", "mode"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435671054746866`*^9, 3.8435671986510954`*^9}, {
   3.8435672326070848`*^9, 3.843567254797406*^9}, 3.843568084571852*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"d197565a-0210-4200-a38e-7c502b1fdbbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"offset", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxX", ",", "maxY"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8435677891281443`*^9, 3.843567936678544*^9}, {
  3.843567988966451*^9, 3.8435680003405094`*^9}, {3.843568031021259*^9, 
  3.8435680351858425`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"a99c16aa-5553-42de-b442-478ef8c8e156"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     SubscriptBox["densityRes", "mode"], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.001", ",", 
          RowBox[{"maxX", "+", "0.001"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"maxY", "+", "1.5"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "@", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], "&"}], "/@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "n"}], "}"}], ",", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8435672232999535`*^9, 3.8435672393401055`*^9}, {
  3.843567312812736*^9, 3.8435673137976546`*^9}, {3.8435673803458414`*^9, 
  3.8435674659125233`*^9}, {3.843567537004793*^9, 3.8435675601257534`*^9}, {
  3.8435675946799755`*^9, 3.843567734096695*^9}, {3.8435677760244064`*^9, 
  3.8435678125011306`*^9}, {3.843567906391761*^9, 3.843568040248789*^9}, {
  3.8435682057955017`*^9, 3.843568321557461*^9}, {3.843568388237816*^9, 
  3.8435684236875324`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"4f29e3a5-7e24-499e-b50e-6f37cd445506"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constrained Smaller Steps {1, n} and e=e/4 test", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.843559410786008*^9}, {3.843559456682927*^9, 3.8435594601493797`*^9}, {
   3.8435604399200315`*^9, 3.8435604403199635`*^9}, {3.843568061242906*^9, 
   3.843568065734262*^9}, {3.8435681654299407`*^9, 3.8435681662043576`*^9}, 
   3.8435683646108847`*^9, {3.843652867370533*^9, 3.843652870142928*^9}, {
   3.8436531919363966`*^9, 3.8436532201789584`*^9}, {3.843653788685251*^9, 
   3.843653789703601*^9}},ExpressionUUID->"69613bf1-9695-433b-abf1-\
2c84d92b5fd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mode", "=", "\"\<ConstrainedSmallerSteps\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.843560210521414*^9, 3.8435602241167946`*^9}, {
   3.8435604347334003`*^9, 3.8435604383644085`*^9}, {3.843568071624194*^9, 
   3.8435680717982306`*^9}, {3.843568118158429*^9, 3.8435681214649086`*^9}, {
   3.843568168738282*^9, 3.843568169477273*^9}, 3.8435683630171824`*^9, {
   3.843652663451481*^9, 3.8436526655301447`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"15b5f903-a389-4434-bd35-c2b83d48ed80"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["res1", "mode"], "=", 
   RowBox[{"test1", "[", 
    RowBox[{"ia", ",", "ib", ",", " ", "lvls", ",", 
     RowBox[{"e", "/", "4"}], ",", "mode"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435596242336655`*^9, 3.8435596572144327`*^9}, {
   3.843560072562766*^9, 3.843560164356756*^9}, {3.8435601971723137`*^9, 
   3.8435602217565603`*^9}, {3.8435610273207684`*^9, 3.8435610575702786`*^9}, 
   3.8435660433910017`*^9, 3.843566187576016*^9, {3.8435674008202267`*^9, 
   3.843567408871667*^9}, 3.8435674768425393`*^9, {3.843568068632105*^9, 
   3.843568073878681*^9}, {3.843652861403541*^9, 3.8436528637655463`*^9}, 
   3.843653047329918*^9, 3.843653091095349*^9, 3.843653221988713*^9, 
   3.8436532884826374`*^9, {3.843653590546523*^9, 3.8436536105503283`*^9}, 
   3.8436537601769075`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"d3adb78e-1da6-41cf-9c4c-8cf61303be8a"],

Cell[BoxData[
 RowBox[{
  SubscriptBox["res1Dis", "mode"], "=", 
  RowBox[{"res1Display", "[", 
   RowBox[{
    SubscriptBox["res1", "mode"], ",", "id"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8435627257512913`*^9, 3.843562760052611*^9}, {
   3.84356558852423*^9, 3.843565603419176*^9}, 3.8435660328393927`*^9, 
   3.8435663003371277`*^9, 3.843586052443518*^9, 3.843653177273825*^9, 
   3.843653540599487*^9},
 CellLabel->"In[92]:=",ExpressionUUID->"733b977e-a31f-49b8-8bfa-267426d2c596"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["errorRMSE", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "3"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["density", "mode"], "=", 
   RowBox[{
    SubscriptBox["res1Dis", "mode"], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8435656233124614`*^9, 3.8435656250585213`*^9}, {
  3.843565852386916*^9, 3.843565923384411*^9}, {3.843566355545126*^9, 
  3.8435663702762613`*^9}, {3.8435664068160334`*^9, 3.8435664087286477`*^9}, {
  3.8435672089751215`*^9, 3.843567218290592*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"022b419e-8333-478c-b781-19677e24909b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["densityRes", "mode"], "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["density", "mode"], ",", 
       SubscriptBox["errorRMSE", "mode"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8435671054746866`*^9, 3.8435671986510954`*^9}, {
   3.8435672326070848`*^9, 3.843567254797406*^9}, 3.843568084571852*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"f7798c02-7be1-4044-9cdb-63c18cae4c9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Plot", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"offset", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"maxX", ",", "maxY"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], ",", 
       RowBox[{"Max", "[", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8435677891281443`*^9, 3.843567936678544*^9}, {
  3.843567988966451*^9, 3.8435680003405094`*^9}, {3.843568031021259*^9, 
  3.8435680351858425`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"fa48b573-a8f2-40e2-b0f6-4ccbec494088"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     SubscriptBox["densityRes", "mode"], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.001", ",", 
          RowBox[{"maxX", "+", "0.001"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"maxY", "+", "1.5"}]}], "}"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Graphics", "@", 
      RowBox[{"Text", "[", 
       RowBox[{
        RowBox[{"ToString", "@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], "&"}], "/@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "n"}], "}"}], ",", 
        RowBox[{
         SubscriptBox["densityRes", "mode"], "[", 
         RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8435672232999535`*^9, 3.8435672393401055`*^9}, {
  3.843567312812736*^9, 3.8435673137976546`*^9}, {3.8435673803458414`*^9, 
  3.8435674659125233`*^9}, {3.843567537004793*^9, 3.8435675601257534`*^9}, {
  3.8435675946799755`*^9, 3.843567734096695*^9}, {3.8435677760244064`*^9, 
  3.8435678125011306`*^9}, {3.843567906391761*^9, 3.843568040248789*^9}, {
  3.8435682057955017`*^9, 3.843568321557461*^9}, {3.843568388237816*^9, 
  3.8435684236875324`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"da7d4ea4-fe1a-455b-b175-1a7fbdddb345"]
}, Closed]],

Cell[CellGroupData[{

Cell["All {1, n} test", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 3.8433080681141663`*^9}, {3.843559346386388*^9, 
   3.843559410786008*^9}, {3.843559456682927*^9, 3.8435594601493797`*^9}, {
   3.8435604399200315`*^9, 3.8435604403199635`*^9}, {3.843568061242906*^9, 
   3.843568065734262*^9}, {3.8435684647066813`*^9, 
   3.8435684662476797`*^9}},ExpressionUUID->"2e5ad530-e304-42dc-a9ce-\
dc84a8379c6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Closest", " ", "Value", " ", "to", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], " ", "wins"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rangexyPlot", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0.05"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mode", "=", "\"\<OverConstrained\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          SubscriptBox["densityRes", "mode"], ",", 
          RowBox[{"PlotRange", "\[Rule]", "rangexyPlot"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Orange"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "@", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], 
         "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], ",", 
            RowBox[{
             SubscriptBox["densityRes", "mode"], "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mode", "=", "\"\<SemiConstrained\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          SubscriptBox["densityRes", "mode"], ",", 
          RowBox[{"PlotRange", "\[Rule]", "rangexyPlot"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "@", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], 
         "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], ",", 
            RowBox[{
             SubscriptBox["densityRes", "mode"], "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mode", "=", "\"\<Constrained\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          SubscriptBox["densityRes", "mode"], ",", 
          RowBox[{"PlotRange", "\[Rule]", "rangexyPlot"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "@", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], 
         "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], ",", 
            RowBox[{
             SubscriptBox["densityRes", "mode"], "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mode", "=", "\"\<ConstrainedSmallerSteps\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          SubscriptBox["densityRes", "mode"], ",", 
          RowBox[{"PlotRange", "\[Rule]", "rangexyPlot"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "Purple"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Graphics", "@", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"ToString", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", "offset"}]}], "]"}]}], 
         "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], ",", 
            RowBox[{
             SubscriptBox["densityRes", "mode"], "[", 
             RowBox[{"[", "n", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", "lvls"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"Scaled", "[", "0.5", "]"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.843568481346901*^9, 3.843568507390568*^9}, {
   3.8435686148286457`*^9, 3.843568773460791*^9}, {3.8435688426829214`*^9, 
   3.8435688925111575`*^9}, {3.8435689386629004`*^9, 
   3.8435689388789797`*^9}, {3.8435689799550505`*^9, 3.843569093449932*^9}, 
   3.843569150251689*^9, {3.8435712412262373`*^9, 3.843571323356493*^9}, {
   3.8435713665614557`*^9, 3.843571379468689*^9}, {3.843574285519548*^9, 
   3.8435743268138905`*^9}, {3.8435744919990196`*^9, 3.84357449639386*^9}, {
   3.84358734060082*^9, 3.8435873720486126`*^9}, {3.8436527908388414`*^9, 
   3.843652805642453*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"c6d1b6bd-925f-43d5-9806-6ce437062d3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Smallest", " ", "value", " ", "Wins"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"mode", "=", "\"\<OverConstrained\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pyth", "[", "#", "]"}], "&"}], "/@", 
          SubscriptBox["densityRes", "mode"]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Orange"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"lvls", "+", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "13"}], "}"}]}], "}"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mode", "=", "\"\<SemiConstrained\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pyth", "[", "#", "]"}], "&"}], "/@", 
          SubscriptBox["densityRes", "mode"]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mode", "=", "\"\<Constrained\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pyth", "[", "#", "]"}], "&"}], "/@", 
          SubscriptBox["densityRes", "mode"]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Green"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mode", "=", "\"\<ConstrainedSmallerSteps\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pyth", "[", "#", "]"}], "&"}], "/@", 
          SubscriptBox["densityRes", "mode"]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Purple"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"Scaled", "[", "0.5", "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.843569339887202*^9, 3.843569369653472*^9}, {
   3.8435694156511927`*^9, 3.843569427406698*^9}, {3.843569461187547*^9, 
   3.843569527275013*^9}, {3.8435695619668493`*^9, 3.843569579756431*^9}, {
   3.843569610489465*^9, 3.8435696281873827`*^9}, {3.8435696588775897`*^9, 
   3.8435696864121275`*^9}, {3.8435713449487963`*^9, 
   3.8435713605821147`*^9}, {3.843574351289144*^9, 3.843574373338208*^9}, 
   3.8435745035675364`*^9, {3.8436528185116787`*^9, 3.8436528290093584`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"68598ade-e776-419d-80de-db72c10617bf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1406, 839},
WindowMargins->{{Automatic, -313}, {Automatic, 82}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>1.5 Inherited,
FrontEndVersion->"12.3 pour Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"72a455bc-0f19-4202-b9c0-b8fb81e50e59"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 462, 7, 145, "Title",ExpressionUUID->"a09f1ec7-5059-44a7-a761-ac5c70f29164"],
Cell[1045, 31, 551, 13, 78, "Input",ExpressionUUID->"8e43c757-a6c7-4d6e-aa00-d64500748adf"],
Cell[CellGroupData[{
Cell[1621, 48, 207, 4, 101, "Section",ExpressionUUID->"9e578964-cb44-43a4-a98e-14fb51d3aa1d"],
Cell[1831, 54, 617, 15, 78, "Input",ExpressionUUID->"25a8476a-d820-47d4-adf9-b6a1da3d55b6"],
Cell[2451, 71, 924, 13, 142, "Input",ExpressionUUID->"948cfa84-6d40-4231-915d-df703bf392be"],
Cell[3378, 86, 602, 12, 142, "Input",ExpressionUUID->"cc39dffe-27e6-4c48-8eff-c96b163f46cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4017, 103, 153, 3, 101, "Section",ExpressionUUID->"7e632af5-bbd1-492c-a363-6ee34f85c7fd"],
Cell[4173, 108, 5542, 138, 782, "Input",ExpressionUUID->"26dc27af-7dcd-4628-ad5e-4cc0a6a0579c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9752, 251, 289, 5, 101, "Section",ExpressionUUID->"723a872d-fa08-422b-b2b4-1a1a858e9e13"],
Cell[CellGroupData[{
Cell[10066, 260, 537, 8, 66, "Subsubsection",ExpressionUUID->"e3be4378-c578-486e-a93e-e0dec4424685"],
Cell[10606, 270, 343, 10, 45, "Input",ExpressionUUID->"81973cf9-7f6a-4dd6-90b1-613f8cdc07b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10986, 285, 482, 7, 66, "Subsubsection",ExpressionUUID->"ff13a019-eaaf-4b2c-ac40-3aa325ff16ca"],
Cell[11471, 294, 433, 12, 45, "Input",ExpressionUUID->"7a55e7f9-2143-4ece-86b3-47220a4217b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11941, 311, 446, 7, 66, "Subsubsection",ExpressionUUID->"3b31a1e8-defb-407b-b38d-4a817075ee82"],
Cell[12390, 320, 1890, 42, 206, "Input",ExpressionUUID->"3a65afc6-732c-4083-9fd9-cff42128fd74"]
}, Closed]],
Cell[CellGroupData[{
Cell[14317, 367, 490, 7, 52, "Subsubsection",ExpressionUUID->"21333ac8-aab1-4d6b-84e9-29783a0b619f"],
Cell[14810, 376, 1457, 31, 206, "Input",ExpressionUUID->"5abc2659-dc82-4792-b94c-84a80f1b859a"]
}, Closed]],
Cell[CellGroupData[{
Cell[16304, 412, 482, 7, 52, "Subsubsection",ExpressionUUID->"d33767c5-d87c-45be-9651-664c7e7d25ae"],
Cell[16789, 421, 2532, 45, 216, "Input",ExpressionUUID->"7e17f637-14e5-4463-83c7-4acad6c91dfe"]
}, Closed]],
Cell[CellGroupData[{
Cell[19358, 471, 537, 8, 52, "Subsubsection",ExpressionUUID->"8da24f70-1bf4-4917-bd54-db5d84c90070"],
Cell[19898, 481, 9885, 221, 1078, "Input",ExpressionUUID->"91ddb515-361c-4b0c-94ca-ef2c02094f33"]
}, Closed]],
Cell[CellGroupData[{
Cell[29820, 707, 494, 7, 52, "Subsubsection",ExpressionUUID->"1474df71-9d6e-414c-bca7-7bec8ee1f77d"],
Cell[30317, 716, 7665, 176, 704, "Input",ExpressionUUID->"97b5fba1-2a6f-4c53-96a1-facf3428dc8f"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38031, 898, 303, 5, 101, "Section",ExpressionUUID->"dc60e2b1-f53e-4d00-a5fe-f391579f1fae"],
Cell[38337, 905, 4202, 97, 462, "Input",ExpressionUUID->"b9b43223-56d8-4058-a79a-123459ba4789"],
Cell[42542, 1004, 472, 10, 78, "Input",ExpressionUUID->"34dc2cc2-3b24-41f9-8779-de6d2091bb41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43051, 1019, 395, 6, 101, "Section",ExpressionUUID->"30d9029f-7819-4092-b9eb-d6d25e583017"],
Cell[43449, 1027, 418, 8, 78, "Input",ExpressionUUID->"d95bd0b1-e922-4716-8831-de2416e81d66"],
Cell[CellGroupData[{
Cell[43892, 1039, 656, 9, 66, "Subsubsection",ExpressionUUID->"804e40e4-80cf-4051-a4d8-4bc32713e58f"],
Cell[44551, 1050, 391, 6, 41, "Input",ExpressionUUID->"cdd3cdcc-e8be-4411-bd4b-cf2075797874"],
Cell[44945, 1058, 711, 14, 41, "Input",ExpressionUUID->"39709794-9dda-4ee2-8f3c-848ed9b065b4"],
Cell[45659, 1074, 445, 9, 41, "Input",ExpressionUUID->"885faa68-92f6-4743-87a0-c39e1c0660cd"],
Cell[46107, 1085, 827, 21, 73, "Input",ExpressionUUID->"a409475b-08b1-4f46-bce1-080d91447eea"],
Cell[46937, 1108, 621, 16, 43, "Input",ExpressionUUID->"c9f819ed-1356-40ab-8f13-690e318de90a"],
Cell[47561, 1126, 1035, 29, 101, "Input",ExpressionUUID->"c7d95468-930f-4534-b8d3-e06b10695219"],
Cell[48599, 1157, 1680, 44, 131, "Input",ExpressionUUID->"89a18cb4-2e52-42c6-936e-8b19fdfe9077"]
}, Closed]],
Cell[CellGroupData[{
Cell[50316, 1206, 710, 10, 52, "Subsubsection",ExpressionUUID->"f29f8f92-4c88-46d9-8d15-f6ff740b8c00"],
Cell[51029, 1218, 440, 7, 41, "Input",ExpressionUUID->"6a9690fd-c57a-4cdb-8f0c-42b6601d123e"],
Cell[51472, 1227, 681, 13, 41, "Input",ExpressionUUID->"eb350479-0efa-4615-a678-a4335927d06c"],
Cell[52156, 1242, 443, 9, 41, "Input",ExpressionUUID->"6e5fc8f5-f49d-4f84-8842-0583def81d4c"],
Cell[52602, 1253, 827, 21, 73, "Input",ExpressionUUID->"117abb26-b5ac-4478-90b1-6c736a4b2ff4"],
Cell[53432, 1276, 671, 17, 43, "Input",ExpressionUUID->"2cb0b02e-07a2-4bb3-b03d-9bc0c14e4e7b"],
Cell[54106, 1295, 1083, 29, 101, "Input",ExpressionUUID->"1f88d5a0-4595-48f8-8dcb-3afb8b1ab047"],
Cell[55192, 1326, 1737, 45, 131, "Input",ExpressionUUID->"2359d051-fa1c-4708-ace1-0154909a6b82"]
}, Closed]],
Cell[CellGroupData[{
Cell[56966, 1376, 729, 10, 52, "Subsubsection",ExpressionUUID->"0f6cb50e-be0a-46e8-9cb3-bd43f9f8e5c3"],
Cell[57698, 1388, 463, 7, 41, "Input",ExpressionUUID->"3e32c6c0-e102-4014-9ac7-7a6e35bf7bf2"],
Cell[58164, 1397, 681, 13, 41, "Input",ExpressionUUID->"ede91ecb-19b8-4f97-bcad-7fad7089b64f"],
Cell[58848, 1412, 443, 9, 41, "Input",ExpressionUUID->"df49b253-ecd0-48d4-8e26-0031f0ad581f"],
Cell[59294, 1423, 827, 21, 73, "Input",ExpressionUUID->"188b6058-6661-4519-b3e6-894c9391d92e"],
Cell[60124, 1446, 621, 16, 43, "Input",ExpressionUUID->"d197565a-0210-4200-a38e-7c502b1fdbbb"],
Cell[60748, 1464, 1035, 29, 101, "Input",ExpressionUUID->"a99c16aa-5553-42de-b442-478ef8c8e156"],
Cell[61786, 1495, 1788, 46, 131, "Input",ExpressionUUID->"4f29e3a5-7e24-499e-b50e-6f37cd445506"]
}, Closed]],
Cell[CellGroupData[{
Cell[63611, 1546, 903, 12, 52, "Subsubsection",ExpressionUUID->"69613bf1-9695-433b-abf1-2c84d92b5fd4"],
Cell[64517, 1560, 527, 8, 41, "Input",ExpressionUUID->"15b5f903-a389-4434-bd35-c2b83d48ed80"],
Cell[65047, 1570, 924, 16, 41, "Input",ExpressionUUID->"d3adb78e-1da6-41cf-9c4c-8cf61303be8a"],
Cell[65974, 1588, 491, 10, 41, "Input",ExpressionUUID->"733b977e-a31f-49b8-8bfa-267426d2c596"],
Cell[66468, 1600, 827, 21, 73, "Input",ExpressionUUID->"022b419e-8333-478c-b781-19677e24909b"],
Cell[67298, 1623, 621, 16, 43, "Input",ExpressionUUID->"f7798c02-7be1-4044-9cdb-63c18cae4c9c"],
Cell[67922, 1641, 1035, 29, 101, "Input",ExpressionUUID->"fa48b573-a8f2-40e2-b0f6-4ccbec494088"],
Cell[68960, 1672, 1788, 46, 131, "Input",ExpressionUUID->"da7d4ea4-fe1a-455b-b175-1a7fbdddb345"]
}, Closed]],
Cell[CellGroupData[{
Cell[70785, 1723, 697, 10, 52, "Subsubsection",ExpressionUUID->"2e5ad530-e304-42dc-a9ce-dc84a8379c6b"],
Cell[71485, 1735, 6214, 164, 526, "Input",ExpressionUUID->"c6d1b6bd-925f-43d5-9806-6ce437062d3d"],
Cell[77702, 1901, 2866, 71, 398, "Input",ExpressionUUID->"68598ade-e776-419d-80de-db72c10617bf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

