(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63940,       1534]
NotebookOptionsPosition[     58178,       1444]
NotebookOutlinePosition[     58722,       1463]
CellTagsIndexPosition[     58679,       1460]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Start", "Section",
 CellChangeTimes->{{3.8400383593859367`*^9, 3.8400383615886106`*^9}, {
  3.8433207191908846`*^9, 
  3.8433207198782096`*^9}},ExpressionUUID->"986346a2-0213-45f1-acfa-\
7ad2e9a90956"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", "to", " ", "path", " ", "packages"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"packageDirectory", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"ParentDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], ",", 
       "\"\<1DPackage\>\"", ",", "\"\<*\>\""}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Path", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8437444304820337`*^9, {3.843744475443145*^9, 3.843744489249152*^9}, {
   3.84374460430722*^9, 3.843744614114832*^9}, {3.8437451879521313`*^9, 
   3.8437451890826197`*^9}, {3.8437453266046667`*^9, 3.8437453290342407`*^9}, 
   3.8490954877290297`*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"34b265ec-9705-4f2d-8f15-8e1086cb8323"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<ReadSintel`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<pyramidalStereoAll`\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\>\"", ",", "\"\<OverConstrained\>\"", ",", 
     "\"\<SemiConstrained\>\"", ",", "\"\<Constrained\>\"", ",", 
     "\"\<ConstrainedNewMethod\>\"", ",", "\"\<ConstrainedCorrelation\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"\"\<pyramidalCyclope1D\>\"", "<>", "met", "<>", "\"\<`\>\""}], 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"met", ",", "methods"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8405470666010065`*^9, 3.8405470721952195`*^9}, {
   3.840550195734952*^9, 3.840550216899179*^9}, {3.8417693956828256`*^9, 
   3.8417694295737267`*^9}, 3.8417694792252483`*^9, {3.8423558358531294`*^9, 
   3.842355838266631*^9}, {3.843139686906508*^9, 3.8431397006034536`*^9}, 
   3.8431400354897623`*^9, {3.8431583092259803`*^9, 3.843158312433055*^9}, {
   3.8431587050542717`*^9, 3.8431587088646235`*^9}, {3.8432405156973643`*^9, 
   3.8432405180756235`*^9}, {3.8432434086403227`*^9, 3.8432434521650333`*^9}, 
   3.8435781970825057`*^9, 3.8435786572990074`*^9, {3.843745725318043*^9, 
   3.843745730794486*^9}, {3.8437501550408554`*^9, 3.843750161634801*^9}, {
   3.843750230642497*^9, 3.8437503524543705`*^9}, {3.8437504375112853`*^9, 
   3.8437504386938276`*^9}, {3.843755017106989*^9, 3.84375503403273*^9}, {
   3.843755426452015*^9, 3.843755445994274*^9}, {3.8438346833502474`*^9, 
   3.84383468782578*^9}, 3.843835196563305*^9, {3.8438498338643837`*^9, 
   3.843849837390987*^9}, {3.8438505820282726`*^9, 3.843850585529437*^9}, {
   3.843851080665611*^9, 3.8438510924880347`*^9}, {3.843917874644593*^9, 
   3.84391788967353*^9}, {3.843919464270398*^9, 3.8439194690819983`*^9}, {
   3.844258411683423*^9, 3.8442584146673145`*^9}, 3.844258734579767*^9, 
   3.84426385350611*^9, 3.8442668082773514`*^9, {3.844780498357904*^9, 
   3.8447805041423593`*^9}, {3.8449446421268377`*^9, 3.844944649113989*^9}, {
   3.844944993663724*^9, 3.844945009436464*^9}, 3.8490954964696183`*^9, {
   3.8556557035434666`*^9, 3.8556557097903485`*^9}, {3.857638050032972*^9, 
   3.8576380563398314`*^9}, 3.8578356297294245`*^9, {3.8582423841710143`*^9, 
   3.8582423856335545`*^9}, {3.858245611197304*^9, 3.858245613023696*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"f5c4e6fd-205b-45cc-ad44-fa420f5985ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Declare", " ", "path", " ", "for", " ", "SINTEL", " ", "Data", " ", 
    "depending", " ", "on", " ", "user"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"baseSINTEL", "=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "$UserName", ",", "\[IndentingNewLine]", "\"\<fieri\>\"", ",", 
      "\"\<D:\\\\MastersMathematica\\\\Data\\\\Sintel\>\"", ",", 
      "\[IndentingNewLine]", "\"\<roys\>\"", ",", 
      "\"\</home/roys/datasets/SINTEL-stereo\>\""}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8437446388681035`*^9, 3.8437446932344007`*^9}, {
  3.8457196414004154`*^9, 3.8457196427641745`*^9}, {3.84571973682537*^9, 
  3.845719738564255*^9}, {3.8556556699480524`*^9, 3.8556556720163326`*^9}, {
  3.855655723820243*^9, 3.855655724983708*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"983e1f28-e987-41b6-bf6f-2d213a23c05e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}},ExpressionUUID->"fb582e9a-4d6e-4d6e-9b13-\
ab633a281617"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "downscaling", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
    RowBox[{"read", "[", 
     RowBox[{
     "baseSINTEL", ",", "\"\<temple_2\>\"", ",", "\"\<0001\>\"", ",", "r", 
      ",", "\"\<clean\>\""}], "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.843745436013342*^9, 3.843745445266261*^9}, {
   3.8437454795752115`*^9, 3.843745636648714*^9}, 3.8442584513876195`*^9, {
   3.8442678037667413`*^9, 3.844267808172227*^9}, {3.8442680916621*^9, 
   3.8442680954422073`*^9}, {3.845719669524063*^9, 3.8457196845186987`*^9}, {
   3.845719716504841*^9, 3.8457198197977877`*^9}, {3.8457199186400223`*^9, 
   3.8457199239790096`*^9}, {3.8457200595643215`*^9, 
   3.8457201091945724`*^9}, {3.8457201816476693`*^9, 
   3.8457203881756153`*^9}, {3.8457205408372355`*^9, 3.84572057561047*^9}, {
   3.8457210342212343`*^9, 3.845721046589213*^9}, {3.84572189289744*^9, 
   3.8457220241968083`*^9}, {3.845736827573617*^9, 3.8457368310761595`*^9}, {
   3.8457374087399197`*^9, 3.8457375298050385`*^9}, {3.845737585153984*^9, 
   3.8457376009137864`*^9}, {3.8457376317120295`*^9, 
   3.8457376491018925`*^9}, {3.8457379681682467`*^9, 3.845737968918872*^9}, {
   3.8459159937269096`*^9, 3.845916065594756*^9}, {3.8459208505722537`*^9, 
   3.8459208626015835`*^9}, {3.8460030572006135`*^9, 
   3.8460030654200583`*^9}, {3.8460122899599075`*^9, 
   3.8460123288850226`*^9}, {3.8460125228762617`*^9, 3.846012601456051*^9}, {
   3.846013064036981*^9, 3.846013089811376*^9}, {3.8460131447480764`*^9, 
   3.84601331885571*^9}, {3.846013349534447*^9, 3.846013372038978*^9}, {
   3.846167155864127*^9, 3.8461672195604773`*^9}, {3.846167378389165*^9, 
   3.846167408296273*^9}, {3.846261434953365*^9, 3.8462614597660093`*^9}, {
   3.852739560630743*^9, 3.8527395774452496`*^9}, {3.8527397025311766`*^9, 
   3.852739750814078*^9}, {3.8527398603045654`*^9, 3.8527398693552265`*^9}, {
   3.852739915577756*^9, 3.852739920809184*^9}, {3.8527399973487043`*^9, 
   3.8527400233960047`*^9}, 3.852740148676304*^9, {3.8527402375986753`*^9, 
   3.8527402825741987`*^9}, {3.8527407084687247`*^9, 3.85274071078141*^9}, 
   3.8529724118023367`*^9, {3.8540294579387217`*^9, 3.8540294593234234`*^9}, {
   3.854037562691866*^9, 3.8540375980861387`*^9}, 3.855616425558366*^9, 
   3.8556208471265903`*^9, 3.855655689532875*^9, {3.8556557926221733`*^9, 
   3.8556557942826843`*^9}, {3.856365670503353*^9, 3.856365671342097*^9}, {
   3.8564466365811934`*^9, 3.8564466372125964`*^9}, {3.857650096029873*^9, 
   3.857650097447332*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"1f409ba0-8079-4c0d-85c9-68fb0edf59ca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Image sections", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}, {3.8466840957849693`*^9, 
   3.8466840985499296`*^9}, {3.8490432101029243`*^9, 3.849043210540059*^9}, {
   3.8540301701664133`*^9, 
   3.8540301746101103`*^9}},ExpressionUUID->"38f30f34-e385-47b0-9337-\
175fb2980307"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "44"}], "}"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "102"}], "}"}], " ", "arbitrary", " ", "size", " ", 
     "to", " ", "make", " ", "the", " ", "method", " ", "faster"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"listDims", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"600", ",", "150"}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ims", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nx", "=", 
         RowBox[{
          RowBox[{"dims", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "r"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ny", "=", 
         RowBox[{
          RowBox[{"dims", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/", "r"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"iaa", ",", "ibb", ",", "idd", ",", "ioo"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ImageTake", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"ny", ",", 
               RowBox[{"ny", "+", "44"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"nx", ",", 
               RowBox[{"nx", "+", "102"}]}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"MinMax", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ImageData", "[", "idd", "]"}], "]"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"iaa", ",", "ibb", ",", "idd"}], "}"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"dims", ",", "listDims"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max", "=", 
     RowBox[{
      RowBox[{"MinMax", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<max dv=\>\"", ",", " ", "max"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8540301774171877`*^9, 3.8540301930120335`*^9}, 
   3.8540302359774623`*^9, {3.8540304837998714`*^9, 3.8540305814409323`*^9}, {
   3.8540306768373904`*^9, 3.854030719206648*^9}, {3.8540375443798003`*^9, 
   3.854037550639119*^9}, {3.854037583276456*^9, 3.854037619859151*^9}, {
   3.855075038045244*^9, 3.855075043821375*^9}, {3.8551666610955935`*^9, 
   3.8551666680434566`*^9}, {3.8552361374347477`*^9, 3.8552361395575447`*^9}, 
   3.855606653599547*^9, {3.855620854110469*^9, 3.8556209149205413`*^9}, {
   3.8556209535217524`*^9, 3.855620957512952*^9}, {3.855621003684822*^9, 
   3.8556210169696846`*^9}, 3.855621356695964*^9, {3.8556243252160034`*^9, 
   3.8556243421946826`*^9}, {3.8556557696034107`*^9, 3.85565582867811*^9}, {
   3.855658829471591*^9, 3.8556588339197435`*^9}, {3.8556589991089716`*^9, 
   3.855659000204501*^9}, {3.856029226528818*^9, 3.856029323464652*^9}, {
   3.8560294539344707`*^9, 3.856029455315941*^9}, {3.8560295871955366`*^9, 
   3.8560295899242425`*^9}, {3.8560299354485044`*^9, 3.856029936903365*^9}, 
   3.8560301071891947`*^9, {3.8560302725995846`*^9, 3.856030337066291*^9}, {
   3.8562649735391903`*^9, 3.856264982093645*^9}, {3.856265213337758*^9, 
   3.8562652282305126`*^9}, {3.8562653905722523`*^9, 3.856265405675403*^9}, 
   3.8562654571773543`*^9, {3.8562655221385803`*^9, 3.856265555552207*^9}, {
   3.856266347193515*^9, 3.8562663790481224`*^9}, {3.8562681401789465`*^9, 
   3.856268157582207*^9}, 3.856268192316244*^9, {3.856345960366991*^9, 
   3.856345971200444*^9}, 3.8563647730311446`*^9, {3.8563652489490056`*^9, 
   3.8563652602613287`*^9}, {3.8576380715463934`*^9, 3.8576380848582373`*^9}, 
   3.857650572689826*^9, {3.8581751885845566`*^9, 3.8581751923044853`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"058d8c6c-bf4b-4901-a2c4-44e2d1e2ecdb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431530928617816`*^9, 
  3.8431531095074196`*^9}, {3.8431536160653305`*^9, 3.843153621995445*^9}, {
  3.857834897524703*^9, 3.857834900572544*^9}, {3.857834987204065*^9, 
  3.8578349884135303`*^9}},ExpressionUUID->"7ce750f2-1229-4574-bda3-\
624cb0734e93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"removeClosest", "[", "s_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "c"}], "}"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Nearest", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"n", "[", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ")"}], "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Delete", "[", 
        RowBox[{"s", ",", "c"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeClosest", "[", "s_", "]"}], ":=", 
   RowBox[{"s", "/;", 
    RowBox[{
     RowBox[{"Length", "[", "s", "]"}], "<", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.846331098507648*^9, 3.8463311412069798`*^9}, {
   3.8463313097288356`*^9, 3.8463313440080214`*^9}, 3.846336737969517*^9, {
   3.855166708079237*^9, 3.8551667090315046`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"4b3de830-ce3b-48db-ac44-3c96eff972f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Creating", " ", "list", " ", "of", " ", "initial", " ", "Values"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"range", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listv0", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"range", ",", 
         RowBox[{"{", 
          RowBox[{"1000", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
           "0"}], " ", "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[LessEqual]", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"Abs", "[", "range", "]"}], "]"}]}]}], ")"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listv0", "=", 
     RowBox[{"Nest", "[", 
      RowBox[{"removeClosest", ",", "listv0", ",", 
       RowBox[{
        RowBox[{"Length", "[", "listv0", "]"}], "-", "200"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ListPlot", "[", "listv0", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.856025555353176*^9, 3.856025581242181*^9}, {
   3.856026254947156*^9, 3.8560262676953154`*^9}, {3.8560269000214405`*^9, 
   3.8560269057433596`*^9}, {3.856028287134*^9, 3.8560282875081854`*^9}, {
   3.8560291133650265`*^9, 3.856029113895653*^9}, {3.856264813907603*^9, 
   3.8562648415890727`*^9}, {3.856264872266114*^9, 3.856264899310997*^9}, {
   3.856266050181141*^9, 3.8562660689465632`*^9}, {3.856267126278367*^9, 
   3.856267126709761*^9}, 3.8562678696086025`*^9, 3.8562681090174656`*^9, {
   3.85763918164597*^9, 3.8576391817878866`*^9}, {3.857834361655814*^9, 
   3.8578343780284786`*^9}, {3.8578346169640903`*^9, 
   3.8578346183075852`*^9}, {3.857836087058506*^9, 3.857836175399848*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"4edbcbd0-8fdf-455f-b667-451249ce3b9e"]
}, Closed]],

Cell[CellGroupData[{

Cell["More in depth", "Section",
 CellChangeTimes->{{3.8321935354974017`*^9, 3.8321935380848103`*^9}, {
  3.8363952278003016`*^9, 3.8363952460112877`*^9}, {3.8431530928617816`*^9, 
  3.8431531095074196`*^9}, {3.8431536160653305`*^9, 3.843153621995445*^9}, {
  3.857834897524703*^9, 3.857834900572544*^9}, {3.858175160788268*^9, 
  3.8581751629873734`*^9}},ExpressionUUID->"b115b75e-bfe7-42a2-aead-\
a69602ed60d6"],

Cell[CellGroupData[{

Cell["More in depth", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.8557745100849714`*^9, 
   3.8557745127875643`*^9}},ExpressionUUID->"de76e626-6efa-4943-98d4-\
58ebc15fc512"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lvl", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.855774696105371*^9, 3.855774703303475*^9}, 
   3.855775581960099*^9, 3.855833015988676*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"2e0c8f2e-734e-468c-9104-ec621fbaceb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ka", ",", "kb"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ImageData", "[", "#", "]"}], "[", 
      RowBox[{"[", "k", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"ims", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", 
       RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyra", "=", 
   RowBox[{"pyrFuncGen", "[", 
    RowBox[{"ka", ",", "lvl"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyrb", "=", 
   RowBox[{"pyrFuncGen", "[", 
    RowBox[{"kb", ",", "lvl"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyrab", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pyra", ",", " ", "pyrb"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e", "=", "0.0001"}], ";"}]}], "Input",
 CellChangeTimes->{{3.855774603733914*^9, 3.855774635611974*^9}, 
   3.8557746680665054`*^9, 3.8557747102030983`*^9, {3.8557751658724923`*^9, 
   3.855775166668244*^9}, 3.8557754300431175`*^9, {3.8557755180522213`*^9, 
   3.8557755186299353`*^9}, {3.8557757963041315`*^9, 
   3.8557757973160915`*^9}, {3.8557759267240343`*^9, 
   3.8557759277715287`*^9}, {3.8557760160576525`*^9, 
   3.8557760200064507`*^9}, {3.855776189445436*^9, 3.8557761899171376`*^9}, {
   3.8557762471199436`*^9, 3.855776265737028*^9}, {3.855776450778363*^9, 
   3.8557764512468667`*^9}, {3.8558437818704987`*^9, 3.8558437821235604`*^9}, 
   3.855844089984662*^9, 3.855928123063644*^9, {3.856009693683056*^9, 
   3.856009694218858*^9}, {3.8560100876990404`*^9, 3.856010103022776*^9}, {
   3.856010762453055*^9, 3.8560107656824307`*^9}, 3.856011183408444*^9, {
   3.8560112937433944`*^9, 3.856011316412936*^9}, 3.856013865244747*^9, {
   3.856016334963682*^9, 3.85601633628195*^9}, {3.8560171312863097`*^9, 
   3.8560171332653017`*^9}, 3.856017335535138*^9, {3.8560197949958262`*^9, 
   3.8560197964642687`*^9}, {3.856026827865363*^9, 3.856026851099223*^9}, {
   3.856027674690831*^9, 3.8560276793448243`*^9}, {3.8560282209834814`*^9, 
   3.856028221467722*^9}, 3.8562669893722205`*^9, {3.856267101921957*^9, 
   3.8562671023578005`*^9}, 3.856268584477604*^9, 3.8581751840113597`*^9, {
   3.858175259861787*^9, 3.85817526546358*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"20a42b9f-7740-4d37-b279-fb61ea22c4b5"],

Cell[BoxData[
 RowBox[{"g0", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"pyra", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], ",", 
      RowBox[{
       RowBox[{"pyrb", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "103"}], "}"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<x\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Italic"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<I(x)\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Italic"}], 
        "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.858180285512748*^9, 3.8581803420823994`*^9}, {
  3.8581803883610263`*^9, 3.858180388474581*^9}, {3.8582553186049623`*^9, 
  3.858255372053613*^9}, {3.8582554168381276`*^9, 3.8582554755412097`*^9}, {
  3.858256101529546*^9, 3.85825612150543*^9}, {3.8582561558868856`*^9, 
  3.858256252878346*^9}, {3.8582565479393377`*^9, 3.858256548911684*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"a26fa7bf-daaa-4050-b03f-156cbbb852a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Creating", " ", "list", " ", "of", " ", "initial", " ", "Values"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"range", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listv0", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"range", ",", 
         RowBox[{"{", 
          RowBox[{"1000", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
           "0"}], " ", "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "+", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[LessEqual]", " ", 
           RowBox[{"Max", "[", 
            RowBox[{"Abs", "[", "range", "]"}], "]"}]}]}], ")"}], "&"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listv0", "=", 
     RowBox[{"Nest", "[", 
      RowBox[{"removeClosest", ",", "listv0", ",", 
       RowBox[{
        RowBox[{"Length", "[", "listv0", "]"}], "-", "80"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPlot", "[", "listv0", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.856025555353176*^9, 3.856025581242181*^9}, {
   3.856026254947156*^9, 3.8560262676953154`*^9}, {3.8560269000214405`*^9, 
   3.8560269057433596`*^9}, {3.856028287134*^9, 3.8560282875081854`*^9}, {
   3.8560291133650265`*^9, 3.856029113895653*^9}, {3.856264813907603*^9, 
   3.8562648415890727`*^9}, {3.856264872266114*^9, 3.856264899310997*^9}, {
   3.856266050181141*^9, 3.8562660689465632`*^9}, {3.856267126278367*^9, 
   3.856267126709761*^9}, 3.8562678696086025`*^9, 3.8562681090174656`*^9, {
   3.85763918164597*^9, 3.8576391817878866`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"fbdeb767-3fba-4293-98db-157594b53f2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Creating", " ", "condition"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"topbot", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "10"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "condition", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"condition", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"x", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], " ", "&&", " ", 
      RowBox[{
       RowBox[{"topbot", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "<", 
       RowBox[{"Total", "[", 
        RowBox[{"x", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "<", 
       RowBox[{"topbot", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{3.858175254960038*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"3add8b7a-572a-4fba-a3bb-619652d25675"],

Cell[BoxData[{
 RowBox[{"sol", "=", 
  RowBox[{"lineTest", "[", 
   RowBox[{"0", ",", "0", ",", "listv0", ",", "condition", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "103"}], "]"}], ",", 
    RowBox[{"pyrab", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "e", ",", 
    "\"\<ConstrainedCorrelation\>\""}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Total", "[", "#", "]"}], "&"}], "/@", 
  RowBox[{"sol", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", 
     RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.855775567623247*^9, 3.855775590996392*^9}, 
   3.8557765102687263`*^9, 3.8558316018106794`*^9, {3.8558328291018753`*^9, 
   3.855832830873332*^9}, {3.855833042633805*^9, 3.855833046509434*^9}, {
   3.8558439406484065`*^9, 3.855843942143319*^9}, {3.8562670121425767`*^9, 
   3.8562670235610995`*^9}, {3.857638133031299*^9, 3.8576381348063335`*^9}, {
   3.8581752333645415`*^9, 3.8581752362715073`*^9}, 3.858175292051549*^9, {
   3.858179931315144*^9, 3.85817995746235*^9}, {3.8582413218054247`*^9, 
   3.858241350982278*^9}, {3.8582414786582966`*^9, 3.858241631523018*^9}, {
   3.8582416629154654`*^9, 3.858241663176594*^9}, 3.858241725524865*^9, 
   3.8582504044422665`*^9, {3.8582506554303885`*^9, 3.8582506796423664`*^9}, 
   3.8582515404756956`*^9},
 CellLabel->
  "In[162]:=",ExpressionUUID->"742a7555-7c6e-468d-a2d8-7f442456e380"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "listv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "103"}], "]"}], ",", 
   RowBox[{"pyrab", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "e", ",", 
   "\"\<ConstrainedCorrelation\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.8560277854810467`*^9, {3.856028701895477*^9, 3.8560287049668074`*^9}, 
   3.8562675880779514`*^9, 3.8562677428794727`*^9, {3.857638140783536*^9, 
   3.857638142406887*^9}, {3.8581754034467087`*^9, 3.8581754394274783`*^9}, 
   3.8581815419752765`*^9, 3.8581817692998896`*^9, 3.8582416488917823`*^9, {
   3.8582417096812787`*^9, 3.858241716407302*^9}, {3.8582419492039256`*^9, 
   3.8582419527582693`*^9}, 3.8582505210560274`*^9, 3.858251553949196*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"58150093-ce54-41be-a18a-e37d18601ad1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iVector", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"-", "4"}], ",", "4", ",", "0.1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8582451064089766`*^9, 3.858245116908389*^9}, {
  3.8582456847643557`*^9, 3.858245685933242*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"b5e2db7d-7d32-4309-ac7f-0b1475286d7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["With a P", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.8557745100849714`*^9, 3.8557745127875643`*^9}, {
   3.8582418821157417`*^9, 
   3.858241884793322*^9}},ExpressionUUID->"0750fce2-c751-41f3-8859-\
6a6e758ad246"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", "100"}], ";"}]], "Input",
 CellChangeTimes->{{3.8581754254524584`*^9, 3.8581754284792967`*^9}, 
   3.8581799682421217`*^9, {3.85818042922462*^9, 3.8581804294079475`*^9}, {
   3.858241840209297*^9, 3.8582418422814145`*^9}, {3.858250619966688*^9, 
   3.858250620387597*^9}, {3.858250695826098*^9, 3.858250696314562*^9}, {
   3.858251601940589*^9, 3.8582516021860256`*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"bd9f9ce1-34d3-4427-977f-c8761fe4250c"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "listv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"p", "-", "3"}], ",", 
     RowBox[{"p", "+", "3"}]}], "]"}], ",", 
   RowBox[{"pyrab", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "e", ",", 
   "\"\<ConstrainedCorrelation\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.8560277854810467`*^9, {3.856028701895477*^9, 3.8560287049668074`*^9}, 
   3.8562675880779514`*^9, 3.8562677428794727`*^9, {3.857638140783536*^9, 
   3.857638142406887*^9}, {3.8581754034467087`*^9, 3.8581754394274783`*^9}, 
   3.8581815419752765`*^9, 3.8581817692998896`*^9, 3.8582416488917823`*^9, {
   3.8582417096812787`*^9, 3.858241716407302*^9}, 3.858250634152154*^9, 
   3.85825156021065*^9},
 CellLabel->
  "In[167]:=",ExpressionUUID->"7d8bbf09-543c-42e2-b353-dab5b1c691b9"],

Cell[BoxData[{
 RowBox[{"i1Vector", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "-", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"p", ",", "1"}], "]"}], "]"}]}], ")"}], "+", 
   "iVector"}]}], "\[IndentingNewLine]", 
 RowBox[{"i2Vector", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "+", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"p", ",", "2"}], "]"}], "]"}]}], ")"}], "+", 
   "iVector"}]}]}], "Input",
 CellChangeTimes->{{3.858166002356682*^9, 3.8581660202306376`*^9}, {
   3.858166408756623*^9, 3.8581664528695636`*^9}, {3.858179997539263*^9, 
   3.858179998971823*^9}, {3.8581815815496345`*^9, 3.858181583773691*^9}, {
   3.8581816207977004`*^9, 3.858181624458311*^9}, {3.8581817160784492`*^9, 
   3.8581817332026453`*^9}, {3.8582416823424587`*^9, 
   3.8582417052316236`*^9}, {3.858241802823575*^9, 3.8582418131198378`*^9}, {
   3.8582423219272585`*^9, 3.858242324585464*^9}, 3.858242711195279*^9, {
   3.858245093436745*^9, 3.858245121091047*^9}, {3.858250637570837*^9, 
   3.8582506390462966`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"33f25ee7-bf68-45da-b01a-d8810b2acb76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "i1Vector"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "i2Vector"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"toPlot", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.858164618496561*^9, 3.858164731710362*^9}, {
  3.8581647681296053`*^9, 3.858164768397168*^9}, {3.8581648060874166`*^9, 
  3.8581648329815216`*^9}, {3.8581648658698964`*^9, 3.85816489085905*^9}, {
  3.8581650360628495`*^9, 3.858165044623519*^9}, {3.8581658022994747`*^9, 
  3.85816582294541*^9}, {3.858166022855764*^9, 3.858166138556278*^9}, {
  3.858166259951637*^9, 3.8581662732032175`*^9}, {3.858166463338999*^9, 
  3.858166496420912*^9}, {3.8581800132878494`*^9, 3.85818003161129*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"34e2815d-97cd-4ce4-a1e5-806d49682f28"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"toPlot", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(1\)]\)(x)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(I\), \(2\)]\)(x)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.858166120682987*^9, 3.858166127576948*^9}, {
  3.858248380701563*^9, 3.8582484244404697`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"91e771c0-28ea-4742-8636-37918fb0a637"]
}, Closed]],

Cell[CellGroupData[{

Cell["With a P", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.8557745100849714`*^9, 3.8557745127875643`*^9}, {
   3.8582418821157417`*^9, 
   3.858241884793322*^9}},ExpressionUUID->"01d303f8-9436-4e59-bb03-\
ae348d6a047a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", "20"}], ";"}]], "Input",
 CellChangeTimes->{{3.8581754254524584`*^9, 3.8581754284792967`*^9}, 
   3.8581799682421217`*^9, {3.85818042922462*^9, 3.8581804294079475`*^9}, {
   3.858241840209297*^9, 3.8582418422814145`*^9}, 3.858241900389397*^9},
 CellLabel->
  "In[174]:=",ExpressionUUID->"7ecc814c-485d-440e-a901-ef105dae84fd"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "listv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"p", "-", "3"}], ",", 
     RowBox[{"p", "+", "3"}]}], "]"}], ",", 
   RowBox[{"pyrab", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "e", ",", 
   "\"\<ConstrainedCorrelation\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.8560277854810467`*^9, {3.856028701895477*^9, 3.8560287049668074`*^9}, 
   3.8562675880779514`*^9, 3.8562677428794727`*^9, {3.857638140783536*^9, 
   3.857638142406887*^9}, {3.8581754034467087`*^9, 3.8581754394274783`*^9}, 
   3.8581815419752765`*^9, 3.8581817692998896`*^9, 3.8582416488917823`*^9, {
   3.8582417096812787`*^9, 3.858241716407302*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"10664cd1-5431-4bc8-9141-03869d728660"],

Cell[BoxData[{
 RowBox[{"i1Vector", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "-", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"p", ",", "1"}], "]"}], "]"}]}], ")"}], "+", 
   "iVector"}]}], "\[IndentingNewLine]", 
 RowBox[{"i2Vector", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "+", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"p", ",", "2"}], "]"}], "]"}]}], ")"}], "+", 
   "iVector"}]}]}], "Input",
 CellChangeTimes->{{3.858166002356682*^9, 3.8581660202306376`*^9}, {
   3.858166408756623*^9, 3.8581664528695636`*^9}, {3.858179997539263*^9, 
   3.858179998971823*^9}, {3.8581815815496345`*^9, 3.858181583773691*^9}, {
   3.8581816207977004`*^9, 3.858181624458311*^9}, {3.8581817160784492`*^9, 
   3.8581817332026453`*^9}, {3.8582416823424587`*^9, 
   3.8582417052316236`*^9}, {3.858241802823575*^9, 3.8582418131198378`*^9}, {
   3.8582422791248817`*^9, 3.8582423088900404`*^9}, 3.8582426952822657`*^9, 
   3.858245126512952*^9},
 CellLabel->
  "In[176]:=",ExpressionUUID->"c654258b-6aa7-4a61-9f40-51be80da1140"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "i1Vector"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "i2Vector"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"toPlot", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.858164618496561*^9, 3.858164731710362*^9}, {
  3.8581647681296053`*^9, 3.858164768397168*^9}, {3.8581648060874166`*^9, 
  3.8581648329815216`*^9}, {3.8581648658698964`*^9, 3.85816489085905*^9}, {
  3.8581650360628495`*^9, 3.858165044623519*^9}, {3.8581658022994747`*^9, 
  3.85816582294541*^9}, {3.858166022855764*^9, 3.858166138556278*^9}, {
  3.858166259951637*^9, 3.8581662732032175`*^9}, {3.858166463338999*^9, 
  3.858166496420912*^9}, {3.8581800132878494`*^9, 3.85818003161129*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"0ec1915e-f900-4875-bb91-d6f73c8c3a98"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"toPlot", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(1\)]\)(x)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(I\), \(2\)]\)(x)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.858166120682987*^9, 3.858166127576948*^9}, 
   3.8582484590336556`*^9},
 CellLabel->
  "In[181]:=",ExpressionUUID->"ca058ba9-5810-4209-92a6-c9e3f936a2e2"]
}, Closed]],

Cell[CellGroupData[{

Cell["With a P", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.8557745100849714`*^9, 3.8557745127875643`*^9}, {
   3.8582418821157417`*^9, 
   3.858241884793322*^9}},ExpressionUUID->"b0722bd5-f00c-48cf-970c-\
dec13f46ee72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", "40"}], ";"}]], "Input",
 CellChangeTimes->{{3.8581754254524584`*^9, 3.8581754284792967`*^9}, 
   3.8581799682421217`*^9, {3.85818042922462*^9, 3.8581804294079475`*^9}, {
   3.858241840209297*^9, 3.8582418422814145`*^9}, 3.858241900389397*^9, 
   3.858241977968054*^9},
 CellLabel->
  "In[182]:=",ExpressionUUID->"96410906-0e00-4556-b9ff-663563c497de"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0", ",", "0", ",", "listv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"p", "-", "5"}], ",", 
     RowBox[{"p", "+", "5"}]}], "]"}], ",", 
   RowBox[{"pyrab", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "e", ",", 
   "\"\<ConstrainedCorrelation\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.8560277854810467`*^9, {3.856028701895477*^9, 3.8560287049668074`*^9}, 
   3.8562675880779514`*^9, 3.8562677428794727`*^9, {3.857638140783536*^9, 
   3.857638142406887*^9}, {3.8581754034467087`*^9, 3.8581754394274783`*^9}, 
   3.8581815419752765`*^9, 3.8581817692998896`*^9, 3.8582416488917823`*^9, {
   3.8582417096812787`*^9, 3.858241716407302*^9}, {3.8582420865913205`*^9, 
   3.8582421369427595`*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"b0187f9c-3e09-4e4a-b2b3-99348c11c6a3"],

Cell[BoxData[{
 RowBox[{"i1Vector", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "-", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"p", ",", "1"}], "]"}], "]"}]}], ")"}], "+", 
   "iVector"}]}], "\[IndentingNewLine]", 
 RowBox[{"i2Vector", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"p", "+", 
     RowBox[{"sol", "[", 
      RowBox[{"[", 
       RowBox[{"p", ",", "2"}], "]"}], "]"}]}], ")"}], "+", 
   "iVector"}]}]}], "Input",
 CellChangeTimes->{{3.858166002356682*^9, 3.8581660202306376`*^9}, {
   3.858166408756623*^9, 3.8581664528695636`*^9}, {3.858179997539263*^9, 
   3.858179998971823*^9}, {3.8581815815496345`*^9, 3.858181583773691*^9}, {
   3.8581816207977004`*^9, 3.858181624458311*^9}, {3.8581817160784492`*^9, 
   3.8581817332026453`*^9}, {3.8582416823424587`*^9, 
   3.8582417052316236`*^9}, {3.858241802823575*^9, 3.8582418131198378`*^9}, {
   3.8582420590772247`*^9, 3.858242076111826*^9}, 3.8582427225807357`*^9, 
   3.8582451312872047`*^9},
 CellLabel->
  "In[184]:=",ExpressionUUID->"9a42af18-3289-43fd-8a96-4bd89d79c53d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "i1Vector"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "i2Vector"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"toPlot", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.858164618496561*^9, 3.858164731710362*^9}, {
  3.8581647681296053`*^9, 3.858164768397168*^9}, {3.8581648060874166`*^9, 
  3.8581648329815216`*^9}, {3.8581648658698964`*^9, 3.85816489085905*^9}, {
  3.8581650360628495`*^9, 3.858165044623519*^9}, {3.8581658022994747`*^9, 
  3.85816582294541*^9}, {3.858166022855764*^9, 3.858166138556278*^9}, {
  3.858166259951637*^9, 3.8581662732032175`*^9}, {3.858166463338999*^9, 
  3.858166496420912*^9}, {3.8581800132878494`*^9, 3.85818003161129*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"a4b707f9-21f2-412b-a090-1064adf3ba8d"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"toPlot", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<\!\(\*SubscriptBox[\(I\), \(1\)]\)(x)\>\"", ",", 
      "\"\<\!\(\*SubscriptBox[\(I\), \(2\)]\)(x)\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.858166120682987*^9, 3.858166127576948*^9}, 
   3.858248462310427*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"533e1890-57d1-4ac1-ba31-4f15dbdb937c"]
}, Closed]],

Cell[CellGroupData[{

Cell["All with proper p1 and p2", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.8557745100849714`*^9, 3.8557745127875643`*^9}, {
   3.8582418821157417`*^9, 3.858241884793322*^9}, {3.858254588636325*^9, 
   3.858254595544954*^9}},ExpressionUUID->"e8819584-4a4b-471c-bf82-\
91beb17591e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{
    RowBox[{"sol", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "-", 
    RowBox[{"sol", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    RowBox[{"sol", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}], "+", 
    RowBox[{"sol", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "y"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toPlot", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "y1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"c1", "=", 
  RowBox[{"Correlation", "[", 
   RowBox[{"x1", ",", "y1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8582546099656553`*^9, 3.858254665615143*^9}, {
  3.8582547231547737`*^9, 3.8582549293400035`*^9}, {3.85825846379569*^9, 
  3.858258478366047*^9}, {3.8582585211130257`*^9, 3.8582585476676855`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"f3f14361-c082-4a35-a973-ce65a3b0b442"],

Cell[BoxData[
 RowBox[{"g1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"toPlot", ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(I\), \(1\)]\)(\!\(\*SubscriptBox[\(p\), \(1\
\)]\))\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Italic"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(I\), \(2\)]\)(\!\(\*SubscriptBox[\(p\), \(2\
\)]\))\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Italic"}], 
        "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8582549327613783`*^9, 3.8582549383038807`*^9}, {
  3.8582549711309476`*^9, 3.8582549738758745`*^9}, {3.858255230772231*^9, 
  3.858255269163392*^9}, {3.8582562675364227`*^9, 3.8582562801693373`*^9}, {
  3.858256310422721*^9, 3.8582563111570497`*^9}, {3.8582564775544643`*^9, 
  3.858256491280553*^9}, {3.8582607276847916`*^9, 3.8582607305124674`*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"07a70c97-273e-411b-be28-20a20428c2ff"],

Cell[BoxData[
 RowBox[{"linearRelation", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{
    RowBox[{"GraphicsRow", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g0", ",", "g1"}], "}"}], ",", 
      RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"LineLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Orange", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(I\), \(1\)]\)(x)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
              "Italic"}], "]"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(I\), \(2\)]\)(x)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
              "Italic"}], "]"}]}], "}"}]}], "]"}], ",", "Right"}], "]"}], ",", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"PointLegend", "[", 
         RowBox[{
          RowBox[{"{", "Blue", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<I(x)\>\"", ",", 
             RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
             "Italic"}], "]"}], "}"}]}], "]"}], ",", "Right"}], "]"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8582563189175596`*^9, 3.858256389601838*^9}, {
  3.858256567585187*^9, 3.8582565761902237`*^9}, {3.8582566117973027`*^9, 
  3.858256690304655*^9}, {3.858256720729701*^9, 3.8582568395888166`*^9}, {
  3.8582569057762547`*^9, 3.8582570006851625`*^9}, {3.858257055076572*^9, 
  3.858257059466913*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"772433a2-ac80-45ef-a462-f5a5fe93b215"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbname", "=", 
   RowBox[{"StringDelete", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"NotebookFileName", "[", "]"}]}]}], ",", "\"\<.nb\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<figs\>\""}], 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8580776186635647`*^9, 3.8580776249101725`*^9}, {
  3.8580942041691074`*^9, 3.8580942050044537`*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"39d22d1e-6414-4b93-95e9-2f383ff3b014"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"figsDirectory", ",", 
       RowBox[{"nbname", "<>", "\"\<-im.pdf\>\""}]}], "}"}], "]"}], ",", 
    "linearRelation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.85807763551484*^9, 3.858077650084981*^9}, {
  3.8580777014215193`*^9, 3.8580777066780505`*^9}, {3.858257034506651*^9, 
  3.8582570714165936`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"6ee9eb5a-8f1c-42fa-ace0-31ee6aca493d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["All with improper p1 and p2", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.8557745100849714`*^9, 3.8557745127875643`*^9}, {
   3.8582418821157417`*^9, 3.858241884793322*^9}, {3.858254588636325*^9, 
   3.858254595544954*^9}, {3.8582579947358637`*^9, 
   3.8582579949310813`*^9}},ExpressionUUID->"ff8770a9-fd48-466e-bded-\
d8341b6f5df9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8582584493868628`*^9, 3.858258459699432*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"65c1fe87-30d8-439c-8885-48e11d7a2b0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "103"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pyrab", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2", ",", "1"}], "]"}], "]"}], "[", "#", "]"}], 
     "&"}], "/@", "x"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toPlot", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "y1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"c2", "=", 
  RowBox[{"Correlation", "[", 
   RowBox[{"x1", ",", "y1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8582546099656553`*^9, 3.858254665615143*^9}, {
  3.8582547231547737`*^9, 3.8582549293400035`*^9}, {3.858257998545128*^9, 
  3.8582580628724003`*^9}, {3.8582584826946945`*^9, 3.8582584857242317`*^9}, {
  3.8582585522317953`*^9, 3.85825855309655*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"0e511994-ebb8-4e14-833f-e6a89954c336"],

Cell[BoxData[
 RowBox[{"g2", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{"toPlot", ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(I\), \(1\)]\)(x)\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Italic"}], 
        "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(I\), \(2\)]\)(x)\>\"", ",", 
         RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", "Italic"}], 
        "]"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8582549327613783`*^9, 3.8582549383038807`*^9}, {
   3.8582549711309476`*^9, 3.8582549738758745`*^9}, {3.858255230772231*^9, 
   3.858255269163392*^9}, {3.8582562675364227`*^9, 3.8582562801693373`*^9}, {
   3.858256310422721*^9, 3.8582563111570497`*^9}, {3.8582564775544643`*^9, 
   3.858256491280553*^9}, {3.8582580725467587`*^9, 3.858258105454262*^9}, {
   3.8582586903102474`*^9, 3.858258760566019*^9}, 3.8582588304232483`*^9},
 CellLabel->
  "In[207]:=",ExpressionUUID->"778764cd-86d7-46ea-8fc3-417779801538"],

Cell[BoxData[
 RowBox[{"linearRelation", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{
    RowBox[{"GraphicsRow", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g0", ",", "g1", ",", "g2"}], "}"}], ",", 
      RowBox[{"Spacings", "\[Rule]", "25"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"LineLegend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Orange", ",", "Blue"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(I\), \(1\)]\)(x)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
              "Italic"}], "]"}], ",", 
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\!\(\*SubscriptBox[\(I\), \(2\)]\)(x)\>\"", ",", 
              RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
              "Italic"}], "]"}]}], "}"}]}], "]"}], ",", "Right"}], "]"}], ",", 
      RowBox[{"Placed", "[", 
       RowBox[{
        RowBox[{"PointLegend", "[", 
         RowBox[{
          RowBox[{"{", "Blue", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<I(x)\>\"", ",", 
             RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
             "Italic"}], "]"}], "}"}]}], "]"}], ",", "Right"}], "]"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8582563189175596`*^9, 3.858256389601838*^9}, {
  3.858256567585187*^9, 3.8582565761902237`*^9}, {3.8582566117973027`*^9, 
  3.858256690304655*^9}, {3.858256720729701*^9, 3.8582568395888166`*^9}, {
  3.8582569057762547`*^9, 3.8582570006851625`*^9}, {3.858257055076572*^9, 
  3.858257059466913*^9}, {3.858258089187277*^9, 3.8582581672021027`*^9}, {
  3.8582582226412315`*^9, 3.8582582430967855`*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"4d088653-7c39-4b7c-964e-07659de796a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nbname", "=", 
   RowBox[{"StringDelete", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"NotebookFileName", "[", "]"}]}]}], ",", "\"\<.nb\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<figs\>\""}], 
     "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8580776186635647`*^9, 3.8580776249101725`*^9}, {
  3.8580942041691074`*^9, 3.8580942050044537`*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"bd02d546-0e1e-42a9-802b-b8cae5890bda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"figsDirectory", ",", 
       RowBox[{"nbname", "<>", "\"\<-im2.pdf\>\""}]}], "}"}], "]"}], ",", 
    "linearRelation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.85807763551484*^9, 3.858077650084981*^9}, {
   3.8580777014215193`*^9, 3.8580777066780505`*^9}, {3.858257034506651*^9, 
   3.8582570714165936`*^9}, 3.85825830080943*^9},
 CellLabel->
  "In[211]:=",ExpressionUUID->"7c5038b8-cd66-481b-ba78-eb369f365cb2"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1141.2, 580.1999999999999},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c5e7f272-68fa-4dac-aa1b-a7944b7f1a2a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 207, 4, 67, "Section",ExpressionUUID->"986346a2-0213-45f1-acfa-7ad2e9a90956"],
Cell[790, 28, 1054, 27, 68, "Input",ExpressionUUID->"34b265ec-9705-4f2d-8f15-8e1086cb8323"],
Cell[1847, 57, 2654, 45, 166, "Input",ExpressionUUID->"f5c4e6fd-205b-45cc-ad44-fa420f5985ff"],
Cell[4504, 104, 964, 21, 127, "Input",ExpressionUUID->"983e1f28-e987-41b6-bf6f-2d213a23c05e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5505, 130, 330, 5, 67, "Section",ExpressionUUID->"fb582e9a-4d6e-4d6e-9b13-ab633a281617"],
Cell[5838, 137, 2809, 46, 88, "Input",ExpressionUUID->"1f409ba0-8079-4c0d-85c9-68fb0edf59ca"]
}, Closed]],
Cell[CellGroupData[{
Cell[8684, 188, 500, 8, 53, "Section",ExpressionUUID->"38f30f34-e385-47b0-9337-175fb2980307"],
Cell[9187, 198, 4272, 93, 283, "Input",ExpressionUUID->"058d8c6c-bf4b-4901-a2c4-44e2d1e2ecdb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13496, 296, 409, 6, 67, "Section",ExpressionUUID->"7ce750f2-1229-4574-bda3-624cb0734e93"],
Cell[13908, 304, 1958, 52, 88, "Input",ExpressionUUID->"4b3de830-ce3b-48db-ac44-3c96eff972f9"],
Cell[15869, 358, 2441, 60, 107, "Input",ExpressionUUID->"4edbcbd0-8fdf-455f-b667-451249ce3b9e"]
}, Closed]],
Cell[CellGroupData[{
Cell[18347, 423, 413, 6, 53, "Section",ExpressionUUID->"b115b75e-bfe7-42a2-aead-a69602ed60d6"],
Cell[CellGroupData[{
Cell[18785, 433, 470, 7, 54, "Subsection",ExpressionUUID->"de76e626-6efa-4943-98d4-58ebc15fc512"],
Cell[19258, 442, 266, 6, 28, "Input",ExpressionUUID->"2e0c8f2e-734e-468c-9104-ec621fbaceb1"],
Cell[19527, 450, 2630, 60, 127, "Input",ExpressionUUID->"20a42b9f-7740-4d37-b279-fb61ea22c4b5"],
Cell[22160, 512, 1458, 35, 49, "Input",ExpressionUUID->"a26fa7bf-daaa-4050-b03f-156cbbb852a2"],
Cell[23621, 549, 2308, 59, 107, "Input",ExpressionUUID->"fbdeb767-3fba-4293-98db-157594b53f2b"],
Cell[25932, 610, 1131, 33, 88, "Input",ExpressionUUID->"3add8b7a-572a-4fba-a3bb-619652d25675"],
Cell[27066, 645, 1437, 29, 49, "Input",ExpressionUUID->"742a7555-7c6e-468d-a2d8-7f442456e380"],
Cell[28506, 676, 895, 17, 28, "Input",ExpressionUUID->"58150093-ce54-41be-a18a-e37d18601ad1"],
Cell[29404, 695, 366, 9, 28, "Input",ExpressionUUID->"b5e2db7d-7d32-4309-ac7f-0b1475286d7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29807, 709, 517, 8, 54, "Subsection",ExpressionUUID->"0750fce2-c751-41f3-8859-6a6e758ad246"],
Cell[30327, 719, 497, 9, 28, "Input",ExpressionUUID->"bd9f9ce1-34d3-4427-977f-c8761fe4250c"],
Cell[30827, 730, 892, 19, 28, "Input",ExpressionUUID->"7d8bbf09-543c-42e2-b353-dab5b1c691b9"],
Cell[31722, 751, 1140, 27, 49, "Input",ExpressionUUID->"33f25ee7-bf68-45da-b01a-d8810b2acb76"],
Cell[32865, 780, 1384, 36, 68, "Input",ExpressionUUID->"34e2815d-97cd-4ce4-a1e5-806d49682f28"],
Cell[34252, 818, 482, 12, 28, "Input",ExpressionUUID->"91e771c0-28ea-4742-8636-37918fb0a637"]
}, Closed]],
Cell[CellGroupData[{
Cell[34771, 835, 517, 8, 38, "Subsection",ExpressionUUID->"01d303f8-9436-4e59-bb03-ae348d6a047a"],
Cell[35291, 845, 370, 7, 28, "Input",ExpressionUUID->"7ecc814c-485d-440e-a901-ef105dae84fd"],
Cell[35664, 854, 845, 18, 28, "Input",ExpressionUUID->"10664cd1-5431-4bc8-9141-03869d728660"],
Cell[36512, 874, 1068, 26, 49, "Input",ExpressionUUID->"c654258b-6aa7-4a61-9f40-51be80da1140"],
Cell[37583, 902, 1384, 36, 68, "Input",ExpressionUUID->"0ec1915e-f900-4875-bb91-d6f73c8c3a98"],
Cell[38970, 940, 459, 12, 28, "Input",ExpressionUUID->"ca058ba9-5810-4209-92a6-c9e3f936a2e2"]
}, Closed]],
Cell[CellGroupData[{
Cell[39466, 957, 517, 8, 38, "Subsection",ExpressionUUID->"b0722bd5-f00c-48cf-970c-dec13f46ee72"],
Cell[39986, 967, 396, 8, 28, "Input",ExpressionUUID->"96410906-0e00-4556-b9ff-663563c497de"],
Cell[40385, 977, 899, 19, 28, "Input",ExpressionUUID->"b0187f9c-3e09-4e4a-b2b3-99348c11c6a3"],
Cell[41287, 998, 1068, 26, 49, "Input",ExpressionUUID->"9a42af18-3289-43fd-8a96-4bd89d79c53d"],
Cell[42358, 1026, 1384, 36, 68, "Input",ExpressionUUID->"a4b707f9-21f2-412b-a090-1064adf3ba8d"],
Cell[43745, 1064, 457, 12, 28, "Input",ExpressionUUID->"533e1890-57d1-4ac1-ba31-4f15dbdb937c"]
}, Closed]],
Cell[CellGroupData[{
Cell[44239, 1081, 580, 8, 38, "Subsection",ExpressionUUID->"e8819584-4a4b-471c-bf82-91beb17591e5"],
Cell[44822, 1091, 1764, 57, 127, "Input",ExpressionUUID->"f3f14361-c082-4a35-a973-ce65a3b0b442"],
Cell[46589, 1150, 1253, 27, 88, "Input",ExpressionUUID->"07a70c97-273e-411b-be28-20a20428c2ff"],
Cell[47845, 1179, 2021, 47, 88, "Input",ExpressionUUID->"772433a2-ac80-45ef-a462-f5a5fe93b215"],
Cell[49869, 1228, 749, 20, 49, "Input",ExpressionUUID->"39d22d1e-6414-4b93-95e9-2f383ff3b014"],
Cell[50621, 1250, 525, 13, 28, "Input",ExpressionUUID->"6ee9eb5a-8f1c-42fa-ace0-31ee6aca493d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51183, 1268, 636, 9, 54, "Subsection",ExpressionUUID->"ff8770a9-fd48-466e-bded-d8341b6f5df9"],
Cell[51822, 1279, 177, 3, 28, "Input",ExpressionUUID->"65c1fe87-30d8-439c-8885-48e11d7a2b0d"],
Cell[52002, 1284, 1407, 42, 107, "Input",ExpressionUUID->"0e511994-ebb8-4e14-833f-e6a89954c336"],
Cell[53412, 1328, 1243, 24, 88, "Input",ExpressionUUID->"778764cd-86d7-46ea-8fc3-417779801538"],
Cell[54658, 1354, 2188, 49, 88, "Input",ExpressionUUID->"4d088653-7c39-4b7c-964e-07659de796a1"],
Cell[56849, 1405, 749, 20, 49, "Input",ExpressionUUID->"bd02d546-0e1e-42a9-802b-b8cae5890bda"],
Cell[57601, 1427, 549, 13, 28, "Input",ExpressionUUID->"7c5038b8-cd66-481b-ba78-eb369f365cb2"]
}, Open  ]]
}, Open  ]]
}
]
*)

