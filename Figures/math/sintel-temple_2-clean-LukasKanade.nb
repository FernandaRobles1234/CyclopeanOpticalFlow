(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27027,        615]
NotebookOptionsPosition[     25023,        574]
NotebookOutlinePosition[     25611,        595]
CellTagsIndexPosition[     25568,        592]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Little Tests, One pyramidal lvl", "Title",
 CellChangeTimes->{{3.836408933336395*^9, 3.836408939343516*^9}, 
   3.8364092608930736`*^9, {3.839597016893468*^9, 3.839597019185139*^9}, 
   3.8396001415844855`*^9, {3.840547036727909*^9, 3.8405470374003563`*^9}, {
   3.8431583610963435`*^9, 3.8431583669555917`*^9}, {3.8435589181641517`*^9, 
   3.8435589198932934`*^9}, 3.843744422167187*^9, {3.8490969784321938`*^9, 
   3.8490969840245957`*^9}},ExpressionUUID->"db62e516-81ba-4d70-b1b1-\
9cd33c91d768"],

Cell[CellGroupData[{

Cell["Start", "Section",
 CellChangeTimes->{{3.8400383593859367`*^9, 3.8400383615886106`*^9}, {
  3.8433207191908846`*^9, 
  3.8433207198782096`*^9}},ExpressionUUID->"78b447b1-9527-4a44-8f25-\
13c25c5e9101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", "to", " ", "path", " ", "packages"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"packageDirectory", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"ParentDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], ",", 
       "\"\<1DPackage\>\"", ",", "\"\<*\>\""}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Path", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8437444304820337`*^9, {3.843744475443145*^9, 3.843744489249152*^9}, {
   3.84374460430722*^9, 3.843744614114832*^9}, {3.8437451879521313`*^9, 
   3.8437451890826197`*^9}, {3.8437453266046667`*^9, 3.8437453290342407`*^9}, 
   3.8490954877290297`*^9},
 CellLabel->"In[51]:=",ExpressionUUID->"73bb8eb7-fd63-4382-a987-e4763fd2c07f"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<ReadSintel`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramidalStereoAll`\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<LukasKanade`\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\>\"", ",", "\"\<OverConstrained\>\"", ",", 
     "\"\<SemiConstrained\>\"", ",", "\"\<Constrained\>\"", ",", 
     "\"\<ConstrainedNewMethod\>\"", ",", "\"\<ConstrainedCorrelation\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"\"\<pyramidalCyclope1D\>\"", "<>", "met", "<>", "\"\<`\>\""}], 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"met", ",", "methods"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8405470666010065`*^9, 3.8405470721952195`*^9}, {
   3.840550195734952*^9, 3.840550216899179*^9}, {3.8417693956828256`*^9, 
   3.8417694295737267`*^9}, 3.8417694792252483`*^9, {3.8423558358531294`*^9, 
   3.842355838266631*^9}, {3.843139686906508*^9, 3.8431397006034536`*^9}, 
   3.8431400354897623`*^9, {3.8431583092259803`*^9, 3.843158312433055*^9}, {
   3.8431587050542717`*^9, 3.8431587088646235`*^9}, {3.8432405156973643`*^9, 
   3.8432405180756235`*^9}, {3.8432434086403227`*^9, 3.8432434521650333`*^9}, 
   3.8435781970825057`*^9, 3.8435786572990074`*^9, {3.843745725318043*^9, 
   3.843745730794486*^9}, {3.8437501550408554`*^9, 3.843750161634801*^9}, {
   3.843750230642497*^9, 3.8437503524543705`*^9}, {3.8437504375112853`*^9, 
   3.8437504386938276`*^9}, {3.843755017106989*^9, 3.84375503403273*^9}, {
   3.843755426452015*^9, 3.843755445994274*^9}, {3.8438346833502474`*^9, 
   3.84383468782578*^9}, 3.843835196563305*^9, {3.8438498338643837`*^9, 
   3.843849837390987*^9}, {3.8438505820282726`*^9, 3.843850585529437*^9}, {
   3.843851080665611*^9, 3.8438510924880347`*^9}, {3.843917874644593*^9, 
   3.84391788967353*^9}, {3.843919464270398*^9, 3.8439194690819983`*^9}, {
   3.844258411683423*^9, 3.8442584146673145`*^9}, 3.844258734579767*^9, 
   3.84426385350611*^9, 3.8442668082773514`*^9, {3.844780498357904*^9, 
   3.8447805041423593`*^9}, {3.8449446421268377`*^9, 3.844944649113989*^9}, {
   3.844944993663724*^9, 3.844945009436464*^9}, 3.8490954964696183`*^9, {
   3.8556557035434666`*^9, 3.8556557097903485`*^9}, {3.857638050032972*^9, 
   3.8576380563398314`*^9}, {3.8577490797668853`*^9, 3.857749130037279*^9}, {
   3.8582535128524547`*^9, 3.85825351495591*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"8e037178-fa87-40a0-a24d-b460c488efbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Declare", " ", "path", " ", "for", " ", "SINTEL", " ", "Data", " ", 
    "depending", " ", "on", " ", "user"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"baseSINTEL", "=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "$UserName", ",", "\[IndentingNewLine]", "\"\<fieri\>\"", ",", 
      "\"\<D:\\\\MastersMathematica\\\\Data\\\\Sintel\>\"", ",", 
      "\[IndentingNewLine]", "\"\<roys\>\"", ",", 
      "\"\</home/roys/datasets/SINTEL-stereo\>\""}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8437446388681035`*^9, 3.8437446932344007`*^9}, {
  3.8457196414004154`*^9, 3.8457196427641745`*^9}, {3.84571973682537*^9, 
  3.845719738564255*^9}, {3.8556556699480524`*^9, 3.8556556720163326`*^9}, {
  3.855655723820243*^9, 3.855655724983708*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"17e8648f-4974-4529-81b4-a9cf0e6c6f42"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}},ExpressionUUID->"6c77556b-bbc0-4ce0-b1d6-\
2dd77c2c36be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "downscaling", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
    RowBox[{"read", "[", 
     RowBox[{
     "baseSINTEL", ",", "\"\<temple_2\>\"", ",", "\"\<0001\>\"", ",", "r", 
      ",", "\"\<clean\>\""}], "]"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.843745436013342*^9, 3.843745445266261*^9}, {
   3.8437454795752115`*^9, 3.843745636648714*^9}, 3.8442584513876195`*^9, {
   3.8442678037667413`*^9, 3.844267808172227*^9}, {3.8442680916621*^9, 
   3.8442680954422073`*^9}, {3.845719669524063*^9, 3.8457196845186987`*^9}, {
   3.845719716504841*^9, 3.8457198197977877`*^9}, {3.8457199186400223`*^9, 
   3.8457199239790096`*^9}, {3.8457200595643215`*^9, 
   3.8457201091945724`*^9}, {3.8457201816476693`*^9, 
   3.8457203881756153`*^9}, {3.8457205408372355`*^9, 3.84572057561047*^9}, {
   3.8457210342212343`*^9, 3.845721046589213*^9}, {3.84572189289744*^9, 
   3.8457220241968083`*^9}, {3.845736827573617*^9, 3.8457368310761595`*^9}, {
   3.8457374087399197`*^9, 3.8457375298050385`*^9}, {3.845737585153984*^9, 
   3.8457376009137864`*^9}, {3.8457376317120295`*^9, 
   3.8457376491018925`*^9}, {3.8457379681682467`*^9, 3.845737968918872*^9}, {
   3.8459159937269096`*^9, 3.845916065594756*^9}, {3.8459208505722537`*^9, 
   3.8459208626015835`*^9}, {3.8460030572006135`*^9, 
   3.8460030654200583`*^9}, {3.8460122899599075`*^9, 
   3.8460123288850226`*^9}, {3.8460125228762617`*^9, 3.846012601456051*^9}, {
   3.846013064036981*^9, 3.846013089811376*^9}, {3.8460131447480764`*^9, 
   3.84601331885571*^9}, {3.846013349534447*^9, 3.846013372038978*^9}, {
   3.846167155864127*^9, 3.8461672195604773`*^9}, {3.846167378389165*^9, 
   3.846167408296273*^9}, {3.846261434953365*^9, 3.8462614597660093`*^9}, {
   3.852739560630743*^9, 3.8527395774452496`*^9}, {3.8527397025311766`*^9, 
   3.852739750814078*^9}, {3.8527398603045654`*^9, 3.8527398693552265`*^9}, {
   3.852739915577756*^9, 3.852739920809184*^9}, {3.8527399973487043`*^9, 
   3.8527400233960047`*^9}, 3.852740148676304*^9, {3.8527402375986753`*^9, 
   3.8527402825741987`*^9}, {3.8527407084687247`*^9, 3.85274071078141*^9}, 
   3.8529724118023367`*^9, {3.8540294579387217`*^9, 3.8540294593234234`*^9}, {
   3.854037562691866*^9, 3.8540375980861387`*^9}, 3.855616425558366*^9, 
   3.8556208471265903`*^9, 3.855655689532875*^9, {3.8556557926221733`*^9, 
   3.8556557942826843`*^9}, {3.856365670503353*^9, 3.856365671342097*^9}, {
   3.8564466365811934`*^9, 3.8564466372125964`*^9}, {3.857650096029873*^9, 
   3.857650097447332*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"12c4baae-e516-4624-b168-298a872bf7c4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Image sections", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}, {3.8466840957849693`*^9, 
   3.8466840985499296`*^9}, {3.8490432101029243`*^9, 3.849043210540059*^9}, {
   3.8540301701664133`*^9, 
   3.8540301746101103`*^9}},ExpressionUUID->"14cd47e4-c6f6-4097-91af-\
9d3b39c15f23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "44"}], "}"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "102"}], "}"}], " ", "arbitrary", " ", "size", " ", 
     "to", " ", "make", " ", "the", " ", "method", " ", "faster"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"listDims", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"100", ",", "100"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"350", ",", "300"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"600", ",", "150"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"500", ",", "100"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ims", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nx", "=", 
        RowBox[{
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "r"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ny", "=", 
        RowBox[{
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", "r"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"iaa", ",", "ibb", ",", "idd", ",", "ioo"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageTake", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"ny", ",", 
              RowBox[{"ny", "+", "44"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nx", ",", 
              RowBox[{"nx", "+", "102"}]}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"MinMax", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"ImageData", "[", "idd", "]"}], "]"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"iaa", ",", "ibb", ",", "idd"}], "}"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"dims", ",", "listDims"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max", "=", 
     RowBox[{
      RowBox[{"MinMax", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<max dv=\>\"", ",", " ", "max"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8540301774171877`*^9, 3.8540301930120335`*^9}, 
   3.8540302359774623`*^9, {3.8540304837998714`*^9, 3.8540305814409323`*^9}, {
   3.8540306768373904`*^9, 3.854030719206648*^9}, {3.8540375443798003`*^9, 
   3.854037550639119*^9}, {3.854037583276456*^9, 3.854037619859151*^9}, {
   3.855075038045244*^9, 3.855075043821375*^9}, {3.8551666610955935`*^9, 
   3.8551666680434566`*^9}, {3.8552361374347477`*^9, 3.8552361395575447`*^9}, 
   3.855606653599547*^9, {3.855620854110469*^9, 3.8556209149205413`*^9}, {
   3.8556209535217524`*^9, 3.855620957512952*^9}, {3.855621003684822*^9, 
   3.8556210169696846`*^9}, 3.855621356695964*^9, {3.8556243252160034`*^9, 
   3.8556243421946826`*^9}, {3.8556557696034107`*^9, 3.85565582867811*^9}, {
   3.855658829471591*^9, 3.8556588339197435`*^9}, {3.8556589991089716`*^9, 
   3.855659000204501*^9}, {3.856029226528818*^9, 3.856029323464652*^9}, {
   3.8560294539344707`*^9, 3.856029455315941*^9}, {3.8560295871955366`*^9, 
   3.8560295899242425`*^9}, {3.8560299354485044`*^9, 3.856029936903365*^9}, 
   3.8560301071891947`*^9, {3.8560302725995846`*^9, 3.856030337066291*^9}, {
   3.8562649735391903`*^9, 3.856264982093645*^9}, {3.856265213337758*^9, 
   3.8562652282305126`*^9}, {3.8562653905722523`*^9, 3.856265405675403*^9}, 
   3.8562654571773543`*^9, {3.8562655221385803`*^9, 3.856265555552207*^9}, {
   3.856266347193515*^9, 3.8562663790481224`*^9}, {3.8562681401789465`*^9, 
   3.856268157582207*^9}, 3.856268192316244*^9, {3.856345960366991*^9, 
   3.856345971200444*^9}, 3.8563647730311446`*^9, {3.8563652489490056`*^9, 
   3.8563652602613287`*^9}, {3.8576380715463934`*^9, 3.8576380848582373`*^9}, 
   3.857650572689826*^9, 3.8577491440838404`*^9, {3.8578259350468187`*^9, 
   3.8578259367418346`*^9}, 3.8578282523523903`*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"07fae993-cd27-4bd2-a7e2-91121d4058e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Creating", " ", "condition"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"topbot", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "10"}], ",", "0"}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{
  3.85602579310735*^9, {3.856025828413677*^9, 3.856025836280633*^9}, {
   3.8560263179240074`*^9, 3.8560263321089935`*^9}, {3.8560269078674603`*^9, 
   3.856026912964712*^9}, {3.8560282894498405`*^9, 3.856028289643145*^9}, {
   3.856264882324275*^9, 3.8562648841090307`*^9}, {3.8576505841257577`*^9, 
   3.8576505843635817`*^9}, {3.8578244712135057`*^9, 
   3.8578244715812674`*^9}, {3.857824895006401*^9, 3.8578248991110067`*^9}, {
   3.857824963302765*^9, 3.8578249717362647`*^9}, 3.8578255597215824`*^9, {
   3.8578275636412277`*^9, 3.857827563925275*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"0029d2d5-ecc3-4e38-84e2-381a195880ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Selection", " ", "criteria", " ", "values"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"scale", "=", "topbot"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"affiche", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p_", ",", "v_"}], "}"}], ",", "y_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RainbowColor", "[", 
        RowBox[{"Rescale", "[", 
         RowBox[{"v", ",", "scale", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "-", "0.5"}], ",", 
          RowBox[{"y", "+", "0.5"}]}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RainbowColor", "[", "z_", "]"}], ":=", 
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Purple", ",", "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
         "Orange", ",", "Red"}], "}"}], ",", "z"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"legendBar", "=", 
     RowBox[{"BarLegend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"RainbowColor", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"Ticks", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Rescale", "[", 
             RowBox[{"i", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", "scale"}], "]"}]}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", "1", ",", "0.2"}], "]"}]}], "}"}]}], "]"}]}]}],
       "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8552371992107506`*^9, {3.8556560880903497`*^9, 3.8556560884374094`*^9}, {
   3.855656424900697*^9, 3.855656425334103*^9}, {3.855656579791251*^9, 
   3.8556565998018928`*^9}, {3.8556590896464634`*^9, 3.855659090055107*^9}, 
   3.8560254579002285`*^9, {3.856025507594355*^9, 3.856025508519867*^9}, {
   3.856026279616514*^9, 3.856026337021175*^9}, {3.856026550065236*^9, 
   3.8560265524725733`*^9}, {3.856266001448427*^9, 3.856266014121132*^9}, 
   3.856266045270571*^9, {3.8562705041515694`*^9, 3.856270515177141*^9}, {
   3.856276238838126*^9, 3.8562762458511715`*^9}, {3.857823091295298*^9, 
   3.8578230915926094`*^9}, {3.8578252905273643`*^9, 3.857825292677532*^9}, {
   3.8578254317697906`*^9, 3.8578254332022896`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"56241293-964f-4a5c-882e-b486fbee368c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"flowtable", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"flow", "=", 
       RowBox[{"stereoDepth", "[", 
        RowBox[{
         RowBox[{"im", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"im", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "1", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "103"}], "]"}], ",", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "45"}], "]"}], ",", "\"\<LukasKanade\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posx", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "45"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "103"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"finalflow", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"posx", ",", "flow"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "2", "}"}], ",", 
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"We", " ", "create", " ", "g0"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"g0", "=", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "0.009", "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"affiche", "[", 
               RowBox[{"#", ",", 
                RowBox[{"45", "-", "y"}]}], "]"}], "&"}], "/@", 
             RowBox[{"finalflow", "[", 
              RowBox[{"[", "y", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "1", ",", "45"}], "}"}]}], "]"}]}], "}"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g0", "=", 
       RowBox[{"Rasterize", "[", 
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"im", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "g0"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{
           RowBox[{"ImageDimensions", "[", 
            RowBox[{"im", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "5"}]}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solution", "=", 
       RowBox[{"Image", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"RainbowColor", ",", "imd"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"imd", ",", 
            RowBox[{"ImageData", "[", 
             RowBox[{"Rescale", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"im", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "scale", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ConformImages", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Rasterize", "[", 
           RowBox[{
            RowBox[{"Image", "[", "#", "]"}], ",", 
            RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"im", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "g0", ",", 
            "solution"}], "}"}], "]"}]}], ",", 
        RowBox[{"{", "4000", "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"im", ",", "ims"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.857749239246378*^9, 3.857749296438299*^9}, {
   3.857751170074675*^9, 3.857751226385314*^9}, {3.85775129433496*^9, 
   3.857751294645108*^9}, {3.8577513564954786`*^9, 3.857751430485487*^9}, {
   3.857751469594558*^9, 3.857751541955908*^9}, {3.8577517048210783`*^9, 
   3.857751738730099*^9}, {3.8578229049366255`*^9, 3.857822918661703*^9}, {
   3.857823148951684*^9, 3.857823155310225*^9}, {3.8578232272828665`*^9, 
   3.8578232876937757`*^9}, {3.85782369159933*^9, 3.857823758073352*^9}, {
   3.8578237927630615`*^9, 3.857823995629758*^9}, {3.8578240693254504`*^9, 
   3.8578240879639196`*^9}, {3.857827901081368*^9, 3.857827926293833*^9}, {
   3.8578279862015047`*^9, 3.8578279943009467`*^9}, {3.8578280736367297`*^9, 
   3.8578280833646936`*^9}, {3.8578281514609876`*^9, 3.857828221041457*^9}, {
   3.857828301581473*^9, 3.857828350671525*^9}, 3.857828500100486*^9, 
   3.857828628833593*^9, {3.8578289060224323`*^9, 3.857828914735655*^9}, 
   3.857828964010661*^9, {3.8578290157709875`*^9, 3.857829017871115*^9}, 
   3.857829078915475*^9, {3.857829118862814*^9, 3.8578291218457975`*^9}, {
   3.8578303446318374`*^9, 3.857830345267335*^9}, {3.8578314382106028`*^9, 
   3.8578314386654787`*^9}, {3.8582535266981335`*^9, 3.8582535300224752`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"273f90fb-576f-48d7-8021-d73458d3d114"],

Cell[BoxData[
 RowBox[{"imFinal", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{
    RowBox[{"Grid", "[", "flowtable", "]"}], ",", "legendBar"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.857824582932778*^9, 3.8578246155038176`*^9}, {
   3.8578247372971125`*^9, 3.8578247584985013`*^9}, 3.857825018608395*^9, {
   3.8578251180138693`*^9, 3.8578251214529467`*^9}, {3.8578255005613146`*^9, 
   3.8578255138745666`*^9}, {3.8578256771543474`*^9, 3.857825724050491*^9}, 
   3.857828192648736*^9, {3.857828224456701*^9, 3.857828236922953*^9}, {
   3.857829216982174*^9, 3.8578292253972964`*^9}, {3.857829439700474*^9, 
   3.857829463945572*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"7dacc821-37d1-44c1-b781-06a221bcb768"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbname", "=", 
   RowBox[{"StringDelete", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"NotebookFileName", "[", "]"}]}]}], ",", "\"\<.nb\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.8578292332959776`*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"d9fca5da-e158-45f0-82da-7f3c6524d68a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"figsDirectory", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<figs\>\""}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figsDirectory", ",", 
      RowBox[{"nbname", "<>", "\"\<-im.pdf\>\""}]}], "}"}], "]"}], ",", 
   "imFinal"}], "]"}]}], "Input",
 CellChangeTimes->{{3.857829241214033*^9, 3.8578292492584553`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"6f541d81-0175-4756-875a-01c33f1b53af"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152., 585.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>0.9 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a57452fb-e78b-430d-880f-b3a8051d287c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 505, 7, 89, "Title",ExpressionUUID->"db62e516-81ba-4d70-b1b1-9cd33c91d768"],
Cell[CellGroupData[{
Cell[1110, 33, 207, 4, 59, "Section",ExpressionUUID->"78b447b1-9527-4a44-8f25-13c25c5e9101"],
Cell[1320, 39, 1050, 26, 61, "Input",ExpressionUUID->"73bb8eb7-fd63-4382-a987-e4763fd2c07f"],
Cell[2373, 67, 2690, 45, 164, "Input",ExpressionUUID->"8e037178-fa87-40a0-a24d-b460c488efbd"],
Cell[5066, 114, 960, 20, 112, "Input",ExpressionUUID->"17e8648f-4974-4529-81b4-a9cf0e6c6f42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6063, 139, 330, 5, 59, "Section",ExpressionUUID->"6c77556b-bbc0-4ce0-b1d6-2dd77c2c36be"],
Cell[6396, 146, 2805, 45, 79, "Input",ExpressionUUID->"12c4baae-e516-4624-b168-298a872bf7c4"]
}, Closed]],
Cell[CellGroupData[{
Cell[9238, 196, 500, 8, 47, "Section",ExpressionUUID->"14cd47e4-c6f6-4097-91af-9d3b39c15f23"],
Cell[9741, 206, 4493, 99, 250, "Input",ExpressionUUID->"07fae993-cd27-4bd2-a7e2-91121d4058e3"],
Cell[14237, 307, 921, 18, 43, "Input",ExpressionUUID->"0029d2d5-ecc3-4e38-84e2-381a195880ef"],
Cell[15161, 327, 2798, 72, 112, "Input",ExpressionUUID->"56241293-964f-4a5c-882e-b486fbee368c"],
Cell[17962, 401, 5249, 123, 181, "Input",ExpressionUUID->"273f90fb-576f-48d7-8021-d73458d3d114"],
Cell[23214, 526, 720, 13, 25, "Input",ExpressionUUID->"7dacc821-37d1-44c1-b781-06a221bcb768"],
Cell[23937, 541, 386, 10, 25, "Input",ExpressionUUID->"d9fca5da-e158-45f0-82da-7f3c6524d68a"],
Cell[24326, 553, 669, 17, 43, "Input",ExpressionUUID->"6f541d81-0175-4756-875a-01c33f1b53af"]
}, Open  ]]
}, Open  ]]
}
]
*)

