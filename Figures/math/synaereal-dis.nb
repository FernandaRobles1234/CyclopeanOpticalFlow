(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87574,       1973]
NotebookOptionsPosition[     82709,       1891]
NotebookOutlinePosition[     83255,       1910]
CellTagsIndexPosition[     83212,       1907]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Little Tests, One pyramidal lvl", "Title",
 CellChangeTimes->{{3.836408933336395*^9, 3.836408939343516*^9}, 
   3.8364092608930736`*^9, {3.839597016893468*^9, 3.839597019185139*^9}, 
   3.8396001415844855`*^9, {3.840547036727909*^9, 3.8405470374003563`*^9}, {
   3.8431583610963435`*^9, 3.8431583669555917`*^9}, {3.8435589181641517`*^9, 
   3.8435589198932934`*^9}, 3.843744422167187*^9, {3.8490969784321938`*^9, 
   3.8490969840245957`*^9}},ExpressionUUID->"db62e516-81ba-4d70-b1b1-\
9cd33c91d768"],

Cell[CellGroupData[{

Cell["Start", "Section",
 CellChangeTimes->{{3.8400383593859367`*^9, 3.8400383615886106`*^9}, {
  3.8433207191908846`*^9, 
  3.8433207198782096`*^9}},ExpressionUUID->"78b447b1-9527-4a44-8f25-\
13c25c5e9101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", "to", " ", "path", " ", "packages"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"packageDirectory", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"ParentDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], ",", 
       "\"\<1DPackage\>\"", ",", "\"\<*\>\""}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Path", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8437444304820337`*^9, {3.843744475443145*^9, 3.843744489249152*^9}, {
   3.84374460430722*^9, 3.843744614114832*^9}, {3.8437451879521313`*^9, 
   3.8437451890826197`*^9}, {3.8437453266046667`*^9, 3.8437453290342407`*^9}, 
   3.8490954877290297`*^9},
 CellLabel->
  "(Debug) In[106]:=",ExpressionUUID->"73bb8eb7-fd63-4382-a987-e4763fd2c07f"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<ReadSintel`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<pyramidalStereoAll`\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\>\"", ",", "\"\<OverConstrained\>\"", ",", 
     "\"\<SemiConstrained\>\"", ",", "\"\<Constrained\>\"", ",", 
     "\"\<ConstrainedNewMethod\>\"", ",", "\"\<ConstrainedCorrelation\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"\"\<pyramidalCyclope1D\>\"", "<>", "met", "<>", "\"\<`\>\""}], 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"met", ",", "methods"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8405470666010065`*^9, 3.8405470721952195`*^9}, {
   3.840550195734952*^9, 3.840550216899179*^9}, {3.8417693956828256`*^9, 
   3.8417694295737267`*^9}, 3.8417694792252483`*^9, {3.8423558358531294`*^9, 
   3.842355838266631*^9}, {3.843139686906508*^9, 3.8431397006034536`*^9}, 
   3.8431400354897623`*^9, {3.8431583092259803`*^9, 3.843158312433055*^9}, {
   3.8431587050542717`*^9, 3.8431587088646235`*^9}, {3.8432405156973643`*^9, 
   3.8432405180756235`*^9}, {3.8432434086403227`*^9, 3.8432434521650333`*^9}, 
   3.8435781970825057`*^9, 3.8435786572990074`*^9, {3.843745725318043*^9, 
   3.843745730794486*^9}, {3.8437501550408554`*^9, 3.843750161634801*^9}, {
   3.843750230642497*^9, 3.8437503524543705`*^9}, {3.8437504375112853`*^9, 
   3.8437504386938276`*^9}, {3.843755017106989*^9, 3.84375503403273*^9}, {
   3.843755426452015*^9, 3.843755445994274*^9}, {3.8438346833502474`*^9, 
   3.84383468782578*^9}, 3.843835196563305*^9, {3.8438498338643837`*^9, 
   3.843849837390987*^9}, {3.8438505820282726`*^9, 3.843850585529437*^9}, {
   3.843851080665611*^9, 3.8438510924880347`*^9}, {3.843917874644593*^9, 
   3.84391788967353*^9}, {3.843919464270398*^9, 3.8439194690819983`*^9}, {
   3.844258411683423*^9, 3.8442584146673145`*^9}, 3.844258734579767*^9, 
   3.84426385350611*^9, 3.8442668082773514`*^9, {3.844780498357904*^9, 
   3.8447805041423593`*^9}, {3.8449446421268377`*^9, 3.844944649113989*^9}, {
   3.844944993663724*^9, 3.844945009436464*^9}, 3.8490954964696183`*^9, {
   3.8557668392689147`*^9, 3.855766842588916*^9}, {3.8577321503315787`*^9, 
   3.8577321594512687`*^9}},
 CellLabel->
  "(Debug) In[108]:=",ExpressionUUID->"8e037178-fa87-40a0-a24d-b460c488efbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Declare", " ", "path", " ", "for", " ", "SINTEL", " ", "Data", " ", 
    "depending", " ", "on", " ", "user"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"baseAEREAL", "=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "$UserName", ",", "\[IndentingNewLine]", "\"\<fieri\>\"", ",", 
      "\"\<D:\\\\MastersMathematica\\\\Data\\\\Aereal\>\"", ",", 
      "\[IndentingNewLine]", "\"\<roys\>\"", ",", 
      "\"\</home/roys/datasets/SINTEL-stereo\>\""}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8437446388681035`*^9, 3.8437446932344007`*^9}, {
  3.8457196414004154`*^9, 3.8457196427641745`*^9}, {3.84571973682537*^9, 
  3.845719738564255*^9}},
 CellLabel->
  "(Debug) In[113]:=",ExpressionUUID->"17e8648f-4974-4529-81b4-a9cf0e6c6f42"]
}, Closed]],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}},ExpressionUUID->"6c77556b-bbc0-4ce0-b1d6-\
2dd77c2c36be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "downscaling", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reduce", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"path1", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"baseAEREAL", ",", "\"\<Aereal1.png\>\""}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"path2", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"baseAEREAL", ",", "\"\<Aereal2.png\>\""}], "}"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pathResult", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"baseAEREAL", ",", "\"\<AerealResult.png\>\""}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rgb2d", "[", 
      RowBox[{"{", 
       RowBox[{"r_", ",", "g_", ",", "b_"}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"r", "*", "4"}], "+", 
      RowBox[{"g", "/", "64"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"clean", "[", "img_", "]"}], ":=", 
     RowBox[{"Image", "[", 
      RowBox[{"ImageData", "[", "img", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reduire", "[", 
      RowBox[{"img_", ",", "1"}], "]"}], ":=", "img"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reduire", "[", 
      RowBox[{"img_", ",", "factor_"}], "]"}], ":=", 
     RowBox[{"ImageResize", "[", 
      RowBox[{"img", ",", 
       RowBox[{
        RowBox[{"ImageDimensions", "[", "img", "]"}], "/", "factor"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iaa", "=", 
     RowBox[{"reduire", "[", 
      RowBox[{
       RowBox[{"ColorConvert", "[", 
        RowBox[{
         RowBox[{"clean", "@", 
          RowBox[{"Import", "[", "path1", "]"}]}], ",", "\"\<GrayScale\>\""}],
         "]"}], ",", "reduce"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ibb", "=", 
     RowBox[{"reduire", "[", 
      RowBox[{
       RowBox[{"ColorConvert", "[", 
        RowBox[{
         RowBox[{"clean", "@", 
          RowBox[{"Import", "[", "path2", "]"}]}], ",", "\"\<GrayScale\>\""}],
         "]"}], ",", "reduce"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iccolor", "=", 
     RowBox[{"reduire", "[", 
      RowBox[{
       RowBox[{"clean", "@", 
        RowBox[{"Import", "[", "pathResult", "]"}]}], ",", "reduce"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "iaa", "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.843745436013342*^9, 3.843745445266261*^9}, {
   3.8437454795752115`*^9, 3.843745636648714*^9}, 3.8442584513876195`*^9, {
   3.8442678037667413`*^9, 3.844267808172227*^9}, {3.8442680916621*^9, 
   3.8442680954422073`*^9}, {3.845719669524063*^9, 3.8457196845186987`*^9}, {
   3.845719716504841*^9, 3.8457198197977877`*^9}, {3.8457199186400223`*^9, 
   3.8457199239790096`*^9}, {3.8457200595643215`*^9, 
   3.8457201091945724`*^9}, {3.8457201816476693`*^9, 
   3.8457203881756153`*^9}, {3.8457205408372355`*^9, 3.84572057561047*^9}, {
   3.8457210342212343`*^9, 3.845721046589213*^9}, {3.84572189289744*^9, 
   3.8457220241968083`*^9}, {3.845736827573617*^9, 3.8457368310761595`*^9}, {
   3.8457374087399197`*^9, 3.8457375298050385`*^9}, {3.845737585153984*^9, 
   3.8457376009137864`*^9}, {3.8457376317120295`*^9, 
   3.8457376491018925`*^9}, {3.8457379681682467`*^9, 3.845737968918872*^9}, {
   3.8459159937269096`*^9, 3.845916065594756*^9}, {3.8459208505722537`*^9, 
   3.8459208626015835`*^9}, {3.8460030572006135`*^9, 
   3.8460030654200583`*^9}, {3.8460122899599075`*^9, 
   3.8460123288850226`*^9}, {3.8460125228762617`*^9, 3.846012601456051*^9}, {
   3.846013064036981*^9, 3.846013089811376*^9}, {3.8460131447480764`*^9, 
   3.84601331885571*^9}, {3.846013349534447*^9, 3.846013372038978*^9}, {
   3.846167155864127*^9, 3.8461672195604773`*^9}, {3.846167378389165*^9, 
   3.846167408296273*^9}, {3.846261434953365*^9, 3.8462614597660093`*^9}, {
   3.852739560630743*^9, 3.8527395774452496`*^9}, {3.8527397025311766`*^9, 
   3.852739750814078*^9}, {3.8527398603045654`*^9, 3.8527398693552265`*^9}, {
   3.852739915577756*^9, 3.852739920809184*^9}, {3.8527399973487043`*^9, 
   3.8527400233960047`*^9}, 3.852740148676304*^9, {3.8527402375986753`*^9, 
   3.8527402825741987`*^9}, {3.8527407084687247`*^9, 3.85274071078141*^9}, 
   3.8529724118023367`*^9, {3.8540294579387217`*^9, 3.8540294593234234`*^9}, {
   3.854037562691866*^9, 3.8540375980861387`*^9}, 3.855616425558366*^9, 
   3.8556208471265903`*^9, {3.8577323740961676`*^9, 3.8577323753751755`*^9}},
 CellLabel->
  "(Debug) In[114]:=",ExpressionUUID->"12c4baae-e516-4624-b168-298a872bf7c4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Image sections", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}, {3.8466840957849693`*^9, 
   3.8466840985499296`*^9}, {3.8490432101029243`*^9, 3.849043210540059*^9}, {
   3.8540301701664133`*^9, 
   3.8540301746101103`*^9}},ExpressionUUID->"13c240f6-3055-4982-95f2-\
d32f55b04187"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "44"}], "}"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "102"}], "}"}], " ", "arbitrary", " ", "size", " ", 
     "to", " ", "make", " ", "the", " ", "method", " ", "faster"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"listDims", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"500", ",", "500"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"ims", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"nx", "=", 
        RowBox[{
         RowBox[{"dims", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "reduce"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ny", "=", 
        RowBox[{
         RowBox[{"dims", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", "reduce"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tim", "=", "3"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ia", ",", "ib", ",", "icolor"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageTake", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"ny", ",", 
              RowBox[{"ny", "+", 
               RowBox[{"44", "*", "tim"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nx", ",", 
              RowBox[{"nx", "+", 
               RowBox[{"102", "*", "tim"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"iaa", ",", "ibb", ",", "iccolor"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ia", ",", "ib"}], "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"dims", ",", "listDims"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8540301774171877`*^9, 3.8540301930120335`*^9}, 
   3.8540302359774623`*^9, {3.8540304837998714`*^9, 3.8540305814409323`*^9}, {
   3.8540306768373904`*^9, 3.854030719206648*^9}, {3.8540375443798003`*^9, 
   3.854037550639119*^9}, {3.854037583276456*^9, 3.854037619859151*^9}, {
   3.855075038045244*^9, 3.855075043821375*^9}, {3.8551666610955935`*^9, 
   3.8551666680434566`*^9}, {3.8552361374347477`*^9, 3.8552361395575447`*^9}, 
   3.855606653599547*^9, {3.855620854110469*^9, 3.8556209149205413`*^9}, {
   3.8556209535217524`*^9, 3.855620957512952*^9}, {3.855621003684822*^9, 
   3.8556210169696846`*^9}, 3.855621356695964*^9, {3.8556243252160034`*^9, 
   3.8556243421946826`*^9}, 3.860032187211234*^9, 3.8601668318920975`*^9, 
   3.8601673113699193`*^9, 3.8602979050934362`*^9, 3.860301982814511*^9},
 CellLabel->
  "(Debug) In[126]:=",ExpressionUUID->"a454c9e1-f6e4-4a91-b02d-dd2cfa30fe82"]
}, Open  ]],

Cell[CellGroupData[{

Cell["V0 function", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}, {3.8466840957849693`*^9, 
   3.8466840985499296`*^9}, {3.8490432101029243`*^9, 3.849043210540059*^9}, {
   3.855166703570342*^9, 
   3.8551667074336195`*^9}},ExpressionUUID->"5a8fbb8b-2497-4931-865a-\
b3148d964fa0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"removeClosest", "[", "s_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "c"}], "}"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Nearest", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Norm", "[", 
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"n", "[", 
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "s", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ")"}], "&"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Delete", "[", 
        RowBox[{"s", ",", "c"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"removeClosest", "[", "s_", "]"}], ":=", 
   RowBox[{"s", "/;", 
    RowBox[{
     RowBox[{"Length", "[", "s", "]"}], "<", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.846331098507648*^9, 3.8463311412069798`*^9}, {
   3.8463313097288356`*^9, 3.8463313440080214`*^9}, 3.846336737969517*^9, {
   3.855166708079237*^9, 3.8551667090315046`*^9}},
 CellLabel->
  "(Debug) In[128]:=",ExpressionUUID->"73b7cee7-14b6-4fa4-9147-83281e971cfb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Little functions", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}, {3.8466840957849693`*^9, 
   3.8466840985499296`*^9}},ExpressionUUID->"db47ccfd-4402-4ad1-b812-\
06acc10af17c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bigTest", "[", 
   RowBox[{
   "steps_", ",", "dis_", ",", "n_", ",", "u_", ",", "listv0_", ",", 
    "condition_", ",", "e_", ",", "minmaxList_", ",", "imslist_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ic", ",", "depth", ",", " ", "resTable", ",", "realPVTable", ",", 
      "okTable", ",", "realOkPVTable", ",", "pos", ",", "pv", ",", "g0", ",", 
      "nonresTable", ",", "nonrealPVTable"}], "}"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ic", "=", 
           RowBox[{"move", "[", 
            RowBox[{
             RowBox[{"im", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "dis"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"depth", "=", 
           RowBox[{"stereoDepth", "[", 
            RowBox[{"n", ",", "u", ",", "listv0", ",", "condition", ",", 
             RowBox[{"im", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "ic", ",", 
             RowBox[{"minmax", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "minmax", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{"1", "+", 
                RowBox[{"102", "*", "tim"}]}], ",", "steps"}], "]"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{"1", "+", 
                RowBox[{"44", "*", "tim"}]}]}], "]"}], ",", "e", ",", 
             "\"\<ConstrainedCorrelation\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "only", " ", "keep", " ", "converged", " ", 
            "solutions"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"resTable", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"depth", "[", 
                RowBox[{"[", "r", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                 "\"\<converged\>\""}], "&"}]}], "]"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"depth", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"1", "+", 
                RowBox[{"44", "*", "tim"}]}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "give", " ", "right", " ", "coordinates", " ", "to", 
            " ", "each", " ", "solution"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"realPVTable", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pos", "=", 
               RowBox[{
                RowBox[{"resTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "All", ",", "5"}], "]"}], "]"}], "-", 
                RowBox[{"resTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "All", ",", "3"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pv", "=", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"pos", ",", 
                  RowBox[{"resTable", "[", 
                   RowBox[{"[", 
                    RowBox[{"r", ",", "All", ",", "1"}], "]"}], "]"}]}], 
                 "}"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"1", "+", 
                RowBox[{"44", "*", "tim"}]}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "only", " ", "keep", " ", "ok", " ", "solutions"}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"okTable", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"depth", "[", 
                RowBox[{"[", "r", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<ok\>\""}], 
                "&"}]}], "]"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"depth", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"1", "+", 
                RowBox[{"44", "*", "tim"}]}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "give", " ", "right", " ", "coordinates", " ", "to", 
            " ", "each", " ", "solution"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"realOkPVTable", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pos", "=", 
               RowBox[{
                RowBox[{"okTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "All", ",", "5"}], "]"}], "]"}], "-", 
                RowBox[{"okTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "All", ",", "3"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pv", "=", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"pos", ",", 
                  RowBox[{"okTable", "[", 
                   RowBox[{"[", 
                    RowBox[{"r", ",", "All", ",", "1"}], "]"}], "]"}]}], 
                 "}"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"1", "+", 
                RowBox[{"44", "*", "tim"}]}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "only", " ", "keep", " ", "NON", " ", "converged", " ", 
            "solutions"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"nonresTable", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"depth", "[", 
                RowBox[{"[", "r", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "!=", 
                   "\"\<converged\>\""}], "&&", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "!=", "\"\<ok\>\""}]}], 
                 ")"}], "&"}]}], "]"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"depth", "[", 
               RowBox[{"[", "r", "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"1", "+", 
                RowBox[{"44", "*", "tim"}]}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "give", " ", "right", " ", "coordinates", " ", "to", 
            " ", "each", " ", "solution"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"nonrealPVTable", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pos", "=", 
               RowBox[{
                RowBox[{"nonresTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "All", ",", "5"}], "]"}], "]"}], "-", 
                RowBox[{"nonresTable", "[", 
                 RowBox[{"[", 
                  RowBox[{"r", ",", "All", ",", "3"}], "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"pv", "=", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"pos", ",", 
                  RowBox[{"nonresTable", "[", 
                   RowBox[{"[", 
                    RowBox[{"r", ",", "All", ",", "1"}], "]"}], "]"}]}], 
                 "}"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"1", "+", 
                RowBox[{"44", "*", "tim"}]}]}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"We", " ", "create", " ", "g0"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"g0", "=", 
           RowBox[{"Graphics", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.004", "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"affiche", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"1", "+", 
                    RowBox[{"44", "*", "tim"}], "-", "y"}]}], "]"}], "&"}], "/@", 
                 RowBox[{"realPVTable", "[", 
                  RowBox[{"[", "y", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "1", ",", 
                  RowBox[{"1", "+", 
                   RowBox[{"44", "*", "tim"}]}]}], "}"}]}], "]"}]}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"g0", "=", 
           RowBox[{"Rasterize", "[", 
            RowBox[{
             RowBox[{"Show", "[", 
              RowBox[{
               RowBox[{"im", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "g0"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", 
              RowBox[{
               RowBox[{"ImageDimensions", "[", 
                RowBox[{"im", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", "5"}]}], ",", 
             RowBox[{"ImageResolution", "\[Rule]", "200"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
           "realPVTable", ",", "realOkPVTable", ",", "nonrealPVTable", ",", 
            "g0"}], "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"minmax", ",", "minmaxList"}], "}"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"im", ",", " ", "imslist"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8463505718537335`*^9, 3.846350709459044*^9}, {
   3.846350767625598*^9, 3.846350847105503*^9}, {3.8463508832990737`*^9, 
   3.8463509118392563`*^9}, {3.8463517578953257`*^9, 
   3.8463517708456497`*^9}, {3.8466848201523123`*^9, 
   3.8466848206521935`*^9}, {3.8466902503507414`*^9, 3.846690339004897*^9}, {
   3.849037093708213*^9, 3.8490371014879*^9}, {3.8490955728672247`*^9, 
   3.849095574062036*^9}, {3.849095735324397*^9, 3.8490958019024506`*^9}, {
   3.8523837824001474`*^9, 3.8523838265237865`*^9}, {3.852740753888879*^9, 
   3.8527407614809637`*^9}, {3.8527507158242064`*^9, 
   3.8527508001172314`*^9}, {3.8529576332258005`*^9, 3.852957673455736*^9}, {
   3.8529788856951885`*^9, 3.852978889976944*^9}, {3.854030288349738*^9, 
   3.854030370817314*^9}, {3.8540304232404184`*^9, 3.8540304664643984`*^9}, {
   3.854030587706993*^9, 3.8540306366435685`*^9}, {3.855166735787202*^9, 
   3.85516677047495*^9}, {3.855167160287899*^9, 3.855167162040209*^9}, {
   3.855236890934003*^9, 3.8552368960295844`*^9}, {3.855236927312749*^9, 
   3.8552369399628*^9}, {3.855237044621395*^9, 3.8552370492408924`*^9}, {
   3.855237108360955*^9, 3.855237146855995*^9}, {3.855237189754012*^9, 
   3.855237190527521*^9}, {3.8557668854849477`*^9, 3.8557669495718656`*^9}, {
   3.8557695459887447`*^9, 3.8557695846378117`*^9}, {3.855770126667262*^9, 
   3.8557701445127935`*^9}, {3.8575726037371244`*^9, 3.857572615873109*^9}, {
   3.8600322194372025`*^9, 3.8600322613138113`*^9}, 3.860056586920814*^9, {
   3.8600624258139253`*^9, 3.8600624290126305`*^9}, 3.860067467839455*^9, 
   3.860174110815483*^9, {3.8601772966035953`*^9, 3.860177298865668*^9}, 
   3.8601901267447805`*^9, 3.860297898985178*^9},
 CellLabel->
  "(Debug) In[130]:=",ExpressionUUID->"c40275de-cc46-411c-9fb8-8c1237596da7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Big Tests", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8432444128743267`*^9, 
   3.8432444151784225`*^9}, {3.846350562854571*^9, 
   3.846350564972766*^9}},ExpressionUUID->"45210c91-87e6-4dc5-8edb-\
27cdeb1e98b8"],

Cell[CellGroupData[{

Cell["Test Run", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.849295748746804*^9, 3.849295749786442*^9}, {
   3.85523679614701*^9, 3.855236798631542*^9}, {3.8552466297912836`*^9, 
   3.8552466304664726`*^9}},ExpressionUUID->"f03ea74e-051a-44f5-8ad0-\
04c1d19f0f62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Test", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"testLevels", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"disList", "=", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "1", ",", "2"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"steps", "=", "1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.855237205180372*^9, 3.85523721455486*^9}, 
   3.85524885078458*^9, 3.8556070812642927`*^9, {3.8556076505615244`*^9, 
   3.855607692291338*^9}, {3.855608581347537*^9, 3.8556085981531677`*^9}, {
   3.855615810694193*^9, 3.855615820450346*^9}, {3.855621645771916*^9, 
   3.855621658459169*^9}, 3.855624312696003*^9, 3.855624596753606*^9, {
   3.85562489712731*^9, 3.8556249025331483`*^9}, {3.8556251451241035`*^9, 
   3.855625146030592*^9}, {3.855625447044038*^9, 3.855625449864665*^9}, {
   3.8556257456150684`*^9, 3.855625754847615*^9}, 3.8556604568156796`*^9, 
   3.8556607155922422`*^9, {3.855766977576979*^9, 3.8557669839381666`*^9}, {
   3.855769254959131*^9, 3.85576927108533*^9}, {3.855769346160968*^9, 
   3.855769346538406*^9}, 3.855831635489607*^9, 3.8558325244308405`*^9, {
   3.85593333273518*^9, 3.855933374413807*^9}, {3.8577356593235598`*^9, 
   3.8577356611010427`*^9}, {3.857737161583454*^9, 3.8577371654755583`*^9}, {
   3.8577429217478294`*^9, 3.857742924953367*^9}, 3.8600323333067036`*^9},
 CellLabel->
  "(Debug) In[131]:=",ExpressionUUID->"07e310d5-3234-45c1-943e-f2399b59ad7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Scaling", " ", "results"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"scale", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"affiche", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p_", ",", "v_"}], "}"}], ",", "y_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"RainbowColor", "[", 
        RowBox[{"Rescale", "[", 
         RowBox[{"v", ",", "scale", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "-", "0.5"}], ",", 
          RowBox[{"y", "+", "0.5"}]}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RainbowColor", "[", "z_", "]"}], ":=", 
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Purple", ",", "Blue", ",", "Cyan", ",", "Green", ",", "Yellow", ",", 
         "Orange", ",", "Red"}], "}"}], ",", "z"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8601857842773266`*^9, 3.860185791429697*^9}},
 CellLabel->
  "(Debug) In[137]:=",ExpressionUUID->"e9591681-ba73-4c87-a567-53290b927330"],

Cell[BoxData[
 RowBox[{
  RowBox[{"levelTable", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Creating", " ", "initial", " ", "values"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"range", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"dis", "+", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"Random", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"listv0", "=", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"range", ",", 
             RowBox[{"{", 
              RowBox[{"1000", ",", "2"}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
               "0"}], " ", "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[LessEqual]", 
               " ", 
               RowBox[{"Max", "[", 
                RowBox[{"Abs", "[", "range", "]"}], "]"}]}]}], ")"}], "&"}]}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"listv0", "=", 
         RowBox[{"Nest", "[", 
          RowBox[{"removeClosest", ",", "listv0", ",", 
           RowBox[{
            RowBox[{"Length", "[", "listv0", "]"}], "-", "50"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Creating", " ", "condition"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"topbot", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"dis", "+", "0.5"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", "condition", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"condition", "[", "x_", "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"topbot", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", 
           RowBox[{"Total", "[", 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "<", 
           RowBox[{"topbot", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bigTest", "[", 
         RowBox[{
         "steps", ",", "dis", ",", "n", ",", "u", ",", "listv0", ",", 
          "condition", ",", "e", ",", 
          RowBox[{"{", "levels", "}"}], ",", "ims"}], "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"levels", ",", "testLevels"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"dis", ",", "disList"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.849294739483862*^9, 3.8492948572713995`*^9}, {
   3.8492951276087875`*^9, 3.849295154437998*^9}, {3.8492952757988234`*^9, 
   3.849295296732972*^9}, {3.849295328792735*^9, 3.849295357369299*^9}, 
   3.849295391700656*^9, 3.8492957399460983`*^9, {3.8493008936874504`*^9, 
   3.8493010145025654`*^9}, {3.8523130491208267`*^9, 3.852313070547495*^9}, 
   3.852740794572048*^9, {3.852743022216428*^9, 3.8527430249513335`*^9}, {
   3.852973237439565*^9, 3.8529732417555485`*^9}, {3.852978981477807*^9, 
   3.8529789840005693`*^9}, {3.8529793678544674`*^9, 3.852979368875458*^9}, {
   3.8540307704179544`*^9, 3.8540308293201146`*^9}, {3.854037356610464*^9, 
   3.8540373582752447`*^9}, {3.854037535466186*^9, 3.8540375397851653`*^9}, 
   3.8540376312098827`*^9, {3.8542115756074944`*^9, 3.8542115778133173`*^9}, {
   3.855074246922333*^9, 3.8550742578138175`*^9}, {3.855076398624821*^9, 
   3.8550764048088427`*^9}, {3.8551671922693176`*^9, 
   3.8551672139984694`*^9}, {3.8551674090027127`*^9, 3.8551674106225166`*^9}, 
   3.85516768628983*^9, {3.8551680810523415`*^9, 3.8551681247373037`*^9}, {
   3.8551685159339314`*^9, 3.8551685174438434`*^9}, 3.855169062159395*^9, 
   3.8551697348820057`*^9, {3.8552361051006565`*^9, 3.855236130422654*^9}, 
   3.8552372021608686`*^9, {3.8552372715800295`*^9, 3.855237277869487*^9}, 
   3.855237455992549*^9, {3.8556076184552307`*^9, 3.855607647160266*^9}, 
   3.8556086505724697`*^9, 3.8556216639420843`*^9, {3.8557670021402607`*^9, 
   3.855767070979107*^9}, {3.855769219611035*^9, 3.855769276508988*^9}, 
   3.8557693949708076`*^9, {3.8557694349075108`*^9, 3.8557694544187326`*^9}, {
   3.8557703769547644`*^9, 3.8557704172447424`*^9}, {3.8557704654187*^9, 
   3.855770493324212*^9}, {3.8557705485994205`*^9, 3.855770574355769*^9}, 
   3.8557712616968164`*^9, {3.855921648098172*^9, 3.85592165517909*^9}, 
   3.855921805735511*^9, {3.8559218655215983`*^9, 3.8559218791548347`*^9}, 
   3.8559219351627865`*^9, 3.8559333843655376`*^9, {3.8559334359586663`*^9, 
   3.8559334489679995`*^9}, {3.860166695035869*^9, 3.8601667125391273`*^9}, 
   3.8601667469922085`*^9, {3.86017414649806*^9, 3.860174162291721*^9}, {
   3.8601801423162923`*^9, 3.8601801486632824`*^9}, {3.8601857798833113`*^9, 
   3.860185806058919*^9}},
 CellLabel->
  "(Debug) In[140]:=",ExpressionUUID->"c3d5ce46-71a6-4fc9-85fa-a6173fc0703e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"selectrion", " ", "criteria"}], ",", " ", "level", ",", " ", 
    "image", ",", " ", "extra", ",", " ", 
    RowBox[{"kind", " ", "of", " ", "result"}], ",", " ", "rows"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Dimensions", "[", "levelTable", "]"}]}]], "Input",
 CellChangeTimes->{{3.8540309367843914`*^9, 3.8540310070311*^9}, {
  3.8552383763298845`*^9, 3.855238409070213*^9}, {3.8557707750684204`*^9, 
  3.855770779037282*^9}},
 CellLabel->
  "(Debug) In[141]:=",ExpressionUUID->"bcfc76e8-3399-4489-ad16-049aaf163184"],

Cell[BoxData[
 RowBox[{"StandardDeviation", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{"levelTable", "[", 
    RowBox[{"[", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "All", ",", "All", ",",
       "2"}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.857734522918451*^9, 3.857734532172659*^9}, 
   3.8577345795953765`*^9, {3.857737578589814*^9, 3.857737639114807*^9}},
 CellLabel->
  "(Debug) In[142]:=",ExpressionUUID->"3c83b4ce-050e-46c0-b41b-e9c2584ee807"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Histogram Grid 1", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 
   3.8552385641354785`*^9}},ExpressionUUID->"0feb67ce-8c34-4410-aa67-\
8945f8ac42c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontsize", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagesize", "=", "500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxvalue", "=", 
   RowBox[{"{", 
    RowBox[{"topbot", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "10000"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bar", "=", 
   RowBox[{"{", 
    RowBox[{"5", ",", "20", ",", "30"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8540365462559085`*^9, {3.8542112559423923`*^9, 3.8542112601210203`*^9}, {
   3.8542114493532333`*^9, 3.8542114503106956`*^9}, {3.855074278413699*^9, 
   3.855074280554403*^9}, 3.855077928897172*^9, {3.8556083608028917`*^9, 
   3.8556083771384754`*^9}, 3.8556220031876326`*^9, {3.8556241008807507`*^9, 
   3.8556241427506866`*^9}, {3.8556248426367865`*^9, 
   3.8556248503589554`*^9}, {3.855626023231863*^9, 3.8556260362680445`*^9}, {
   3.855771793696522*^9, 3.8557718108116674`*^9}, {3.855832427606886*^9, 
   3.8558324374274015`*^9}, {3.8558535431815805`*^9, 3.855853546416357*^9}, {
   3.855854601244833*^9, 3.8558546525405374`*^9}, {3.8558546931765857`*^9, 
   3.8558547179679728`*^9}, {3.855922342965428*^9, 3.8559223493397336`*^9}, {
   3.8559313776732416`*^9, 3.855931487918017*^9}, {3.855931719439005*^9, 
   3.855931732677775*^9}, {3.8559317745304565`*^9, 3.8559318081845756`*^9}, {
   3.8559337798811417`*^9, 3.8559338019944873`*^9}, {3.8559464795407953`*^9, 
   3.855946481594907*^9}, {3.857736272586665*^9, 3.857736273060338*^9}, {
   3.8577366346957445`*^9, 3.857736635165991*^9}, {3.857736898932727*^9, 
   3.8577369056516*^9}, {3.8577371201168394`*^9, 3.8577371205084896`*^9}, 
   3.8577380802040925`*^9, {3.860067332611044*^9, 3.8600673334323483`*^9}, {
   3.8600673834876165`*^9, 3.8600673886622353`*^9}, {3.8601892314493427`*^9, 
   3.8601892549332724`*^9}, {3.8601892921646314`*^9, 
   3.8601893200272746`*^9}, {3.860197033745307*^9, 3.860197034172608*^9}, {
   3.8601971757988772`*^9, 3.860197180210701*^9}},
 CellLabel->
  "(Debug) In[143]:=",ExpressionUUID->"f7c296e6-9437-4628-a8cd-4a8c25bfe507"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"histogramGrid", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"convergedData", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"levelTable", "[", 
            RowBox[{"[", 
             RowBox[{
             "which", ",", "idxims", ",", "1", ",", "1", ",", "1", ",", "All",
               ",", "All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"okData", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"levelTable", "[", 
            RowBox[{"[", 
             RowBox[{
             "which", ",", "idxims", ",", "1", ",", "1", ",", "2", ",", "All",
               ",", "All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nonConvergedData", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"levelTable", "[", 
            RowBox[{"[", 
             RowBox[{
             "which", ",", "idxims", ",", "1", ",", "1", ",", "3", ",", "All",
               ",", "All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"std", "=", 
          RowBox[{"StandardDeviation", "[", "convergedData", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mu", "=", 
          RowBox[{"Mean", "[", "convergedData", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"density", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteDuplicates", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"Round", "[", 
                RowBox[{"levelTable", "[", 
                 RowBox[{"[", 
                  RowBox[{
                  "which", ",", "idxims", ",", "1", ",", "1", ",", "1", ",", 
                   "All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}]}], 
              "]"}], "]"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"102.", "*", "tim"}]}], ")"}], "*", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"44.", "*", "tim"}]}], ")"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Histogram", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"convergedData", ",", "nonConvergedData"}], "}"}], ",", 
           RowBox[{"bar", "[", 
            RowBox[{"[", "which", "]"}], "]"}], ",", "\"\<LogCount\>\"", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"Column", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Displacement= \>\"", ",", 
                    RowBox[{"disList", "[", 
                    RowBox[{"[", "which", "]"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                  "Italic"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Standard deviation= \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"std", ",", "3"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                  "Italic"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Mean= \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"mu", ",", "3"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", " ", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                  "Italic"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Density= \>\"", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{"density", ",", "3"}], "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", " ", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                  "Italic"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Spacings", "\[Rule]", "0.1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Alignment", "->", "Center"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "\[Rule]", "maxvalue"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "imagesize"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<v\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                "Italic"}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{"\"\<n\>\"", ",", 
                RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
                "Italic"}], "]"}]}], "}"}]}], ",", 
           RowBox[{"ChartStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"LightOrange", ",", "LightBlue", ",", "LightGreen"}], 
             "}"}]}], ",", 
           RowBox[{"TicksStyle", "\[Rule]", 
            RowBox[{"fontsize", "-", "6"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "convergedData", ",", " ", "nonConvergedData", ",", "okData"}], 
          "}"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"which", ",", 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4", ",", "5"}], "}"}], "*)"}], 
          RowBox[{"Length", "[", "disList", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"idxims", ",", 
        RowBox[{"Length", "[", "ims", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.8540365645599213`*^9, {3.8540369711459074`*^9, 3.8540369873364058`*^9}, {
   3.854037079181896*^9, 3.8540371390466995`*^9}, 3.854037172162952*^9, {
   3.854037307531682*^9, 3.8540373481551723`*^9}, {3.8540374889517345`*^9, 
   3.854037531966673*^9}, 3.8540379029800344`*^9, {3.854211165834694*^9, 
   3.8542112093189116`*^9}, 3.8542115039052043`*^9, {3.8550750605565577`*^9, 
   3.85507511105305*^9}, {3.8550762997892036`*^9, 3.8550763001221914`*^9}, {
   3.855077854617117*^9, 3.855077871132938*^9}, 3.8550779584824724`*^9, {
   3.855238453925217*^9, 3.855238476977581*^9}, {3.8556080684925456`*^9, 
   3.855608072736791*^9}, {3.855608191440531*^9, 3.855608195693818*^9}, {
   3.855608257638606*^9, 3.855608267816841*^9}, {3.8556083032203293`*^9, 
   3.8556083404076643`*^9}, {3.8556084601983643`*^9, 
   3.8556085397024727`*^9}, {3.8557710702157946`*^9, 3.855771096214668*^9}, {
   3.8557717876261735`*^9, 3.8557717889718485`*^9}, {3.855847682144772*^9, 
   3.855847714982031*^9}, {3.855847954871922*^9, 3.8558480015592995`*^9}, {
   3.855848091620501*^9, 3.8558481022109027`*^9}, {3.855848143711481*^9, 
   3.8558482828209553`*^9}, {3.855848365642722*^9, 3.8558483708317327`*^9}, {
   3.8558484022900743`*^9, 3.855848410083455*^9}, {3.855848446017821*^9, 
   3.855848448498246*^9}, {3.8558486419852805`*^9, 3.855848646518858*^9}, {
   3.855848688189353*^9, 3.855848702522748*^9}, 3.855854581830692*^9, {
   3.8558546611913524`*^9, 3.855854687680727*^9}, {3.8559223069757447`*^9, 
   3.8559223073725348`*^9}, {3.8559230663260593`*^9, 3.855923080528761*^9}, {
   3.8559255902199173`*^9, 3.855925590433588*^9}, 3.855931365461967*^9, {
   3.8559317432158155`*^9, 3.855931768810769*^9}, {3.8559334868706903`*^9, 
   3.8559335241823945`*^9}, {3.855933765867401*^9, 3.855933768967222*^9}, {
   3.857734678535143*^9, 3.8577346956378937`*^9}, {3.857734726934827*^9, 
   3.8577348051612616`*^9}, {3.8577357111934557`*^9, 3.857735719899577*^9}, 
   3.857736256123229*^9, {3.8577363207945004`*^9, 3.857736377745735*^9}, 
   3.8577364258456717`*^9, {3.8577364671696677`*^9, 3.857736467734494*^9}, {
   3.857736527831479*^9, 3.857736623387336*^9}, {3.8577368596917906`*^9, 
   3.8577368737263303`*^9}, {3.857736922652964*^9, 3.8577369328853836`*^9}, {
   3.8577370275106463`*^9, 3.8577370602388864`*^9}, {3.8577371007461343`*^9, 
   3.8577371071168327`*^9}, {3.8600323701302547`*^9, 3.860032397249503*^9}, {
   3.8600672983905487`*^9, 3.8600673000103135`*^9}, {3.8600674481937475`*^9, 
   3.8600674554452915`*^9}, {3.8601893041922703`*^9, 
   3.8601893061891613`*^9}, {3.860193537612355*^9, 3.8601935389114027`*^9}, {
   3.8601952327439566`*^9, 3.8601952592005486`*^9}},
 CellLabel->
  "(Debug) In[147]:=",ExpressionUUID->"763a1e21-3a82-4b5b-8d9e-c44d0ce56307"],

Cell[BoxData[
 RowBox[{"hFinal", "=", 
  RowBox[{"Legended", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Grid", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"histogramGrid", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "3"}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"SwatchLegend", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "LightOrange", ",", " ", "LightBlue", ",", " ", "LightGreen"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Converged\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", " ", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
            "Italic"}], "]"}], ",", " ", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Non Converged\>\"", ",", 
            RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", " ", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
            "Italic"}], "]"}]}], "}"}], ",", 
        RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}], ",", 
      "Below"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.854211510014496*^9, {3.854211562075644*^9, 3.8542115644092655`*^9}, {
   3.8542119508008466`*^9, 3.854211955209527*^9}, {3.8556083935993814`*^9, 
   3.855608394219409*^9}, 3.8556084343893614`*^9, {3.8556239700021243`*^9, 
   3.8556239752972345`*^9}, {3.8558480566376295`*^9, 3.855848064897581*^9}, {
   3.855934581075903*^9, 3.8559346040280266`*^9}, 3.855934898944816*^9, {
   3.8559464917517986`*^9, 3.8559465011357937`*^9}, {3.857734622280758*^9, 
   3.857734641186791*^9}, 3.85773477548184*^9, {3.857742942368704*^9, 
   3.857742950560364*^9}, {3.857743556353694*^9, 3.8577435568524666`*^9}, {
   3.8601971300210133`*^9, 3.860197165629222*^9}, 3.860304841742632*^9},
 CellLabel->
  "(Debug) In[148]:=",ExpressionUUID->"c0378261-5b03-4dd1-9813-8275cbda8182"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nbname", "=", 
   RowBox[{"StringDelete", "[", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"FileNameSplit", "@", 
       RowBox[{"NotebookFileName", "[", "]"}]}]}], ",", "\"\<.nb\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.855623624691597*^9, 3.855623636177866*^9}, {
   3.855623685736858*^9, 3.8556237039995837`*^9}, 3.855623749747179*^9, {
   3.855623796571074*^9, 3.8556238180804834`*^9}, 3.855623938159814*^9},
 CellLabel->
  "(Debug) In[149]:=",ExpressionUUID->"0e47eb49-f59f-4b4e-8e51-2b9190580512"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"figsDirectory", "=", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", "\"\<figs\>\""}],
       "}"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figsDirectory", ",", 
      RowBox[{"nbname", "<>", "\"\<-hist.pdf\>\""}]}], "}"}], "]"}], ",", 
   "hFinal", ",", " ", 
   RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.855623608000491*^9, {3.8556238295639253`*^9, 3.8556238480557857`*^9}, {
   3.8556239104920263`*^9, 3.8556239114454594`*^9}, {3.85562394472538*^9, 
   3.8556239572917037`*^9}, 3.8556240346316986`*^9, {3.8556242912893343`*^9, 
   3.8556242921521826`*^9}, {3.8600564730562153`*^9, 3.860056474191039*^9}, 
   3.860196649744268*^9, 3.860304861071602*^9},
 CellLabel->
  "(Debug) In[150]:=",ExpressionUUID->"712aacc8-ceb7-45c9-b23a-765602c72357"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Images", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}},ExpressionUUID->"6d7d47db-21a9-482f-8382-\
65cbb43cb211"],

Cell[BoxData[
 RowBox[{
  RowBox[{"legendBar", "=", 
   RowBox[{"BarLegend", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RainbowColor", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"Ticks", "\[Rule]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Rescale", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", "scale"}], "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "1", ",", "0.2"}], "]"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"LegendMarkerSize", "\[Rule]", "100"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8557716130647316`*^9, 3.8557716331027813`*^9}, {
   3.85577166395192*^9, 3.855771690735826*^9}, {3.8600672732098303`*^9, 
   3.8600672769450855`*^9}, 3.860183716793511*^9, 3.860297994022047*^9},
 CellLabel->
  "(Debug) In[152]:=",ExpressionUUID->"cfe9191f-897c-4384-9c70-f8a0d8ce4649"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imagesTable", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ConformImages", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"levelTable", "[", 
              RowBox[{"[", 
               RowBox[{"which", ",", "1", ",", "1", ",", "1", ",", "4"}], 
               "]"}], "]"}], "}"}], ",", 
            RowBox[{"{", "1000", "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<Displacement= \>\"", ",", 
                RowBox[{"disList", "[", 
                 RowBox[{"[", "which", "]"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"FontSize", "\[Rule]", 
              RowBox[{"fontsize", "-", "15"}]}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
             "Italic"}], "]"}], ",", 
           RowBox[{"FontSize", "\[Rule]", "fontsize"}], ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Times\>\""}], ",", 
           "Italic"}], "]"}], "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"which", ",", 
       RowBox[{"(*", 
        RowBox[{"{", 
         RowBox[{"1", ",", "4", ",", "5"}], "}"}], "*)"}], 
       RowBox[{"Length", "[", "disList", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.855238665484979*^9, 3.855238699125924*^9, {3.855238764008604*^9, 
   3.855238772412653*^9}, {3.85523881937521*^9, 3.85523882394518*^9}, {
   3.8552402026739516`*^9, 3.8552402722618933`*^9}, {3.8556208102470903`*^9, 
   3.855620818692878*^9}, {3.8556216048946066`*^9, 3.855621625490093*^9}, {
   3.8556231008943315`*^9, 3.8556231097430224`*^9}, {3.855623145830584*^9, 
   3.8556231654855375`*^9}, {3.8556231969038525`*^9, 
   3.8556232726547103`*^9}, {3.8556233981350546`*^9, 3.855623435416765*^9}, {
   3.85562346930649*^9, 3.8556234821675463`*^9}, {3.85562422627067*^9, 
   3.855624229058484*^9}, {3.855771181021402*^9, 3.855771187910612*^9}, {
   3.855771552256753*^9, 3.85577155328563*^9}, {3.855771697610645*^9, 
   3.8557717000873556`*^9}, {3.855771765483827*^9, 3.8557717783614388`*^9}, {
   3.8558492310872955`*^9, 3.8558492326241865`*^9}, {3.8558545322146378`*^9, 
   3.8558545461416397`*^9}, 3.8558547335287747`*^9, {3.855923113335516*^9, 
   3.8559231247832947`*^9}, {3.8559256052606316`*^9, 3.855925605750464*^9}, {
   3.855931304807302*^9, 3.8559313473697395`*^9}, 3.8559331908626175`*^9, {
   3.8559335350658107`*^9, 3.8559335507309847`*^9}, {3.8559338530272875`*^9, 
   3.85593385771852*^9}, {3.855934074956399*^9, 3.8559341794654226`*^9}, {
   3.8559347367798433`*^9, 3.8559348080493555`*^9}, {3.855946729812309*^9, 
   3.8559467330482626`*^9}, 3.8577428919952183`*^9, 3.857742935075039*^9, {
   3.8600565263361907`*^9, 3.86005657050336*^9}, {3.8600668819295835`*^9, 
   3.8600669144989777`*^9}, {3.860066954975154*^9, 3.860067011343774*^9}, {
   3.8600671442618437`*^9, 3.8600671749761534`*^9}, {3.8600672164356613`*^9, 
   3.8600672550260553`*^9}, {3.8601837137117357`*^9, 3.860183743088772*^9}, 
   3.860189343493368*^9, 3.8601901409379644`*^9, 3.8601962236420097`*^9, {
   3.8601962630062447`*^9, 3.860196270734285*^9}, {3.8602979749306545`*^9, 
   3.860297975389679*^9}, {3.8603044007432213`*^9, 3.860304408108698*^9}},
 CellLabel->
  "(Debug) In[153]:=",ExpressionUUID->"8e31a954-52b6-42ec-8e1d-59bfa3350d2a"],

Cell[BoxData[
 RowBox[{"imFinal", "=", 
  RowBox[{"Legended", "[", 
   RowBox[{
    RowBox[{"Grid", "[", 
     RowBox[{"Partition", "[", 
      RowBox[{"imagesTable", ",", "3"}], "]"}], "]"}], ",", "legendBar"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8600670064959135`*^9, 3.8600670436291504`*^9}},
 CellLabel->
  "(Debug) In[154]:=",ExpressionUUID->"c54348d3-5e8c-433f-89d8-4fc65553e198"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"figsDirectory", ",", 
       RowBox[{"nbname", "<>", "\"\<-im.pdf\>\""}]}], "}"}], "]"}], ",", 
    RowBox[{"Rasterize", "[", 
     RowBox[{"imFinal", ",", 
      RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
      RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.855623608000491*^9, {3.8556238295639253`*^9, 3.8556238480557857`*^9}, {
   3.8556239104920263`*^9, 3.8556239114454594`*^9}, {3.85562394472538*^9, 
   3.8556239572917037`*^9}, 3.8556240346316986`*^9, {3.8556241964120054`*^9, 
   3.8556242344033756`*^9}, {3.855624281725917*^9, 3.8556242832410746`*^9}, {
   3.8601961403863688`*^9, 3.860196156325988*^9}, 3.860196673453549*^9, {
   3.8601967928358693`*^9, 3.860196862790954*^9}, 3.860304702349096*^9, 
   3.8603048676274824`*^9},
 CellLabel->
  "(Debug) In[155]:=",ExpressionUUID->"dfe7bf08-b5ca-4959-829f-f9d92797eb32"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Table", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.855848854220343*^9, 
   3.8558488558035684`*^9}},ExpressionUUID->"85c25628-9976-4bb9-8173-\
726141b97578"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tableValues", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"convergedData", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"levelTable", "[", 
           RowBox[{"[", 
            RowBox[{
            "which", ",", "idxims", ",", "1", ",", "1", ",", "1", ",", "All", 
             ",", "All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"std", "=", 
         RowBox[{"StandardDeviation", "[", "convergedData", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mu", "=", 
         RowBox[{"Mean", "[", "convergedData", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"density", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"Round", "[", 
               RowBox[{"levelTable", "[", 
                RowBox[{"[", 
                 RowBox[{
                 "which", ",", "idxims", ",", "1", ",", "1", ",", "1", ",", 
                  "All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}],
             "]"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"103.", "*", "45."}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"meanError", "=", 
         RowBox[{"Mean", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"0.1", "-", "convergedData"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"std", ",", "mu", ",", "density", ",", "meanError"}], 
         "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"idxims", ",", 
         RowBox[{"Length", "[", "ims", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"which", ",", 
       RowBox[{"Length", "[", "disList", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8558494789370227`*^9, 3.855849543984704*^9}, {
   3.8558509337210555`*^9, 3.8558509511510534`*^9}, {3.8558513232699337`*^9, 
   3.8558513539709377`*^9}, {3.855851425822917*^9, 3.8558514414017496`*^9}, {
   3.855933564534085*^9, 3.855933569196593*^9}, {3.8559471807362285`*^9, 
   3.85594725981028*^9}, 3.8559473348510485`*^9, 3.855947425852148*^9, 
   3.855948321304843*^9, 3.8559484218694572`*^9, {3.8559487212578144`*^9, 
   3.8559487264464645`*^9}},
 CellLabel->
  "(Debug) In[156]:=",ExpressionUUID->"9b399997-8988-448c-a132-99c3a6bb0d32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"makeTable", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"values", "=", 
        RowBox[{"tableValues", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "All", ",", "which"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"which", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"greenRedColor", "[", "z_", "]"}], ":=", 
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Red", ",", "Green"}], "}"}], ",", 
             RowBox[{"Rescale", "[", 
              RowBox[{"z", ",", 
               RowBox[{"MinMax", "[", "values", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"which", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"greenRedColor", "[", "z_", "]"}], ":=", 
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Green", ",", "Red"}], "}"}], ",", 
                RowBox[{"Rescale", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"MinMax", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", "disList", "]"}], "-", 
                    RowBox[{"Abs", "[", "values", "]"}]}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"greenRedColor", "[", "z_", "]"}], ":=", 
              RowBox[{"Blend", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Green", ",", "Red"}], "}"}], ",", 
                RowBox[{"Rescale", "[", 
                 RowBox[{"z", ",", 
                  RowBox[{"MinMax", "[", "values", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"TableForm", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Item", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"Background", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Opacity", "[", "0.7", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"greenRedColor", "[", "#", "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"which", "\[Equal]", "2"}], ",", 
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"Abs", "[", "disList", "]"}], "-", 
              RowBox[{"Abs", "[", "values", "]"}]}], "]"}], ",", "values"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"which", ",", " ", 
        RowBox[{
         RowBox[{"Dimensions", "[", "tableValues", "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"{", "makeTable", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<std\>\"", ",", "\"\<dis-mu\>\"", ",", "\"\<density\>\"", ",", 
       "\"\<muerror\>\""}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Prepend", ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Displacement\>\"", ",", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"disList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "disList", "]"}]}], "}"}]}], "]"}], "//",
           "TableForm"}]}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"tFinal", "=", 
  RowBox[{"Grid", "[", "t2", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8558509638262157`*^9, 3.8558510119960327`*^9}, {
   3.8558510474417863`*^9, 3.855851139707162*^9}, {3.8558512808558087`*^9, 
   3.8558513111362047`*^9}, {3.8558519791208005`*^9, 
   3.8558520539900117`*^9}, {3.855852119857705*^9, 3.8558521729016633`*^9}, {
   3.855852211196851*^9, 3.8558522673851786`*^9}, {3.8558523102769313`*^9, 
   3.855852311040229*^9}, {3.8558524183900223`*^9, 3.8558525186241736`*^9}, {
   3.8558525648785734`*^9, 3.8558525693006*^9}, {3.8558526005919094`*^9, 
   3.8558526803133974`*^9}, {3.85585271138311*^9, 3.8558529029842854`*^9}, {
   3.8558536063515263`*^9, 3.855853744431367*^9}, {3.8558542501484213`*^9, 
   3.855854295240569*^9}, {3.855854372130001*^9, 3.8558544426306424`*^9}, {
   3.8559280254711056`*^9, 3.8559280292817974`*^9}, {3.8559335932962155`*^9, 
   3.8559336036964097`*^9}, {3.855933941495096*^9, 3.855933944034442*^9}, {
   3.8559466065271673`*^9, 3.8559466076833277`*^9}, {3.855946721574442*^9, 
   3.8559467229341726`*^9}, {3.855946975815652*^9, 3.855946976181758*^9}, {
   3.855947046434514*^9, 3.8559470869699745`*^9}, {3.8559473102603874`*^9, 
   3.85594731760736*^9}, {3.855947391253197*^9, 3.855947450401788*^9}, {
   3.855947576576378*^9, 3.855947600124683*^9}, {3.85594772293443*^9, 
   3.855947723434447*^9}, 3.8559477865489745`*^9, {3.8559478895171556`*^9, 
   3.8559478976927876`*^9}, {3.8559479345309963`*^9, 
   3.8559479496983023`*^9}, {3.855948089775113*^9, 3.855948146454363*^9}, {
   3.8559481769581423`*^9, 3.8559482287068214`*^9}, {3.855948369820326*^9, 
   3.8559484055379086`*^9}, {3.8559484450613503`*^9, 3.855948473743925*^9}, {
   3.8559486372144356`*^9, 3.855948662534902*^9}, {3.85594876630391*^9, 
   3.855948788775112*^9}, {3.8559499616812325`*^9, 3.855950013157855*^9}, {
   3.8559510615767465`*^9, 3.855951138090096*^9}, {3.8559546394458055`*^9, 
   3.8559546482359424`*^9}, {3.855954711214017*^9, 3.855954870440009*^9}},
 CellLabel->
  "(Debug) In[157]:=",ExpressionUUID->"cc73628d-2728-45e0-972c-d3bb7a3f5adc"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"figsDirectory", ",", 
      RowBox[{"nbname", "<>", "\"\<-tbl.pdf\>\""}]}], "}"}], "]"}], ",", 
   "tFinal"}], "]"}]], "Input",
 CellChangeTimes->{
  3.855623608000491*^9, {3.8556238295639253`*^9, 3.8556238480557857`*^9}, {
   3.8556239104920263`*^9, 3.8556239114454594`*^9}, {3.85562394472538*^9, 
   3.8556239572917037`*^9}, 3.8556240346316986`*^9, {3.8556241964120054`*^9, 
   3.8556242344033756`*^9}, {3.855624281725917*^9, 3.8556242832410746`*^9}, {
   3.855854428502895*^9, 3.8558544380522842`*^9}},
 CellLabel->
  "(Debug) In[161]:=",ExpressionUUID->"60542b4b-45ae-4c28-81ae-c9c3325aafe6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["More in depth", "Subsection",
 CellChangeTimes->{{3.8490959675801435`*^9, 3.8490959795460434`*^9}, 
   3.8490968042006626`*^9, 3.849096860100802*^9, {3.8492947158892403`*^9, 
   3.849294719275936*^9}, {3.8552385636642456`*^9, 3.8552385641354785`*^9}, {
   3.855238687712123*^9, 3.855238690767354*^9}, {3.8552401562807765`*^9, 
   3.855240157696867*^9}, {3.8557745100849714`*^9, 
   3.8557745127875643`*^9}},ExpressionUUID->"5098f3b1-c023-4521-878c-\
01a66da918a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lvl", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.855774696105371*^9, 3.855774703303475*^9}, 
   3.855775581960099*^9, 3.855833015988676*^9},
 CellLabel->
  "(Debug) In[162]:=",ExpressionUUID->"b5dbe1ba-5b06-4183-a849-c9bbd879cd30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", "=", "45"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ka", ",", "kb"}], "}"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ImageData", "[", "#", "]"}], "[", 
      RowBox[{"[", "k", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"ia", ",", 
      RowBox[{"move", "[", 
       RowBox[{"ia", ",", "0.1"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyra", "=", 
   RowBox[{"pyrFuncGen", "[", 
    RowBox[{"ka", ",", "lvl"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyrb", "=", 
   RowBox[{"pyrFuncGen", "[", 
    RowBox[{"kb", ",", "lvl"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyrab", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pyra", ",", " ", "pyrb"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "2", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.855774603733914*^9, 3.855774635611974*^9}, 
   3.8557746680665054`*^9, 3.8557747102030983`*^9, {3.8557751658724923`*^9, 
   3.855775166668244*^9}, 3.8557754300431175`*^9, {3.8557755180522213`*^9, 
   3.8557755186299353`*^9}, {3.8557757963041315`*^9, 
   3.8557757973160915`*^9}, {3.8557759267240343`*^9, 
   3.8557759277715287`*^9}, {3.8557760160576525`*^9, 
   3.8557760200064507`*^9}, {3.855776189445436*^9, 3.8557761899171376`*^9}, {
   3.8557762471199436`*^9, 3.855776265737028*^9}, {3.855776450778363*^9, 
   3.8557764512468667`*^9}, {3.8558437818704987`*^9, 3.8558437821235604`*^9}, 
   3.855844089984662*^9, 3.855928123063644*^9, {3.855946627382473*^9, 
   3.855946628358801*^9}},
 CellLabel->
  "(Debug) In[163]:=",ExpressionUUID->"852989b3-1208-48de-86a8-c0d75f93a8e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "condition", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"condition", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "*", 
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], " ", "&&", " ", 
    RowBox[{
     RowBox[{"-", "2"}], "<", 
     RowBox[{"Total", "[", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "<", "2"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8557750259812613`*^9, 3.855775048387169*^9}, {
   3.8557760706630287`*^9, 3.855776071819317*^9}, {3.855776109453453*^9, 
   3.855776115787431*^9}, 3.8558330711156282`*^9, {3.85583311519168*^9, 
   3.8558331218576107`*^9}, {3.855833228423726*^9, 3.855833231350524*^9}, 
   3.85583334299763*^9, {3.8558437876135406`*^9, 3.8558437942753706`*^9}, 
   3.855844079332597*^9, {3.855928058434486*^9, 3.855928058914999*^9}},
 CellLabel->
  "(Debug) In[168]:=",ExpressionUUID->"b83a6d4a-0370-4c5f-9ae5-24455ed98461"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"range", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"Random", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listv0", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"range", ",", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "2"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", "0"}],
         " ", "&&", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[LessEqual]", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", "range", "]"}], "]"}]}]}], ")"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listv0", "=", 
   RowBox[{"Nest", "[", 
    RowBox[{"removeClosest", ",", "listv0", ",", 
     RowBox[{
      RowBox[{"Length", "[", "listv0", "]"}], "-", "50"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.855928080949515*^9, 3.855928092925762*^9}},
 CellLabel->
  "(Debug) In[170]:=",ExpressionUUID->"0fbed4e2-5061-4309-a7ab-01b575ae8514"],

Cell[BoxData[
 RowBox[{"lineTest", "[", 
  RowBox[{"n", ",", "u", ",", "listv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"ImageDimensions", "[", "ia", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"pyrab", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "e", ",", 
   "\"\<ConstrainedNewMethod\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.855775567623247*^9, 3.855775590996392*^9}, 
   3.8557765102687263`*^9, 3.8558316018106794`*^9, {3.8558328291018753`*^9, 
   3.855832830873332*^9}, {3.855833042633805*^9, 3.855833046509434*^9}, {
   3.8558439406484065`*^9, 3.855843942143319*^9}},
 CellLabel->
  "(Debug) In[174]:=",ExpressionUUID->"3fa166c9-c6f7-408f-82f5-e9e4490428b3"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{"n", ",", "u", ",", "listv0", ",", "condition", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "103"}], "]"}], ",", 
   RowBox[{"pyrab", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "1"}], "]"}], "]"}], ",", "e", ",", 
   "\"\<ConstrainedNewMethod\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8557747589476194`*^9, 3.8557748305809383`*^9}, {
   3.855774865413357*^9, 3.855774956621029*^9}, 3.8557755490233335`*^9, {
   3.8557765162055545`*^9, 3.8557765539454603`*^9}, {3.8557766055145493`*^9, 
   3.855776619960021*^9}, {3.855831438581865*^9, 3.8558314977500224`*^9}, {
   3.8558315892268405`*^9, 3.855831590350517*^9}, {3.8558328792267036`*^9, 
   3.8558328841980753`*^9}, {3.8558329255539064`*^9, 
   3.8558329282523375`*^9}, {3.8558329817577114`*^9, 
   3.8558330308118577`*^9}, {3.855833086810701*^9, 3.8558330898968005`*^9}, {
   3.855833134266712*^9, 3.8558332113276477`*^9}, {3.8558332712794485`*^9, 
   3.8558332761368637`*^9}, {3.855843829783242*^9, 3.855843861966798*^9}, {
   3.855843898734892*^9, 3.855843899066742*^9}, {3.8558439306587644`*^9, 
   3.8558439358558893`*^9}, {3.855844015078504*^9, 3.855844022029312*^9}, {
   3.8558441411113076`*^9, 3.8558441717821693`*^9}, {3.8558442258229904`*^9, 
   3.8558442441623187`*^9}},
 CellLabel->
  "(Debug) In[175]:=",ExpressionUUID->"9942b60e-65d9-48cc-89d6-989b6d44a48b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152., 592.8},
WindowMargins->{{-1157.4, Automatic}, {-132.89999999999998`, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CellContext->Notebook,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c289611d-d4c5-49f8-828e-97670f2d0977"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 505, 7, 97, "Title",ExpressionUUID->"db62e516-81ba-4d70-b1b1-9cd33c91d768"],
Cell[CellGroupData[{
Cell[1110, 33, 207, 4, 66, "Section",ExpressionUUID->"78b447b1-9527-4a44-8f25-13c25c5e9101"],
Cell[1320, 39, 1062, 27, 68, "Input",ExpressionUUID->"73bb8eb7-fd63-4382-a987-e4763fd2c07f"],
Cell[2385, 68, 2538, 44, 166, "Input",ExpressionUUID->"8e037178-fa87-40a0-a24d-b460c488efbd"],
Cell[4926, 114, 873, 20, 127, "Input",ExpressionUUID->"17e8648f-4974-4529-81b4-a9cf0e6c6f42"]
}, Closed]],
Cell[CellGroupData[{
Cell[5836, 139, 330, 5, 52, "Section",ExpressionUUID->"6c77556b-bbc0-4ce0-b1d6-2dd77c2c36be"],
Cell[6169, 146, 4926, 108, 361, "Input",ExpressionUUID->"12c4baae-e516-4624-b168-298a872bf7c4"]
}, Closed]],
Cell[CellGroupData[{
Cell[11132, 259, 500, 8, 52, "Section",ExpressionUUID->"13c240f6-3055-4982-95f2-d32f55b04187"],
Cell[11635, 269, 2853, 66, 275, "Input",ExpressionUUID->"a454c9e1-f6e4-4a91-b02d-dd2cfa30fe82"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14525, 340, 495, 8, 66, "Section",ExpressionUUID->"5a8fbb8b-2497-4931-865a-b3148d964fa0"],
Cell[15023, 350, 1966, 52, 85, "Input",ExpressionUUID->"73b7cee7-14b6-4fa4-9147-83281e971cfb"]
}, Closed]],
Cell[CellGroupData[{
Cell[17026, 407, 396, 6, 52, "Section",ExpressionUUID->"db47ccfd-4402-4ad1-b812-06acc10af17c"],
Cell[17425, 415, 13022, 289, 966, "Input",ExpressionUUID->"c40275de-cc46-411c-9fb8-8c1237596da7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30484, 709, 385, 6, 66, "Section",ExpressionUUID->"45210c91-87e6-4dc5-8edb-27cdeb1e98b8"],
Cell[CellGroupData[{
Cell[30894, 719, 408, 6, 55, "Subsection",ExpressionUUID->"f03ea74e-051a-44f5-8ad0-04c1d19f0f62"],
Cell[31305, 727, 1847, 38, 141, "Input",ExpressionUUID->"07e310d5-3234-45c1-943e-f2399b59ad7f"],
Cell[33155, 767, 1354, 40, 85, "Input",ExpressionUUID->"e9591681-ba73-4c87-a567-53290b927330"],
Cell[34512, 809, 5903, 121, 334, "Input",ExpressionUUID->"c3d5ce46-71a6-4fc9-85fa-a6173fc0703e"],
Cell[40418, 932, 600, 13, 61, "Input",ExpressionUUID->"bcfc76e8-3399-4489-ad16-049aaf163184"],
Cell[41021, 947, 501, 11, 40, "Input",ExpressionUUID->"3c83b4ce-050e-46c0-b41b-e9c2584ee807"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41559, 963, 321, 5, 55, "Subsection",ExpressionUUID->"0feb67ce-8c34-4410-aa67-8945f8ac42c8"],
Cell[41883, 970, 2119, 39, 88, "Input",ExpressionUUID->"f7c296e6-9437-4628-a8cd-4a8c25bfe507"],
Cell[44005, 1011, 9885, 196, 575, "Input",ExpressionUUID->"763a1e21-3a82-4b5b-8d9e-c44d0ce56307"],
Cell[53893, 1209, 2013, 43, 119, "Input",ExpressionUUID->"c0378261-5b03-4dd1-9813-8275cbda8182"],
Cell[55909, 1254, 568, 13, 40, "Input",ExpressionUUID->"0e47eb49-f59f-4b4e-8e51-2b9190580512"],
Cell[56480, 1269, 1092, 25, 80, "Input",ExpressionUUID->"712aacc8-ceb7-45c9-b23a-765602c72357"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57609, 1299, 409, 6, 54, "Subsection",ExpressionUUID->"6d7d47db-21a9-482f-8382-65cbb43cb211"],
Cell[58021, 1307, 1100, 30, 40, "Input",ExpressionUUID->"cfe9191f-897c-4384-9c70-f8a0d8ce4649"],
Cell[59124, 1339, 3732, 72, 158, "Input",ExpressionUUID->"8e31a954-52b6-42ec-8e1d-59bfa3350d2a"],
Cell[62859, 1413, 396, 10, 40, "Input",ExpressionUUID->"c54348d3-5e8c-433f-89d8-4fc65553e198"],
Cell[63258, 1425, 1042, 22, 61, "Input",ExpressionUUID->"dfe7bf08-b5ca-4959-829f-f9d92797eb32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64337, 1452, 460, 7, 54, "Subsection",ExpressionUUID->"85c25628-9976-4bb9-8173-726141b97578"],
Cell[64800, 1461, 2754, 63, 275, "Input",ExpressionUUID->"9b399997-8988-448c-a132-99c3a6bb0d32"],
Cell[67557, 1526, 6856, 150, 509, "Input",ExpressionUUID->"cc73628d-2728-45e0-972c-d3bb7a3f5adc"],
Cell[74416, 1678, 711, 15, 40, "Input",ExpressionUUID->"60542b4b-45ae-4c28-81ae-c9c3325aafe6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75164, 1698, 470, 7, 54, "Subsection",ExpressionUUID->"5098f3b1-c023-4521-878c-01a66da918a2"],
Cell[75637, 1707, 274, 6, 40, "Input",ExpressionUUID->"b5dbe1ba-5b06-4183-a849-c9bbd879cd30"],
Cell[75914, 1715, 1871, 48, 119, "Input",ExpressionUUID->"852989b3-1208-48de-86a8-c0d75f93a8e2"],
Cell[77788, 1765, 1112, 27, 61, "Input",ExpressionUUID->"b83a6d4a-0370-4c5f-9ae5-24455ed98461"],
Cell[78903, 1794, 1569, 47, 100, "Input",ExpressionUUID->"0fbed4e2-5061-4309-a7ab-01b575ae8514"],
Cell[80475, 1843, 795, 17, 40, "Input",ExpressionUUID->"3fa166c9-c6f7-408f-82f5-e9e4490428b3"],
Cell[81273, 1862, 1396, 24, 40, "Input",ExpressionUUID->"9942b60e-65d9-48cc-89d6-989b6d44a48b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

