(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27894,        663]
NotebookOptionsPosition[     25074,        611]
NotebookOutlinePosition[     25636,        631]
CellTagsIndexPosition[     25593,        628]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Little Tests", "Title",
 CellChangeTimes->{{3.836408933336395*^9, 3.836408939343516*^9}, 
   3.8364092608930736`*^9, {3.839597016893468*^9, 3.839597019185139*^9}, 
   3.8396001415844855`*^9, {3.840547036727909*^9, 3.8405470374003563`*^9}, {
   3.8431583610963435`*^9, 3.8431583669555917`*^9}, {3.8435589181641517`*^9, 
   3.8435589198932934`*^9}, 
   3.843744422167187*^9},ExpressionUUID->"db62e516-81ba-4d70-b1b1-\
9cd33c91d768"],

Cell[CellGroupData[{

Cell["Start", "Section",
 CellChangeTimes->{{3.8400383593859367`*^9, 3.8400383615886106`*^9}, {
  3.8433207191908846`*^9, 
  3.8433207198782096`*^9}},ExpressionUUID->"78b447b1-9527-4a44-8f25-\
13c25c5e9101"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", "to", " ", "path", " ", "packages"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"packageDirectory", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<1DPackage\>\"", 
        ",", "\"\<*\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Path", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"$Path", ",", 
       RowBox[{"FileNames", "[", "packageDirectory", "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.8437444304820337`*^9, {3.843744475443145*^9, 3.843744489249152*^9}, {
   3.84374460430722*^9, 3.843744614114832*^9}, {3.8437451879521313`*^9, 
   3.8437451890826197`*^9}, {3.8437453266046667`*^9, 3.8437453290342407`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"73bb8eb7-fd63-4382-a987-e4763fd2c07f"],

Cell[BoxData[{
 RowBox[{"<<", "\"\<ReadSintel`\>\""}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<pyramid1d`\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "\"\<pyramidalStereoAll`\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"methods", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<\>\"", ",", "\"\<OverConstrained\>\"", ",", 
     "\"\<SemiConstrained\>\"", ",", "\"\<Constrained\>\"", ",", 
     "\"\<ConstrainedInitialSign\>\"", ",", "\"\<ConstrainedNewMethod\>\"", 
     ",", "\"\<ConstrainedPickierFunction\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"\"\<pyramidalCyclope1D\>\"", "<>", "met", "<>", "\"\<`\>\""}], 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"met", ",", "methods"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8405470666010065`*^9, 3.8405470721952195`*^9}, {
   3.840550195734952*^9, 3.840550216899179*^9}, {3.8417693956828256`*^9, 
   3.8417694295737267`*^9}, 3.8417694792252483`*^9, {3.8423558358531294`*^9, 
   3.842355838266631*^9}, {3.843139686906508*^9, 3.8431397006034536`*^9}, 
   3.8431400354897623`*^9, {3.8431583092259803`*^9, 3.843158312433055*^9}, {
   3.8431587050542717`*^9, 3.8431587088646235`*^9}, {3.8432405156973643`*^9, 
   3.8432405180756235`*^9}, {3.8432434086403227`*^9, 3.8432434521650333`*^9}, 
   3.8435781970825057`*^9, 3.8435786572990074`*^9, {3.843745725318043*^9, 
   3.843745730794486*^9}, {3.8437501550408554`*^9, 3.843750161634801*^9}, {
   3.843750230642497*^9, 3.8437503524543705`*^9}, {3.8437504375112853`*^9, 
   3.8437504386938276`*^9}, {3.843755017106989*^9, 3.84375503403273*^9}, {
   3.843755426452015*^9, 3.843755445994274*^9}, {3.8438346833502474`*^9, 
   3.84383468782578*^9}, 3.843835196563305*^9, {3.8438498338643837`*^9, 
   3.843849837390987*^9}, {3.8438505820282726`*^9, 3.843850585529437*^9}, {
   3.843851080665611*^9, 3.8438510924880347`*^9}, {3.843917874644593*^9, 
   3.84391788967353*^9}, {3.843919464270398*^9, 3.8439194690819983`*^9}, {
   3.844258411683423*^9, 3.8442584146673145`*^9}, 3.844258734579767*^9, 
   3.84426385350611*^9, 3.8442668082773514`*^9, {3.844780498357904*^9, 
   3.8447805041423593`*^9}, {3.8449446421268377`*^9, 3.844944649113989*^9}, {
   3.844944993663724*^9, 3.844945009436464*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"8e037178-fa87-40a0-a24d-b460c488efbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Declare", " ", "path", " ", "for", " ", "SINTEL", " ", "Data", " ", 
    "depending", " ", "on", " ", "user"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"baseSINTEL", "=", 
    RowBox[{"Switch", "[", 
     RowBox[{
     "$UserName", ",", "\[IndentingNewLine]", "\"\<fieri\>\"", ",", 
      "\"\<D:\\\\MastersMathematica\\\\Data\\\\Sintel\>\"", ",", 
      "\[IndentingNewLine]", "\"\<roys\>\"", ",", 
      "\"\</home/roys/datasets/SINTEL-stereo\>\""}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8437446388681035`*^9, 3.8437446932344007`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"17e8648f-4974-4529-81b4-a9cf0e6c6f42"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8437453621624937`*^9, 
   3.8437453624275274`*^9}},ExpressionUUID->"1bff5a9f-0ef9-4eb9-a97f-\
cc3b0be84b3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "downscaling", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "=", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
     RowBox[{"read", "[", 
      RowBox[{
      "baseSINTEL", ",", "\"\<bamboo_1\>\"", ",", "\"\<0001\>\"", ",", "r", 
       ",", "\"\<clean\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "44"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "102"}], "}"}], " ", "arbitrary", " ", "size", " ", 
      "to", " ", "make", " ", "the", " ", "method", " ", "faster"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nx", "=", 
     RowBox[{"170", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ny", "=", 
     RowBox[{"300", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ImageTake", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", 
         RowBox[{"ny", ",", 
          RowBox[{"ny", "+", "44"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nx", ",", 
          RowBox[{"nx", "+", "102"}]}], "}"}]}], "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageDimensions", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"ia", ",", "ib", ",", "id", ",", "io"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"max", "=", 
     RowBox[{
      RowBox[{"MinMax", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"ImageData", "[", "id", "]"}], "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<max dv=\>\"", ",", " ", "max"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.843745436013342*^9, 3.843745445266261*^9}, {
   3.8437454795752115`*^9, 3.843745636648714*^9}, 3.8442584513876195`*^9, {
   3.8442678037667413`*^9, 3.844267808172227*^9}, {3.8442680916621*^9, 
   3.8442680954422073`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"1f69a44f-8be3-4b10-b578-417791e2468b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Little Tests", "Section",
 CellChangeTimes->{{3.8396005056192665`*^9, 3.839600506650977*^9}, {
   3.8396006430435266`*^9, 3.8396006454493484`*^9}, 3.8396009902260947`*^9, {
   3.839601775074339*^9, 3.839601775891445*^9}, {3.8432444128743267`*^9, 
   3.8432444151784225`*^9}},ExpressionUUID->"d27acb04-c6fd-4944-8227-\
118c1ff153a7"],

Cell[CellGroupData[{

Cell["Little Functions", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.843308066803094*^9, 
   3.8433080681141663`*^9}},ExpressionUUID->"b38d52a6-6120-4727-a325-\
de50a59d758d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pyrfi", "[", 
   RowBox[{"ia_", ",", "ib_", ",", "row_", ",", "lvlmax_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pyrfia", ",", "pyrfib"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pyrfia", "=", 
      RowBox[{"pyrFuncGen", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ImageData", "[", "ia", "]"}], "[", 
         RowBox[{"[", "row", "]"}], "]"}], ",", " ", "lvlmax"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"pyrfib", "=", 
      RowBox[{"pyrFuncGen", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ImageData", "[", "ib", "]"}], "[", 
         RowBox[{"[", "row", "]"}], "]"}], ",", "lvlmax"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pyrfia", ",", "pyrfib"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.84313892088904*^9, 3.8431390761722784`*^9}, {
   3.8431392570148835`*^9, 3.843139273697956*^9}, {3.8431590848455114`*^9, 
   3.84315912015506*^9}, {3.843159154421751*^9, 3.843159154684618*^9}, 
   3.843159972594839*^9, {3.843224134943307*^9, 3.8432241373889875`*^9}, {
   3.843238887570883*^9, 3.8432388887128267`*^9}, {3.843244470687603*^9, 
   3.843244471083666*^9}, {3.843245943522396*^9, 3.843245953156348*^9}, 
   3.8432471526931915`*^9, 3.8432472029964914`*^9, 3.843247273562867*^9, {
   3.8432484084228573`*^9, 3.8432484087823677`*^9}, {3.8433081379635553`*^9, 
   3.843308241907001*^9}, {3.8433083959863462`*^9, 3.843308396126707*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"cb786676-2541-46c2-a080-ee0f48f60b08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"row", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lvlmin", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lvlmax", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pyrfiab", "=", 
   RowBox[{"pyrfi", "[", 
    RowBox[{"ia", ",", "ib", ",", "row", ",", "lvlmax"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.843746040554737*^9, 3.8437461051324205`*^9}, {
   3.8437555812868156`*^9, 3.843755582637147*^9}, 3.8437556660876565`*^9, {
   3.843756798752108*^9, 3.8437568007775183`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"6ea70fb8-085a-46ce-a6db-87a5d0ee1215"]
}, Closed]],

Cell[CellGroupData[{

Cell["Little Test: All packages", "Subsubsection",
 CellChangeTimes->{{3.8431596629374905`*^9, 3.8431596639009457`*^9}, {
   3.8432359066785154`*^9, 3.843235907632372*^9}, {3.8432457639823*^9, 
   3.8432457641541243`*^9}, 3.8432458031263204`*^9, 3.843247119206956*^9, 
   3.843248877604788*^9, {3.8433068733887095`*^9, 3.843306909103902*^9}, {
   3.8437461360756645`*^9, 3.843746148055343*^9}, {3.8438353050079746`*^9, 
   3.843835305455991*^9}},ExpressionUUID->"9c505c31-94a6-4052-b7df-\
b3725127238a"],

Cell[BoxData[
 RowBox[{"ic", "=", 
  RowBox[{"(*", 
   RowBox[{"move", "[", 
    RowBox[{"ia", ",", 
     RowBox[{"-", "5"}]}], "]"}], "*)"}], "ib"}]], "Input",
 CellChangeTimes->{{3.8449449787025995`*^9, 3.844944982914404*^9}, {
   3.844945015514289*^9, 3.8449450839081793`*^9}, {3.844945237326069*^9, 
   3.8449452557996674`*^9}, 3.8449453671035566`*^9, {3.844957342263509*^9, 
   3.844957354485817*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"603d3791-d8d0-4854-9579-5b4354231ed6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"row", "=", "29"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lvlmin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lvlmax", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "=", "0.05"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.843835334624956*^9, 3.843835368578481*^9}, 
   3.8438450809974666`*^9, {3.843845211153522*^9, 3.843845212205433*^9}, 
   3.843849999355584*^9, 3.8439133712817597`*^9, 3.8439150398074837`*^9, 
   3.843920580641367*^9, {3.84417755355663*^9, 3.844177556440915*^9}, 
   3.8441775980956836`*^9, 3.844185689541815*^9, 3.8442590654010983`*^9, {
   3.844264282770895*^9, 3.8442642829936075`*^9}, 3.844264689727025*^9, 
   3.844264759196179*^9, 3.8442648198219194`*^9, {3.8442653211294727`*^9, 
   3.844265323598428*^9}, 3.84426549222948*^9, 3.8442661429774175`*^9, 
   3.8442662959391413`*^9, 3.8442663743948307`*^9, {3.844266420007477*^9, 
   3.8442664202792425`*^9}, 3.844266941374533*^9, 3.844267844960446*^9, 
   3.84426788446496*^9, 3.8442681175776176`*^9, {3.844368944036168*^9, 
   3.8443690311697803`*^9}, {3.8443834765707*^9, 3.8443834927578487`*^9}, 
   3.844383708867654*^9, {3.8443838609163*^9, 3.844383890175245*^9}, 
   3.844384066585294*^9, 3.8443846075492935`*^9, {3.844386019469968*^9, 
   3.844386020533064*^9}, 3.844386065403781*^9, {3.844386164351085*^9, 
   3.8443861669567623`*^9}, 3.8443862732643504`*^9, {3.8443867111875257`*^9, 
   3.8443867347645273`*^9}, 3.844420540102929*^9, 3.844420621313531*^9, 
   3.8444209632245502`*^9, {3.844421164855092*^9, 3.8444211725503883`*^9}, 
   3.844427010165151*^9, 3.844434237766187*^9, {3.844434404740629*^9, 
   3.84443445745266*^9}, {3.8444344888363104`*^9, 3.844434503908309*^9}, 
   3.844435008094733*^9, {3.8444351348099775`*^9, 3.8444351381313066`*^9}, {
   3.844435816423999*^9, 3.844435817902401*^9}, {3.844445010509431*^9, 
   3.8444450570148573`*^9}, 3.844448122790785*^9, 3.8447804324213314`*^9, {
   3.8447805823751144`*^9, 3.844780635418126*^9}, {3.8447807179314127`*^9, 
   3.8447807249948177`*^9}, {3.8447808219580584`*^9, 3.8447808251560745`*^9}, 
   3.844874740281625*^9, 3.8449450409249034`*^9, 3.8449573103636007`*^9, {
   3.844957427716659*^9, 3.8449574284526105`*^9}, {3.844958347970345*^9, 
   3.844958348249477*^9}, 
   3.8449614930870266`*^9},ExpressionUUID->"4f0ef374-c6e6-429c-a633-\
c384f90ef0ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0", "=", "46"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"pyrfiab", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", "1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"pyrfiab", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", "2", ",", "1"}], "]"}], "]"}], "[", "x", "]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", "103"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.844780823398777*^9, 3.844780864481429*^9}, {
   3.844780895497785*^9, 3.8447808958901777`*^9}, {3.844781070911272*^9, 
   3.844781097411128*^9}, {3.844874746344429*^9, 3.844874754500001*^9}, 
   3.844957318448719*^9, 3.8449574385190783`*^9, 3.8449576506006556`*^9, {
   3.8449654904980683`*^9, 3.844965490608654*^9}, {3.8449694626846924`*^9, 
   3.8449694627705927`*^9}, {3.844969525441289*^9, 3.844969535419387*^9}, {
   3.8449695834994297`*^9, 3.8449695838443813`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"30c2ea5f-22d5-4aff-a097-455dc2e47006"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{"0.01", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "103"}], "]"}], ",", 
   RowBox[{"pyrfiab", "[", 
    RowBox[{"[", 
     RowBox[{"n", ";;", "n"}], "]"}], "]"}], ",", "0.001", ",", 
   "\"\<ConstrainedNewMethod\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.844957212272694*^9, {3.844957409609321*^9, 3.844957414522792*^9}, 
   3.844957511013838*^9, {3.8449612512934155`*^9, 3.844961278106824*^9}, {
   3.844961495858921*^9, 3.8449615461329374`*^9}, {3.844969606581788*^9, 
   3.8449696069317403`*^9}, {3.84496964428543*^9, 3.8449696451983967`*^9}, {
   3.844969683936313*^9, 3.844969684107342*^9}, {3.844969739528669*^9, 
   3.8449697398443003`*^9}, {3.84496982192001*^9, 3.8449698224589205`*^9}, {
   3.8449701241663513`*^9, 3.8449701243237915`*^9}, {3.8449702286604834`*^9, 
   3.8449702289435406`*^9}, {3.8449702710186977`*^9, 3.84497027175492*^9}, {
   3.8449704087754555`*^9, 3.8449704090845623`*^9}, 3.844970501742416*^9, {
   3.8449710035210905`*^9, 3.844971003643005*^9}, {3.844971230747134*^9, 
   3.844971231789382*^9}, {3.844971406247786*^9, 3.8449714080839267`*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"903042a2-2846-48c5-864c-5008c1e798c3"],

Cell[BoxData[
 RowBox[{"res", "=", 
  RowBox[{"lineTest", "[", 
   RowBox[{"0.1", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "103"}], "]"}], ",", 
    RowBox[{"pyrfiab", "[", 
     RowBox[{"[", 
      RowBox[{"n", ";;", "n"}], "]"}], "]"}], ",", "0.001", ",", 
    "\"\<ConstrainedNewMethod\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8449624768098354`*^9, 3.8449624893307667`*^9}, {
   3.844969746746155*^9, 3.8449697470526047`*^9}, {3.844969828656689*^9, 
   3.8449698287981095`*^9}, 3.8449701307514524`*^9, {3.844970182081689*^9, 
   3.844970182352219*^9}, {3.844970275062023*^9, 3.844970276285968*^9}, {
   3.844970454706994*^9, 3.844970454986899*^9}, 3.844970515372762*^9, {
   3.8449710592359676`*^9, 3.844971059365196*^9}, {3.844971266082902*^9, 
   3.8449712667573757`*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"c97ccb08-5dc5-4382-929b-faaf650ecf78"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.84496396369814*^9, 3.8449640382040253`*^9}, {
  3.8449645617418475`*^9, 3.8449645988046894`*^9}, {3.8449651963472424`*^9, 
  3.8449652771615458`*^9}, {3.844965309539303*^9, 3.844965377404595*^9}, {
  3.844965423809651*^9, 3.8449654477235227`*^9}, {3.844970146524085*^9, 
  3.8449701524921684`*^9}},ExpressionUUID->"1f9110bc-7f00-4996-abe5-\
513766ab56b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inter", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "-", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ")"}], "&"}], "/@", 
    "res"}]}], ";", 
  RowBox[{"g", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"inter", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"inter", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", "103"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"1", ",", "103"}], "]"}], ",", 
      RowBox[{"inter", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"inter", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Epilog", "\[Rule]", "g"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s4", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "-", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ")"}], "&"}], "/@", 
    RowBox[{"Select", "[", 
     RowBox[{"res", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "\"\<converged\>\""}], 
        ")"}], "&"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s0", ",", "s4"}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.844964041836766*^9, 3.8449641411375537`*^9}, {
  3.844964215246665*^9, 3.844964380963436*^9}, {3.8449646086381755`*^9, 
  3.8449646299982924`*^9}, {3.844964680635297*^9, 3.84496470737249*^9}, {
  3.844965043444765*^9, 3.8449650455571737`*^9}, {3.8449650902377167`*^9, 
  3.8449651398434467`*^9}, {3.8449697056526947`*^9, 3.844969728711711*^9}, {
  3.844969761689625*^9, 3.8449697720071535`*^9}, {3.844969837092787*^9, 
  3.844969840784851*^9}, {3.844969971724262*^9, 3.844970010826253*^9}, {
  3.8449700526670732`*^9, 3.844970076610695*^9}, {3.844970141795718*^9, 
  3.8449701971331606`*^9}, {3.8449702965467205`*^9, 3.844970300092354*^9}, {
  3.8449704617787876`*^9, 3.844970465441676*^9}, {3.8449705245442715`*^9, 
  3.8449705307690096`*^9}, {3.844971089935012*^9, 3.844971090966874*^9}},
 CellLabel->
  "In[326]:=",ExpressionUUID->"d3c9590c-39f9-46f8-ba29-06f0944e0e4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "*", 
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "//", "Sign"}], "//", 
  "ListPlot"}]], "Input",
 CellChangeTimes->{{3.844962855124402*^9, 3.844962856087259*^9}, {
  3.844962984592926*^9, 3.8449630194281282`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"fc911b2f-8ebf-49c8-9b9b-b2789555e8fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"res", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}], "+", 
   RowBox[{"res", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "//", "ListPlot"}]], "Input",
 CellChangeTimes->{{3.8449626310795045`*^9, 3.8449626508224864`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"92abef72-383d-4b0c-a4ed-c3175900df4b"],

Cell[BoxData[
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"lineTest", "[", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "103"}], "]"}], ",", 
     RowBox[{"pyrfiab", "[", 
      RowBox[{"[", 
       RowBox[{"n", ";;", "n"}], "]"}], "]"}], ",", "0.001", ",", 
     "\"\<ConstrainedNewMethod\>\""}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.844961188840399*^9, 3.844961193771426*^9}, {
  3.844961294356182*^9, 3.844961308596422*^9}, {3.8449613592147818`*^9, 
  3.8449613638046036`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"febc6bb2-0dd3-4f1a-8c26-ecd8b367b1e3"],

Cell[BoxData[
 RowBox[{"seeAllLine", "[", 
  RowBox[{
   RowBox[{"-", "5"}], ",", 
   RowBox[{"Range", "[", 
    RowBox[{"50", ",", "103"}], "]"}], ",", 
   RowBox[{"pyrfiab", "[", 
    RowBox[{"[", 
     RowBox[{"n", ";;", "n"}], "]"}], "]"}], ",", "0.001", ",", 
   "\"\<ConstrainedNewMethod\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.844870152411439*^9, 3.844870190516676*^9}, {
   3.84487024333267*^9, 3.844870243907816*^9}, {3.8448747656210785`*^9, 
   3.844874766753108*^9}, {3.844944671077575*^9, 3.84494467431189*^9}, 
   3.8449450948060293`*^9, {3.844945214980646*^9, 3.844945228586442*^9}, {
   3.844945328671293*^9, 3.844945330283266*^9}, {3.8449459572202177`*^9, 
   3.844945966688608*^9}, 3.8449460140362673`*^9, {3.8449570740591598`*^9, 
   3.8449570762534227`*^9}, {3.844957202437479*^9, 3.844957204369463*^9}, {
   3.844957238543589*^9, 3.8449572388217363`*^9}, {3.8449574991491127`*^9, 
   3.844957521763853*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"7aa01970-f334-470d-8707-782377b6dfcf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{576., 580.1999999999999},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
CellContext->Notebook,
Magnification:>1.1 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"6df05553-658b-4d4c-b25a-e420fbb2c73a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 436, 7, 108, "Title",ExpressionUUID->"db62e516-81ba-4d70-b1b1-9cd33c91d768"],
Cell[CellGroupData[{
Cell[1041, 33, 207, 4, 73, "Section",ExpressionUUID->"78b447b1-9527-4a44-8f25-13c25c5e9101"],
Cell[1251, 39, 945, 23, 95, "Input",ExpressionUUID->"73bb8eb7-fd63-4382-a987-e4763fd2c07f"],
Cell[2199, 64, 2447, 43, 221, "Input",ExpressionUUID->"8e037178-fa87-40a0-a24d-b460c488efbd"],
Cell[4649, 109, 759, 17, 137, "Input",ExpressionUUID->"17e8648f-4974-4529-81b4-a9cf0e6c6f42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5445, 131, 330, 5, 73, "Section",ExpressionUUID->"1bff5a9f-0ef9-4eb9-a97f-cc3b0be84b3d"],
Cell[5778, 138, 2445, 65, 347, "Input",ExpressionUUID->"1f69a44f-8be3-4b10-b578-417791e2468b"]
}, Closed]],
Cell[CellGroupData[{
Cell[8260, 208, 338, 5, 57, "Section",ExpressionUUID->"d27acb04-c6fd-4944-8227-118c1ff153a7"],
Cell[CellGroupData[{
Cell[8623, 217, 446, 7, 49, "Subsubsection",ExpressionUUID->"b38d52a6-6120-4727-a325-de50a59d758d"],
Cell[9072, 226, 1890, 42, 137, "Input",ExpressionUUID->"cb786676-2541-46c2-a080-ee0f48f60b08"],
Cell[10965, 270, 697, 17, 116, "Input",ExpressionUUID->"6ea70fb8-085a-46ce-a6db-87a5d0ee1215"]
}, Closed]],
Cell[CellGroupData[{
Cell[11699, 292, 503, 7, 39, "Subsubsection",ExpressionUUID->"9c505c31-94a6-4052-b7df-b3725127238a"],
Cell[12205, 301, 485, 10, 31, "Input",ExpressionUUID->"603d3791-d8d0-4854-9579-5b4354231ed6"],
Cell[12693, 313, 2495, 42, 158, "Input",ExpressionUUID->"4f0ef374-c6e6-429c-a633-c384f90ef0ce"],
Cell[15191, 357, 1184, 28, 95, "Input",ExpressionUUID->"30c2ea5f-22d5-4aff-a097-455dc2e47006"],
Cell[16378, 387, 1230, 22, 53, "Input",ExpressionUUID->"903042a2-2846-48c5-864c-5008c1e798c3"],
Cell[17611, 411, 883, 18, 53, "Input",ExpressionUUID->"c97ccb08-5dc5-4382-929b-faaf650ecf78"],
Cell[18497, 431, 404, 6, 31, "Input",ExpressionUUID->"1f9110bc-7f00-4996-abe5-513766ab56b7"],
Cell[18904, 439, 3529, 99, 200, "Input",ExpressionUUID->"d3c9590c-39f9-46f8-ba29-06f0944e0e4a"],
Cell[22436, 540, 485, 14, 31, "Input",ExpressionUUID->"fc911b2f-8ebf-49c8-9b9b-b2789555e8fa"],
Cell[22924, 556, 397, 10, 31, "Input",ExpressionUUID->"92abef72-383d-4b0c-a4ed-c3175900df4b"],
Cell[23324, 568, 694, 17, 74, "Input",ExpressionUUID->"febc6bb2-0dd3-4f1a-8c26-ecd8b367b1e3"],
Cell[24021, 587, 1013, 19, 53, "Input",ExpressionUUID->"7aa01970-f334-470d-8707-782377b6dfcf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

